<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#667eea">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="ç—…åŸå¾®ç”Ÿç‰©é˜²æ§">
    <meta name="description" content="æŸ³å·å¸‚ç–¾ç—…é¢„é˜²æ§åˆ¶ä¸­å¿ƒç—…åŸå¾®ç”Ÿç‰©é˜²æ§ç³»ç»Ÿ">
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="icon-192x192.png">
    <!-- PDF.js for PDF text extraction -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <script>
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';
    </script>
    <title>æŸ³å·å¸‚ç–¾ç—…é¢„é˜²æ§åˆ¶ä¸­å¿ƒç—…åŸå¾®ç”Ÿç‰©é˜²æ§ç³»ç»Ÿï¼ˆv1.5.0ï¼‰</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        h1 {
            text-align: center;
            color: white;
            margin-bottom: 30px;
            font-size: 2.2em;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }
        .tabs {
            display: flex;
            gap: 5px;
            margin-bottom: 0;
            background: rgba(255,255,255,0.1);
            padding: 5px;
            border-radius: 10px 10px 0 0;
        }
        .tab {
            padding: 12px 24px;
            background: rgba(255,255,255,0.2);
            border: none;
            color: white;
            cursor: pointer;
            border-radius: 8px;
            font-size: 14px;
            transition: all 0.3s;
        }
        .tab:hover {
            background: rgba(255,255,255,0.3);
        }
        .tab.active {
            background: white;
            color: #667eea;
            font-weight: bold;
        }
        .content {
            background: white;
            border-radius: 0 10px 10px 10px;
            padding: 30px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }
        .form-group {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 8px;
            color: #333;
            font-weight: 500;
        }
        select, input {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s;
        }
        select:focus, input:focus {
            outline: none;
            border-color: #667eea;
        }
        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
            margin-right: 10px;
            margin-bottom: 10px;
        }
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
        }
        .btn-secondary {
            background: #f0f0f0;
            color: #333;
        }
        .btn-secondary:hover {
            background: #e0e0e0;
        }
        .result-box {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            padding: 25px;
            border-radius: 10px;
            margin-top: 25px;
            border-left: 4px solid #667eea;
        }
        .result-box h3 {
            color: #667eea;
            margin-bottom: 15px;
        }
        .result-item {
            padding: 8px 0;
            border-bottom: 1px dashed #ccc;
        }
        .result-item:last-child {
            border-bottom: none;
        }
        .highlight {
            color: #e74c3c;
            font-weight: bold;
            font-size: 1.2em;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e0e0e0;
        }
        th {
            background: #f8f9fa;
            font-weight: 600;
            color: #667eea;
        }
        tr:hover {
            background: #f8f9fa;
        }
        .tag {
            display: inline-block;
            padding: 4px 12px;
            background: #667eea;
            color: white;
            border-radius: 20px;
            font-size: 12px;
            margin-right: 5px;
        }
        .empty-state {
            text-align: center;
            padding: 40px;
            color: #999;
        }
        .record-card {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 10px;
            border-left: 3px solid #667eea;
        }
        .record-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }
        .record-time {
            color: #999;
            font-size: 12px;
        }
        .preset-card {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .preset-info h4 {
            color: #667eea;
            margin-bottom: 5px;
        }
        .preset-info p {
            color: #666;
            font-size: 13px;
        }
        .preset-actions {
            display: flex;
            gap: 5px;
        }
        .btn-small {
            padding: 6px 12px;
            font-size: 12px;
        }
        .radio-group {
            display: flex;
            gap: 20px;
            margin-bottom: 15px;
        }
        .radio-group label {
            display: flex;
            align-items: center;
            gap: 5px;
            cursor: pointer;
        }
        .radio-group input[type="radio"] {
            width: auto;
        }
        .steps {
            background: #f0f7ff;
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
        }
        .steps ol {
            padding-left: 20px;
        }
        .steps li {
            padding: 5px 0;
        }
        @media (max-width: 768px) {
            .form-row {
                grid-template-columns: 1fr;
            }
            .tabs {
                flex-wrap: wrap;
            }
            .tab {
                padding: 10px 15px;
                font-size: 13px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ§¬ æŸ³å·å¸‚ç–¾ç—…é¢„é˜²æ§åˆ¶ä¸­å¿ƒç—…åŸå¾®ç”Ÿç‰©é˜²æ§ç³»ç»Ÿï¼ˆv1.5.0ï¼‰</h1>
        
        <div class="tabs">
            <button class="tab active" onclick="switchTab('calc')">é…æ¯”è®¡ç®—</button>
            <button class="tab" onclick="switchTab('disease')">ä¼ æŸ“ç—…æ–¹æ¡ˆ</button>
            <button class="tab" onclick="switchTab('pathogen')">ç—…åŸå¾®ç”Ÿç‰©</button>
            <button class="tab" onclick="switchTab('recommend')">æ¨èæµ“åº¦</button>
            <button class="tab" onclick="switchTab('records')">é…æ¯”è®°å½•</button>
            <button class="tab" onclick="switchTab('presets')">å¸¸ç”¨æ–¹æ¡ˆ</button>
            <button class="tab" onclick="switchTab('epidemicAnalysis')">ğŸ” æµè°ƒåˆ†æ</button>
            <button class="tab" onclick="switchTab('aiConfig')">ğŸ¤– AIé…ç½®</button>
        </div>
        
        <div class="content">
            <!-- é…æ¯”è®¡ç®— -->
            <div id="calc" class="tab-content active">
                <div class="radio-group">
                    <label>
                        <input type="radio" name="calcMode" value="dilution" checked onchange="changeMode()">
                        è®¡ç®—ç¨€é‡Šå€æ•°
                    </label>
                    <label>
                        <input type="radio" name="calcMode" value="volume" onchange="changeMode()">
                        è®¡ç®—é…åˆ¶é‡
                    </label>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>æ¶ˆæ¯’å‰‚ç±»åˆ«</label>
                        <select id="category" onchange="updateDisinfectants()">
                            <option value="">è¯·é€‰æ‹©</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>å…·ä½“åç§°</label>
                        <select id="disinfectant" onchange="updateConcentration()">
                            <option value="">è¯·é€‰æ‹©</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>åŸæ¶²æµ“åº¦ (%)</label>
                        <input type="number" id="sourceConc" step="0.1" value="5.0">
                    </div>
                    <div class="form-group">
                        <label>ç›®æ ‡æµ“åº¦</label>
                        <div style="display: flex; gap: 10px;">
                            <input type="number" id="targetConc" step="1" value="500" style="flex: 2;">
                            <select id="targetUnit" style="flex: 1;" onchange="updatePlaceholder()">
                                <option value="mg/L">mg/L</option>
                                <option value="%">%</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <div class="form-row" id="volumeRow" style="display: none;">
                    <div class="form-group">
                        <label>ç›®æ ‡ä½“ç§¯ (mL)</label>
                        <input type="number" id="targetVol" step="10" value="1000">
                    </div>
                </div>
                
                <div>
                    <button class="btn btn-primary" onclick="calculate()">è®¡ç®—</button>
                    <button class="btn btn-secondary" onclick="clearCalc()">æ¸…ç©º</button>
                    <button class="btn btn-secondary" onclick="savePreset()">ä¿å­˜æ–¹æ¡ˆ</button>
                </div>
                
                <div id="result" class="result-box" style="display: none;">
                    <h3>ğŸ“Š è®¡ç®—ç»“æœ</h3>
                    <div id="resultContent"></div>
                </div>
            </div>
            
            <!-- ä¼ æŸ“ç—…æ¶ˆæ¯’æ–¹æ¡ˆ -->
            <div id="disease" class="tab-content">
                <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 15px; border-radius: 8px; margin-bottom: 20px; color: white;">
                    <h3 style="margin: 0 0 10px 0; font-size: 16px;">ğŸ“‹ ä¼ æŸ“ç—…æ¶ˆæ¯’åŸåˆ™ï¼ˆGB19193-2025ï¼‰</h3>
                    <div style="font-size: 13px; line-height: 1.6;">
                        <p style="margin: 5px 0;"><strong>1. ä¾æ³•ä¾è§„åŸåˆ™ï¼š</strong>åœ¨ç–¾ç—…é¢„é˜²æ§åˆ¶æœºæ„æŒ‡å¯¼ä¸‹æˆ–æŒ‰å…¶å«ç”Ÿè¦æ±‚ç»„ç»‡å®æ–½</p>
                        <p style="margin: 5px 0;"><strong>2. ç§‘å­¦æœ‰æ•ˆåŸåˆ™ï¼š</strong>æ ¹æ®ç—…åŸå­¦ç‰¹ç‚¹ã€æµè¡Œç—…å­¦ç‰¹å¾é€‰æ‹©æ¶ˆæ¯’æ–¹æ³•</p>
                        <p style="margin: 5px 0;"><strong>3. é¿å…è¿‡åº¦æ¶ˆæ¯’åŸåˆ™ï¼š</strong>ä¸éšæ„æé«˜æµ“åº¦ã€å¢åŠ é¢‘æ¬¡æˆ–æ‰©å¤§èŒƒå›´</p>
                        <p style="margin: 5px 0;"><strong>4. å®‰å…¨é˜²æŠ¤åŸåˆ™ï¼š</strong>åšå¥½ä¸ªäººé˜²æŠ¤ï¼Œé¢„é˜²ç›®æ ‡å¾®ç”Ÿç‰©å’Œæ¶ˆæ¯’å› å­çš„å±å®³</p>
                    </div>
                </div>
                
                <div style="background: #fff3e0; padding: 12px; border-radius: 8px; margin-bottom: 20px; border-left: 4px solid #e65100;">
                    <p style="margin: 0; font-size: 13px; color: #e65100;">
                        <strong>âš ï¸ æ³¨æ„ï¼š</strong>æœ¬ç³»ç»Ÿæ•°æ®ä¾æ®GB19193-2025ã€Šä¼ æŸ“ç—…æ¶ˆæ¯’è§„èŒƒã€‹ç¼–åˆ¶ã€‚ä¸€èˆ¬ç¯å¢ƒè¡¨é¢æ¶ˆæ¯’æ¨èæœ‰æ•ˆæ°¯500-1000mg/Lï¼›
                        ç”²ç±»ä¼ æŸ“ç—…åŠæŒ‰ç”²ç±»ç®¡ç†çš„ä¼ æŸ“ç—…ç¯å¢ƒæ¶ˆæ¯’æ¨è2000mg/Lï¼›å°¸ä½“æ¶ˆæ¯’æ¨è5000-10000mg/Lå«æ°¯æ¶ˆæ¯’å‰‚æˆ–è¿‡æ°§ä¹™é…¸ã€‚
                        é¦–é€‰ç‰©ç†æ¶ˆæ¯’æ–¹æ³•ï¼ˆçƒ­æ´—æ¶¤ã€ç…®æ²¸ï¼‰ï¼Œå¿…è¦æ—¶é€‰ç”¨åŒ–å­¦æ¶ˆæ¯’ã€‚
                    </p>
                </div>
                
                <div class="form-group">
                    <label>é€‰æ‹©ä¼ æŸ“ç—…ç±»åˆ«</label>
                    <select id="diseaseClass" onchange="updateDiseaseList()">
                        <option value="">è¯·é€‰æ‹©ä¼ æŸ“ç—…ç±»åˆ«</option>
                        <option value="ç”²ç±»">ç”²ç±»ä¼ æŸ“ç—…ï¼ˆå¼ºåˆ¶ç®¡ç†ï¼‰</option>
                        <option value="ä¹™ç±»">ä¹™ç±»ä¼ æŸ“ç—…ï¼ˆä¸¥æ ¼ç®¡ç†ï¼‰</option>
                        <option value="ä¸™ç±»">ä¸™ç±»ä¼ æŸ“ç—…ï¼ˆç›‘æµ‹ç®¡ç†ï¼‰</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>é€‰æ‹©å…·ä½“ä¼ æŸ“ç—…</label>
                    <select id="diseaseName" onchange="showDiseasePlan()">
                        <option value="">è¯·é€‰æ‹©å…·ä½“ä¼ æŸ“ç—…</option>
                    </select>
                </div>
                
                <div id="diseasePlan" style="display: none;">
                    <div class="result-box">
                        <h3 id="planTitle">ğŸ“‹ æ¶ˆæ¯’æ–¹æ¡ˆ</h3>
                        <div id="planContent"></div>
                    </div>
                    
                    <div style="margin-top: 20px;">
                        <button class="btn btn-primary" onclick="applyDiseasePlan()">åº”ç”¨æ­¤æ–¹æ¡ˆåˆ°è®¡ç®—å™¨</button>
                        <button class="btn btn-secondary" onclick="exportDiseasePlan()">å¯¼å‡ºæ–¹æ¡ˆ</button>
                    </div>
                </div>
            </div>
            
            <!-- ç—…åŸå¾®ç”Ÿç‰©æŸ¥è¯¢ -->
            <div id="pathogen" class="tab-content">
                <!-- æœç´¢åŒºåŸŸ -->
                <div class="form-group" style="background: linear-gradient(135deg, #667eea15 0%, #764ba215 100%); padding: 20px; border-radius: 10px; margin-bottom: 20px;">
                    <label style="font-size: 16px; color: #667eea; margin-bottom: 10px;">ğŸ” æœç´¢ç—…åŸå¾®ç”Ÿç‰©</label>
                    <input type="text" id="pathogenSearch" placeholder="è¾“å…¥ç—…åŸåç§°ã€ç–¾ç—…åç§°æˆ–åˆ†ç±»å­¦åœ°ä½ï¼ˆå¦‚ï¼šæ–°å† ã€ç»“æ ¸ã€ç‚­ç–½ã€åŸƒåšæ‹‰ï¼‰" style="width: 100%; padding: 15px; font-size: 15px; border: 2px solid #667eea; border-radius: 8px; margin-bottom: 10px;" onkeyup="searchPathogen(event)">
                    <div style="display: flex; gap: 10px;">
                        <button class="btn btn-primary" onclick="searchPathogen()" style="flex: 1; padding: 12px;">ğŸ” æœç´¢</button>
                        <button class="btn btn-secondary" onclick="clearPathogenSearch()" style="padding: 12px 20px;">æ¸…ç©º</button>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>å±å®³ç¨‹åº¦åˆ†ç±»</label>
                        <select id="pathogenCategoryFilter" onchange="filterPathogenByCategory()">
                            <option value="">å…¨éƒ¨</option>
                            <option value="ç¬¬ä¸€ç±»">ç¬¬ä¸€ç±»ï¼ˆé«˜è‡´ç—…æ€§ï¼‰</option>
                            <option value="ç¬¬äºŒç±»">ç¬¬äºŒç±»ï¼ˆä¸­ç­‰è‡´ç—…æ€§ï¼‰</option>
                            <option value="ç¬¬ä¸‰ç±»">ç¬¬ä¸‰ç±»ï¼ˆä½è‡´ç—…æ€§ï¼‰</option>
                            <option value="ç¬¬å››ç±»">ç¬¬å››ç±»ï¼ˆæ— æˆ–æä½è‡´ç—…æ€§ï¼‰</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>ç—…åŸç±»å‹</label>
                        <select id="pathogenTypeFilter" onchange="filterPathogenByType()">
                            <option value="">å…¨éƒ¨</option>
                            <option value="ç—…æ¯’">ç—…æ¯’</option>
                            <option value="ç»†èŒ">ç»†èŒ/æ”¾çº¿èŒ/è¡£åŸä½“/æ”¯åŸä½“/ç«‹å…‹æ¬¡ä½“/èºæ—‹ä½“</option>
                            <option value="çœŸèŒ">çœŸèŒ</option>
                            <option value="æœŠç—…æ¯’">æœŠç—…æ¯’</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>ç”Ÿç‰©å®‰å…¨å®éªŒå®¤ç­‰çº§</label>
                        <select id="bslFilter" onchange="filterPathogenByBSL()">
                            <option value="">å…¨éƒ¨</option>
                            <option value="BSL-4">BSL-4</option>
                            <option value="BSL-3">BSL-3</option>
                            <option value="BSL-2">BSL-2</option>
                            <option value="BSL-1">BSL-1</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>å¿«é€Ÿç­›é€‰</label>
                        <div style="display: flex; gap: 5px; flex-wrap: wrap;">
                            <button class="btn btn-small btn-secondary" onclick="showHighRiskPathogens()">ğŸ”´ ç¬¬ä¸€ç±»ç—…åŸ</button>
                            <button class="btn btn-small btn-secondary" onclick="showRespiratoryPathogens()">ğŸ« å‘¼å¸é“ä¼ æ’­</button>
                            <button class="btn btn-small btn-secondary" onclick="showBloodPathogens()">ğŸ©¸ è¡€æ¶²ä¼ æ’­</button>
                        </div>
                    </div>
                </div>
                
                <div id="pathogenResult" style="margin-top: 20px;">
                    <div class="empty-state">
                        <p style="font-size: 16px; margin-bottom: 15px;">ğŸ” è¯·è¾“å…¥å…³é”®è¯æœç´¢ç—…åŸå¾®ç”Ÿç‰©ï¼Œæˆ–ä½¿ç”¨ç­›é€‰æ¡ä»¶</p>
                        <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-top: 15px; text-align: left; border-left: 4px solid #667eea;">
                            <p style="font-size: 13px; color: #666; margin: 0 0 10px 0; font-weight: bold;">ğŸ“š æ•°æ®æ¥æºï¼š</p>
                            <p style="font-size: 12px; color: #666; margin: 0 0 5px 0;">â€¢ ã€Šäººé—´ä¼ æŸ“çš„ç—…åŸå¾®ç”Ÿç‰©ç›®å½•ã€‹ï¼ˆ2023å¹´ç‰ˆï¼‰</p>
                            <p style="font-size: 12px; color: #666; margin: 0 0 5px 0;">â€¢ å‘å¸ƒæœºæ„ï¼šä¸­åäººæ°‘å…±å’Œå›½å›½å®¶å«ç”Ÿå¥åº·å§”å‘˜ä¼š</p>
                            <p style="font-size: 12px; color: #666; margin: 0 0 5px 0;">â€¢ å‘å¸ƒæ—¥æœŸï¼š2023å¹´8æœˆ18æ—¥</p>
                            <p style="font-size: 12px; color: #999; margin: 10px 0 0 0; font-style: italic;">âš ï¸ æœ¬æ¨¡å—ä»…ä¾›ä¸“ä¸šäººå‘˜å‚è€ƒï¼Œå®é™…æ“ä½œè¯·éµå¾ªæœ€æ–°ç‰ˆã€Šäººé—´ä¼ æŸ“çš„ç—…åŸå¾®ç”Ÿç‰©ç›®å½•ã€‹åŠç›¸å…³æ³•è§„</p>
                        </div>
                    </div>
                </div>
                
                <div id="pathogenDetail" style="display: none; margin-top: 20px;">
                    <div class="result-box">
                        <h3 id="detailTitle">ç—…åŸè¯¦æƒ…</h3>
                        <div id="detailContent"></div>
                        <div style="margin-top: 15px; padding-top: 15px; border-top: 1px solid #ddd;">
                            <h4>ğŸ§´ æ¨èæ¶ˆæ¯’æ–¹æ¡ˆ</h4>
                            <div id="disinfectionRecommendation"></div>
                            <button class="btn btn-primary" onclick="applyPathogenDisinfection()" style="margin-top: 10px;">åº”ç”¨æ­¤æ¶ˆæ¯’æ–¹æ¡ˆ</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- æ¨èæµ“åº¦ -->
            <div id="recommend" class="tab-content">
                <div class="form-group">
                    <label>é€‰æ‹©æ¶ˆæ¯’å¯¹è±¡</label>
                    <select id="targetObject" onchange="showRecommendations()">
                        <option value="">è¯·é€‰æ‹©æ¶ˆæ¯’å¯¹è±¡</option>
                    </select>
                </div>
                
                <div id="recommendTable">
                    <table>
                        <thead>
                            <tr>
                                <th>æ¶ˆæ¯’å‰‚ç±»å‹</th>
                                <th>ä½¿ç”¨åœºæ™¯</th>
                                <th>æ¨èæµ“åº¦</th>
                                <th>ä½œç”¨æ—¶é—´</th>
                                <th>å¤‡æ³¨</th>
                                <th>æ“ä½œ</th>
                            </tr>
                        </thead>
                        <tbody id="recommendBody">
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- é…æ¯”è®°å½• -->
            <div id="records" class="tab-content">
                <div style="margin-bottom: 20px;">
                    <button class="btn btn-secondary" onclick="exportCSV()">å¯¼å‡ºCSV</button>
                    <button class="btn btn-secondary" onclick="clearRecords()">æ¸…ç©ºè®°å½•</button>
                </div>
                <div id="recordsList"></div>
            </div>
            
            <!-- å¸¸ç”¨æ–¹æ¡ˆ -->
            <div id="presets" class="tab-content">
                <div id="presetsList"></div>
            </div>
            
            <!-- æµè°ƒåˆ†æ -->
            <div id="epidemicAnalysis" class="tab-content">
                <div style="background: linear-gradient(135deg, #667eea15 0%, #764ba215 100%); padding: 20px; border-radius: 10px; margin-bottom: 20px;">
                    <h3 style="color: #667eea; margin-bottom: 15px;">ğŸ” æµè°ƒæŠ¥å‘Šæ™ºèƒ½åˆ†æ</h3>
                    <p style="color: #666; font-size: 13px; margin-bottom: 15px;">
                        ä¸Šä¼ æµè°ƒæŠ¥å‘Šï¼ŒAIè‡ªåŠ¨è¯†åˆ«å¯èƒ½çš„è‡´ç—…èŒå¹¶æ¨èæ¶ˆæ¯’æ–¹æ¡ˆã€‚æ”¯æŒæ–‡æœ¬ã€å›¾ç‰‡ã€PDFæ ¼å¼ã€‚
                    </p>
                </div>
                
                <!-- è¾“å…¥æ–¹å¼é€‰æ‹© -->
                <div class="form-group">
                    <label>é€‰æ‹©è¾“å…¥æ–¹å¼</label>
                    <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                        <button class="btn btn-primary" onclick="setAnalysisMode('text')" id="modeText" style="flex: 1; min-width: 100px;">ğŸ“ æ–‡æœ¬è¾“å…¥</button>
                        <button class="btn btn-secondary" onclick="setAnalysisMode('image')" id="modeImage" style="flex: 1; min-width: 100px;">ğŸ–¼ï¸ å›¾ç‰‡ä¸Šä¼ </button>
                        <button class="btn btn-secondary" onclick="setAnalysisMode('pdf')" id="modePdf" style="flex: 1; min-width: 100px;">ğŸ“„ PDFä¸Šä¼ </button>
                    </div>
                </div>
                
                <!-- æ–‡æœ¬è¾“å…¥åŒºåŸŸ -->
                <div id="textInputArea" class="analysis-input-area">
                    <div class="form-group">
                        <label>ç²˜è´´æµè°ƒæŠ¥å‘Šå†…å®¹</label>
                        <textarea id="epidemicText" rows="10" style="width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px; font-family: inherit; resize: vertical;" placeholder="è¯·ç²˜è´´æµè°ƒæŠ¥å‘Šæ–‡æœ¬å†…å®¹...

ä¾‹å¦‚ï¼š
æ‚£è€…ï¼Œç”·ï¼Œ35å²ï¼Œå‘çƒ­3å¤©ï¼Œä½“æ¸©æœ€é«˜39.5â„ƒï¼Œä¼´æœ‰å’³å—½ã€ä¹åŠ›ã€‚å‘ç—…å‰ä¸€å‘¨æœ‰æ´»ç¦½å¸‚åœºæ¥è§¦å²ã€‚å®éªŒå®¤æ£€æŸ¥ï¼šç™½ç»†èƒé™ä½ï¼Œæ·‹å·´ç»†èƒå‡å°‘..."></textarea>
                    </div>
                </div>
                
                <!-- å›¾ç‰‡ä¸Šä¼ åŒºåŸŸ -->
                <div id="imageInputArea" class="analysis-input-area" style="display: none;">
                    <div class="form-group">
                        <label>ä¸Šä¼ æµè°ƒæŠ¥å‘Šå›¾ç‰‡</label>
                        <div id="imageDropZone" style="border: 2px dashed #667eea; border-radius: 10px; padding: 40px; text-align: center; background: #f8f9fa; cursor: pointer; transition: all 0.3s;" onclick="document.getElementById('epidemicImage').click()">
                            <div style="font-size: 48px; margin-bottom: 15px;">ğŸ“·</div>
                            <div style="color: #667eea; font-weight: bold; margin-bottom: 10px;">ç‚¹å‡»æˆ–æ‹–æ‹½ä¸Šä¼ å›¾ç‰‡</div>
                            <div style="color: #999; font-size: 13px;">æ”¯æŒ JPGã€PNGã€GIF æ ¼å¼</div>
                        </div>
                        <input type="file" id="epidemicImage" accept="image/*" style="display: none;" onchange="handleImageUpload(event)">
                        <div id="imagePreview" style="margin-top: 15px; display: none;">
                            <img id="previewImg" style="max-width: 100%; max-height: 300px; border-radius: 8px; border: 1px solid #ddd;">
                            <div style="margin-top: 10px;">
                                <button class="btn btn-secondary" onclick="clearImage()">ğŸ—‘ï¸ æ¸…é™¤å›¾ç‰‡</button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- PDFä¸Šä¼ åŒºåŸŸ -->
                <div id="pdfInputArea" class="analysis-input-area" style="display: none;">
                    <div class="form-group">
                        <label>ä¸Šä¼ æµè°ƒæŠ¥å‘ŠPDF</label>
                        <div id="pdfDropZone" style="border: 2px dashed #667eea; border-radius: 10px; padding: 40px; text-align: center; background: #f8f9fa; cursor: pointer; transition: all 0.3s;" onclick="document.getElementById('epidemicPdf').click()">
                            <div style="font-size: 48px; margin-bottom: 15px;">ğŸ“‘</div>
                            <div style="color: #667eea; font-weight: bold; margin-bottom: 10px;">ç‚¹å‡»æˆ–æ‹–æ‹½ä¸Šä¼ PDF</div>
                            <div style="color: #999; font-size: 13px;">æ”¯æŒ PDF æ ¼å¼ï¼Œæœ€å¤§ 10MB</div>
                        </div>
                        <input type="file" id="epidemicPdf" accept=".pdf,application/pdf" style="display: none;" onchange="handlePdfUpload(event)">
                        <div id="pdfPreview" style="margin-top: 15px; display: none;">
                            <div style="background: #e7f3ff; padding: 15px; border-radius: 8px; border-left: 4px solid #0066cc;">
                                <div style="font-weight: bold; color: #004085; margin-bottom: 5px;">ğŸ“„ å·²é€‰æ‹©PDFæ–‡ä»¶</div>
                                <div id="pdfFileName" style="color: #666; font-size: 14px;"></div>
                                <div id="pdfExtractedText" style="margin-top: 10px; padding: 10px; background: white; border-radius: 5px; max-height: 150px; overflow-y: auto; font-size: 13px; color: #333;"></div>
                            </div>
                            <div style="margin-top: 10px;">
                                <button class="btn btn-secondary" onclick="clearPdf()">ğŸ—‘ï¸ æ¸…é™¤PDF</button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- åˆ†ææŒ‰é’® -->
                <div style="margin-top: 20px; text-align: center;">
                    <button class="btn btn-primary" onclick="analyzeEpidemicReport()" style="padding: 15px 40px; font-size: 16px;">
                        ğŸ¤– AIæ™ºèƒ½åˆ†æ
                    </button>
                    <button class="btn btn-secondary" onclick="clearAnalysisInput()" style="margin-left: 10px;">
                        ğŸ—‘ï¸ æ¸…ç©º
                    </button>
                </div>
                
                <!-- åˆ†æç»“æœ -->
                <div id="analysisResult" style="margin-top: 25px; display: none;">
                    <div style="background: #f8f9fa; padding: 20px; border-radius: 10px;">
                        <h4 style="color: #667eea; margin-bottom: 15px;">ğŸ“Š åˆ†æç»“æœ</h4>
                        
                        <!-- å¯èƒ½çš„ç—…åŸ -->
                        <div id="detectedPathogens" style="margin-bottom: 20px;">
                            <h5 style="color: #333; margin-bottom: 10px;">ğŸ¦  å¯èƒ½çš„è‡´ç—…èŒ</h5>
                            <div id="pathogensList"></div>
                        </div>
                        
                        <!-- ä¼ æ’­é€”å¾„ -->
                        <div id="transmissionRoute" style="margin-bottom: 20px;">
                            <h5 style="color: #333; margin-bottom: 10px;">ğŸ“¡ ä¼ æ’­é€”å¾„</h5>
                            <div id="routeContent"></div>
                        </div>
                        
                        <!-- æ¨èæ–¹æ¡ˆ -->
                        <div id="recommendedPlan" style="margin-bottom: 20px;">
                            <h5 style="color: #333; margin-bottom: 10px;">ğŸ›¡ï¸ æ¨èæ¶ˆæ¯’æ–¹æ¡ˆ</h5>
                            <div id="planContent"></div>
                        </div>
                        
                        <!-- AIåˆ†æåŸå§‹æ–‡æœ¬ -->
                        <div id="aiRawAnalysis" style="margin-bottom: 20px;">
                            <h5 style="color: #333; margin-bottom: 10px;">ğŸ“ AIåˆ†æè¯¦æƒ…</h5>
                            <div id="rawContent" style="background: white; padding: 15px; border-radius: 8px; font-size: 13px; line-height: 1.6; max-height: 300px; overflow-y: auto;"></div>
                        </div>
                        
                        <!-- æ“ä½œæŒ‰é’® -->
                        <div style="display: flex; gap: 10px; flex-wrap: wrap; margin-top: 20px;">
                            <button class="btn btn-primary" onclick="applyRecommendedPlan()" id="applyPlanBtn" style="flex: 1; min-width: 150px;">
                                âš¡ åº”ç”¨æ¨èæ–¹æ¡ˆ
                            </button>
                            <button class="btn btn-secondary" onclick="exportAnalysisResult()" style="flex: 1; min-width: 150px;">
                                ğŸ“¥ å¯¼å‡ºç»“æœ
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- åˆ†æçŠ¶æ€ -->
                <div id="analysisStatus" style="margin-top: 20px;"></div>
            </div>
            
            <!-- AIé…ç½® -->
            <div id="aiConfig" class="tab-content">
                <div style="background: linear-gradient(135deg, #667eea15 0%, #764ba215 100%); padding: 20px; border-radius: 10px; margin-bottom: 20px;">
                    <h3 style="color: #667eea; margin-bottom: 15px;">ğŸ¤– AI API é…ç½®</h3>
                    <p style="color: #666; font-size: 13px; margin-bottom: 15px;">
                        é…ç½®AIæ¨¡å‹APIï¼Œç”¨äºæµè°ƒæŠ¥å‘Šæ™ºèƒ½åˆ†æã€‚æ”¯æŒOpenAIã€Kimiã€Claudeç­‰å¤šç§æ¨¡å‹ã€‚
                    </p>
                </div>
                
                <div class="form-group">
                    <label>é€‰æ‹©AIæ¨¡å‹æä¾›å•†</label>
                    <select id="aiProvider" onchange="updateAIConfigFields()">
                        <option value="kimi">Kimi (Moonshot)</option>
                        <option value="openai">OpenAI (GPT)</option>
                        <option value="claude">Claude (Anthropic)</option>
                        <option value="custom">è‡ªå®šä¹‰ API</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>API Base URL</label>
                    <input type="text" id="aiBaseUrl" placeholder="https://api.moonshot.cn/v1">
                    <small style="color: #999; font-size: 12px;">é»˜è®¤ä½¿ç”¨å®˜æ–¹APIåœ°å€ï¼Œå¦‚ä½¿ç”¨ä»£ç†è¯·ä¿®æ”¹</small>
                </div>
                
                <div class="form-group">
                    <label>API Key</label>
                    <input type="password" id="aiApiKey" placeholder="è¾“å…¥æ‚¨çš„APIå¯†é’¥">
                    <small style="color: #999; font-size: 12px;">å¯†é’¥ä»…ä¿å­˜åœ¨æœ¬åœ°ï¼Œä¸ä¼šä¸Šä¼ åˆ°æœåŠ¡å™¨</small>
                </div>
                
                <div class="form-group">
                    <label>æ¨¡å‹åç§°</label>
                    <input type="text" id="aiModel" placeholder="å¦‚ï¼škimi-coding/k2p5">
                    <small style="color: #999; font-size: 12px;">ä¸åŒæä¾›å•†çš„æ¨¡å‹åç§°æ ¼å¼ä¸åŒ</small>
                </div>
                
                <div class="form-group">
                    <label>æ¸©åº¦ (Temperature)</label>
                    <input type="range" id="aiTemperature" min="0" max="2" step="0.1" value="0.7" oninput="document.getElementById('tempValue').textContent = this.value">
                    <span id="tempValue" style="color: #667eea; font-weight: bold;">0.7</span>
                    <small style="color: #999; font-size: 12px; display: block;">è¾ƒä½å€¼è¾“å‡ºæ›´ç¡®å®šï¼Œè¾ƒé«˜å€¼è¾“å‡ºæ›´å¤šæ ·</small>
                </div>
                
                <div class="form-group">
                    <label>æœ€å¤§Tokenæ•°</label>
                    <input type="number" id="aiMaxTokens" value="4096" min="512" max="8192" step="512">
                    <small style="color: #999; font-size: 12px;">é™åˆ¶AIå›å¤çš„æœ€å¤§é•¿åº¦</small>
                </div>
                
                <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin: 20px 0;">
                    <label style="display: flex; align-items: center; cursor: pointer;">
                        <input type="checkbox" id="aiLocalMode" style="width: auto; margin-right: 8px;">
                        <span>ä½¿ç”¨æœ¬åœ°æ¨¡å‹ï¼ˆæ•°æ®ä¸ä¸Šä¼ äº‘ç«¯ï¼Œæ›´å®‰å…¨ï¼‰</span>
                    </label>
                    <small style="color: #999; font-size: 12px; display: block; margin-top: 5px;">
                        é€‚ç”¨äºé«˜è‡´ç—…æ€§ç—…åŸæµè°ƒåˆ†æï¼Œéœ€åœ¨æœ¬åœ°éƒ¨ç½²LLM
                    </small>
                </div>
                
                <div style="display: flex; gap: 10px; margin-top: 20px;">
                    <button class="btn btn-primary" onclick="saveAIConfig()" style="flex: 1;">ğŸ’¾ ä¿å­˜é…ç½®</button>
                    <button class="btn btn-secondary" onclick="testAIConnection()">ğŸ§ª æµ‹è¯•è¿æ¥</button>
                    <button class="btn btn-secondary" onclick="resetAIConfig()">ğŸ”„ æ¢å¤é»˜è®¤</button>
                </div>
                
                <div id="aiTestResult" style="margin-top: 15px;"></div>
                
                <div style="background: #fff3cd; border-left: 4px solid #ffc107; padding: 15px; margin-top: 20px; border-radius: 5px;">
                    <h4 style="color: #856404; margin-bottom: 10px;">ğŸ“‹ å¸¸ç”¨æ¨¡å‹é…ç½®ç¤ºä¾‹</h4>
                    <div style="font-size: 12px; color: #856404; line-height: 1.8;">
                        <p><strong>Kimi (æ¨è):</strong></p>
                        <p>â€¢ Base URL: https://api.moonshot.cn/v1</p>
                        <p>â€¢ æ¨¡å‹: kimi-coding/k2p5</p>
                        <br>
                        <p><strong>OpenAI:</strong></p>
                        <p>â€¢ Base URL: https://api.openai.com/v1</p>
                        <p>â€¢ æ¨¡å‹: gpt-4 æˆ– gpt-3.5-turbo</p>
                        <br>
                        <p><strong>æœ¬åœ°æ¨¡å‹ (Ollama):</strong></p>
                        <p>â€¢ Base URL: http://localhost:11434/v1</p>
                        <p>â€¢ æ¨¡å‹: llama3.1 æˆ– qwen2.5</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // æ¶ˆæ¯’å‰‚æ•°æ®åº“
        // unitMode: 'chlorine' = å«æ°¯æ¨¡å¼(%->mg/L), 'peroxide' = è¿‡æ°§åŒ–ç‰©æ¨¡å¼(%%), 'other' = ç›´æ¥ç™¾åˆ†æ¯”
        const disinfectantDB = {
            "å«æ°¯æ¶ˆæ¯’å‰‚": {
                "84æ¶ˆæ¯’æ¶²": { conc: 5.0, type: "æ¶²ä½“", unitMode: "chlorine" },
                "æ¼‚ç™½ç²‰": { conc: 25.0, type: "å›ºä½“", unitMode: "chlorine" },
                "æ¬¡æ°¯é…¸é’ æº¶æ¶²": { conc: 10.0, type: "æ¶²ä½“", unitMode: "chlorine" },
                "äºŒæ°¯å¼‚æ°°å°¿é…¸é’ ": { conc: 60.0, type: "å›ºä½“", unitMode: "chlorine" },
                "ä¸‰æ°¯å¼‚æ°°å°¿é…¸": { conc: 90.0, type: "å›ºä½“", unitMode: "chlorine" },
                "æ°¯èƒºT": { conc: 25.0, type: "å›ºä½“", unitMode: "chlorine" }
            },
            "é†‡ç±»": {
                "95%ä¹™é†‡": { conc: 95.0, type: "æ¶²ä½“", unitMode: "percent" },
                "æ— æ°´ä¹™é†‡": { conc: 99.5, type: "æ¶²ä½“", unitMode: "percent" }
            },
            "è¿‡æ°§åŒ–ç‰©ç±»": {
                "è¿‡æ°§åŒ–æ°¢(åŒæ°§æ°´)": { conc: 30.0, type: "æ¶²ä½“", unitMode: "percent" },
                "è¿‡æ°§ä¹™é…¸": { conc: 15.0, type: "æ¶²ä½“", unitMode: "percent" },
                "äºŒæ°§åŒ–æ°¯(ç¨³å®šå‹)": { conc: 2.0, type: "æ¶²ä½“", unitMode: "clo2_mgl" },
                "äºŒæ°§åŒ–æ°¯(æ³¡è…¾ç‰‡)": { conc: 10.0, type: "å›ºä½“", unitMode: "clo2_mgl" }
            },
            "å­£é“µç›ç±»": {
                "è‹¯æ‰æº´é“µ(æ–°æ´å°”ç­)": { conc: 5.0, type: "æ¶²ä½“", unitMode: "chlorine" },
                "åŒé“¾å­£é“µç›": { conc: 10.0, type: "æ¶²ä½“", unitMode: "chlorine" }
            },
            "å…¶ä»–": {
                "ç¢˜ä¼": { conc: 0.5, type: "æ¶²ä½“", unitMode: "percent" },
                "ç¢˜é…Š": { conc: 2.0, type: "æ¶²ä½“", unitMode: "percent" },
                "æ¥è‹å„¿(ç…¤é…šçš‚)": { conc: 50.0, type: "æ¶²ä½“", unitMode: "percent" },
                "æˆŠäºŒé†›": { conc: 2.0, type: "æ¶²ä½“", unitMode: "percent" }
            }
        };

        // ä¼ æŸ“ç—…æ¶ˆæ¯’æ–¹æ¡ˆæ•°æ®åº“
        // æ ¹æ®ã€Šä¸­åäººæ°‘å…±å’Œå›½ä¼ æŸ“ç—…é˜²æ²»æ³•ã€‹ï¼ˆ2025å¹´ä¿®è®¢ï¼‰
        const diseaseDB = {
            "ç”²ç±»": {
                "é¼ ç–«": {
                    pathogen: "é¼ ç–«è€¶å°”æ£®èŒ",
                    transmission: "èš¤å®å’¬ã€å‘¼å¸é“é£æ²«ã€æ¥è§¦ä¼ æ’­",
                    level: "æœ€é«˜",
                    environment: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "2000", unit: "mg/L", time: "60åˆ†é’Ÿ" },
                    excreta: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "20000", unit: "mg/L", time: "120åˆ†é’Ÿ" },
                    corpse: { method: "ç«‹å³ç«åŒ–", note: "ç”¨æµ¸æœ‰5000-10000mg/Lå«æ°¯æ¶ˆæ¯’å‰‚æˆ–è¿‡æ°§ä¹™é…¸æº¶æ¶²çš„çº±å¸ƒå µå¡å£ã€é¼»ã€è€³ã€è‚›é—¨ã€é˜´é“ç­‰" },
                    vehicle: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "1000", unit: "mg/L", time: "60åˆ†é’Ÿ" },
                    personal: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "1000", unit: "mg/L", time: "30åˆ†é’Ÿ" },
                    note: "ç»ˆæœ«æ¶ˆæ¯’å¿…é¡»åœ¨ä¸“ä¸šäººå‘˜æŒ‡å¯¼ä¸‹è¿›è¡Œï¼Œæ¶ˆæ¯’äººå‘˜éœ€äºŒçº§é˜²æŠ¤"
                },
                "éœä¹±": {
                    pathogen: "éœä¹±å¼§èŒ",
                    transmission: "ç²ª-å£é€”å¾„ã€æ±¡æŸ“çš„æ°´å’Œé£Ÿç‰©",
                    level: "æœ€é«˜",
                    environment: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "2000", unit: "mg/L", time: "60åˆ†é’Ÿ" },
                    excreta: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "20000", unit: "mg/L", time: "120åˆ†é’Ÿ" },
                    water: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "10", unit: "mg/L", time: "60åˆ†é’Ÿ" },
                    food: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "500", unit: "mg/L", time: "30åˆ†é’Ÿ" },
                    corpse: { method: "ç«‹å³ç«åŒ–", note: "ç”¨æµ¸æœ‰5000-10000mg/Lå«æ°¯æ¶ˆæ¯’å‰‚æˆ–è¿‡æ°§ä¹™é…¸æº¶æ¶²çš„çº±å¸ƒå µå¡" },
                    note: "æ‚£è€…æ’æ³„ç‰©ã€å‘•åç‰©å¿…é¡»éšæ—¶æ¶ˆæ¯’ï¼Œæ¶ˆæ¯’åæ’æ”¾"
                }
            },
            "ä¹™ç±»": {
                "æ–°å‹å† çŠ¶ç—…æ¯’æ„ŸæŸ“": {
                    pathogen: "SARS-CoV-2",
                    transmission: "å‘¼å¸é“é£æ²«ã€å¯†åˆ‡æ¥è§¦ã€æ°”æº¶èƒ¶ä¼ æ’­",
                    level: "é«˜",
                    environment: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "1000", unit: "mg/L", time: "30åˆ†é’Ÿ" },
                    air: { type: "è¿‡æ°§åŒ–æ°¢", conc: "3", unit: "%", method: "æ°”æº¶èƒ¶å–·é›¾", time: "60åˆ†é’Ÿ" },
                    fabric: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "500", unit: "mg/L", time: "30åˆ†é’Ÿ" },
                    corpse: { method: "ç«åŒ–", note: "ç”¨æµ¸æœ‰5000-10000mg/Lå«æ°¯æ¶ˆæ¯’å‰‚æˆ–è¿‡æ°§ä¹™é…¸æº¶æ¶²çš„çº±å¸ƒå µå¡" },
                    note: "é‡ç‚¹æ¶ˆæ¯’é«˜é¢‘æ¥è§¦è¡¨é¢ï¼Œé€šé£æ¯å¤©3æ¬¡ï¼Œæ¯æ¬¡30åˆ†é’Ÿ"
                },
                "ä¼ æŸ“æ€§éå…¸å‹è‚ºç‚": {
                    pathogen: "SARSå† çŠ¶ç—…æ¯’",
                    transmission: "å‘¼å¸é“é£æ²«ã€å¯†åˆ‡æ¥è§¦",
                    level: "æœ€é«˜ï¼ˆæŒ‰ç”²ç±»ç®¡ç†ï¼‰",
                    environment: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "2000", unit: "mg/L", time: "60åˆ†é’Ÿ" },
                    air: { type: "è¿‡æ°§ä¹™é…¸", conc: "0.5", unit: "%", method: "æ°”æº¶èƒ¶å–·é›¾", time: "60åˆ†é’Ÿ" },
                    fabric: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "1000", unit: "mg/L", time: "60åˆ†é’Ÿ" },
                    corpse: { method: "ç«‹å³ç«åŒ–", note: "ç”¨æµ¸æœ‰5000-10000mg/Lå«æ°¯æ¶ˆæ¯’å‰‚æˆ–è¿‡æ°§ä¹™é…¸æº¶æ¶²çš„çº±å¸ƒå µå¡" },
                    note: "æŒ‰ç”²ç±»ä¼ æŸ“ç—…ç®¡ç†ï¼Œä¸¥æ ¼ç»ˆæœ«æ¶ˆæ¯’"
                },
                "ç‚­ç–½(è‚ºç‚­ç–½)": {
                    pathogen: "ç‚­ç–½èŠ½å­¢æ†èŒ",
                    transmission: "æ¥è§¦ã€å‘¼å¸é“ã€æ¶ˆåŒ–é“",
                    level: "æœ€é«˜ï¼ˆæŒ‰ç”²ç±»ç®¡ç†ï¼‰",
                    environment: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "2000", unit: "mg/L", time: "60åˆ†é’Ÿ" },
                    spore: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "10000", unit: "mg/L", time: "240åˆ†é’Ÿ", note: "èŠ½å­¢éœ€é«˜æµ“åº¦é•¿æ—¶é—´" },
                    fabric: { type: "ç„šçƒ§", note: "æ±¡æŸ“ç»‡ç‰©å»ºè®®ç„šçƒ§å¤„ç†" },
                    corpse: { method: "ç«åŒ–", note: "ç¦æ­¢å°¸æ£€ï¼Œå¯†é—­è¿è¾“è‡³ç«åŒ–åœº" },
                    note: "èŠ½å­¢æŠµæŠ—åŠ›æå¼ºï¼Œæ™®é€šæ¶ˆæ¯’éš¾ä»¥æ€ç­ï¼Œéœ€ä¸“ä¸šå¤„ç†"
                },
                "è‰¾æ»‹ç—…": {
                    pathogen: "HIVç—…æ¯’",
                    transmission: "è¡€æ¶²ã€æ€§æ¥è§¦ã€æ¯å©´ä¼ æ’­",
                    level: "ä¸­",
                    environment: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "500", unit: "mg/L", time: "30åˆ†é’Ÿ" },
                    blood: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "2000", unit: "mg/L", time: "60åˆ†é’Ÿ" },
                    instrument: { type: "æˆŠäºŒé†›", conc: "2", unit: "%", time: "30-60åˆ†é’Ÿ" },
                    note: "HIVå¯¹æ¶ˆæ¯’å‰‚æ•æ„Ÿï¼Œå¸¸è§„æ¶ˆæ¯’å³å¯ï¼Œé¿å…ç›´æ¥æ¥è§¦è¡€æ¶²ä½“æ¶²"
                },
                "ç—…æ¯’æ€§è‚ç‚": {
                    pathogen: "ç”²/ä¹™/ä¸™/ä¸/æˆŠå‹è‚ç‚ç—…æ¯’",
                    transmission: "ç²ª-å£ï¼ˆç”²ã€æˆŠï¼‰ã€è¡€æ¶²ä½“æ¶²ï¼ˆä¹™ã€ä¸™ã€ä¸ï¼‰",
                    level: "ä¸­",
                    environment: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "1000", unit: "mg/L", time: "30åˆ†é’Ÿ" },
                    excreta: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "5000-10000", unit: "mg/L", time: "60åˆ†é’Ÿ" },
                    blood: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "2000", unit: "mg/L", time: "60åˆ†é’Ÿ" },
                    food: { type: "ç…®æ²¸", method: "ç…®æ²¸15åˆ†é’Ÿ", note: "é¤å…·é¦–é€‰ç…®æ²¸æ¶ˆæ¯’" },
                    note: "ä¹™è‚ç—…æ¯’æŠµæŠ—åŠ›è¾ƒå¼ºï¼Œéœ€ä¿è¯æ¶ˆæ¯’æµ“åº¦å’Œä½œç”¨æ—¶é—´"
                },
                "è„Šé«“ç°è´¨ç‚": {
                    pathogen: "è„Šé«“ç°è´¨ç‚ç—…æ¯’",
                    transmission: "ç²ª-å£é€”å¾„",
                    level: "ä¸­",
                    environment: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "1000", unit: "mg/L", time: "30åˆ†é’Ÿ" },
                    excreta: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "5000", unit: "mg/L", time: "60åˆ†é’Ÿ" },
                    toy: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "500", unit: "mg/L", time: "30åˆ†é’Ÿ" },
                    note: "ç—…æ¯’æŠµæŠ—åŠ›ä¸­ç­‰ï¼Œæ³¨æ„ç²ªä¾¿å’Œæ±¡æŸ“ç‰©æ¶ˆæ¯’"
                },
                "éº»ç–¹": {
                    pathogen: "éº»ç–¹ç—…æ¯’",
                    transmission: "å‘¼å¸é“é£æ²«ã€æ¥è§¦ä¼ æ’­",
                    level: "ä¸­",
                    environment: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "500", unit: "mg/L", time: "30åˆ†é’Ÿ" },
                    air: { type: "é€šé£", method: "å¼€çª—é€šé£", time: "æ¯å¤©3æ¬¡ï¼Œæ¯æ¬¡30åˆ†é’Ÿ" },
                    fabric: { type: "æ›æ™’", method: "æ—¥å…‰æ›æ™’", time: "4-6å°æ—¶" },
                    note: "ç—…æ¯’æŠµæŠ—åŠ›å¼±ï¼Œé€šé£å’Œå¸¸è§„æ¶ˆæ¯’å³å¯"
                },
                "æµè¡Œæ€§å‡ºè¡€çƒ­": {
                    pathogen: "æ±‰å¦ç—…æ¯’",
                    transmission: "é¼ ç±»æ’æ³„ç‰©ã€å‘¼å¸é“ã€æ¶ˆåŒ–é“",
                    level: "ä¸­",
                    environment: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "1000", unit: "mg/L", time: "60åˆ†é’Ÿ" },
                    rodent: { type: "é¼ ç±»æ§åˆ¶", method: "ç­é¼ ", note: "åŒæ—¶è¿›è¡Œé¼ å¯†åº¦ç›‘æµ‹" },
                    excreta: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "5000", unit: "mg/L", time: "60åˆ†é’Ÿ" },
                    note: "é‡ç‚¹é˜²é¼ ç­é¼ ï¼Œæ±¡æŸ“åœºæ‰€å½»åº•æ¶ˆæ¯’"
                },
                "ç‹‚çŠ¬ç—…": {
                    pathogen: "ç‹‚çŠ¬ç—…æ¯’",
                    transmission: "åŠ¨ç‰©å’¬ä¼¤ã€æŠ“ä¼¤",
                    level: "é«˜",
                    environment: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "1000", unit: "mg/L", time: "30åˆ†é’Ÿ" },
                    wound: { type: "è‚¥çš‚æ°´", method: "è‚¥çš‚æ°´å†²æ´—", time: "15åˆ†é’Ÿ", note: "å†ç”¨ç¢˜ä¼æ¶ˆæ¯’" },
                    animal: { type: "ç„šçƒ§", method: "ç„šçƒ§æˆ–æ·±åŸ‹", note: "ç—…å…½å°¸ä½“æ·±åŸ‹2ç±³ä»¥ä¸‹" },
                    note: "ä¼¤å£å¤„ç†æœ€å…³é”®ï¼Œå°½å¿«æ¥ç§ç–«è‹—å’Œå…ç–«çƒè›‹ç™½"
                },
                "æµè¡Œæ€§ä¹™å‹è„‘ç‚": {
                    pathogen: "ä¹™è„‘ç—…æ¯’",
                    transmission: "èšŠåª’ä¼ æ’­",
                    level: "ä¸­",
                    environment: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "500", unit: "mg/L", time: "30åˆ†é’Ÿ" },
                    mosquito: { type: "èšŠåª’æ§åˆ¶", method: "ç­èšŠ", note: "æ¸…é™¤ç§¯æ°´ï¼Œä½¿ç”¨æ€è™«å‰‚" },
                    note: "é‡ç‚¹é˜²èšŠç­èšŠï¼Œç—…æ¯’æŠµæŠ—åŠ›å¼±"
                },
                "ç™»é©çƒ­": {
                    pathogen: "ç™»é©ç—…æ¯’",
                    transmission: "ä¼ŠèšŠå®å’¬",
                    level: "ä¸­",
                    environment: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "500", unit: "mg/L", time: "30åˆ†é’Ÿ" },
                    mosquito: { type: "ä¼ŠèšŠæ§åˆ¶", method: "æ¸…é™¤ç§¯æ°´å®¹å™¨", note: "ç¿»ç›†å€’ç½ï¼Œæ¶ˆç­å­³ç”Ÿåœ°" },
                    note: "æ— ç‰¹æ•ˆç–«è‹—ï¼Œä»¥ç­èšŠä¸ºä¸»"
                },
                "çŒ´ç—˜": {
                    pathogen: "çŒ´ç—˜ç—…æ¯’",
                    transmission: "å¯†åˆ‡æ¥è§¦ã€é£æ²«ã€æ±¡æŸ“ç‰©",
                    level: "é«˜",
                    environment: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "1000", unit: "mg/L", time: "60åˆ†é’Ÿ" },
                    fabric: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "1000", unit: "mg/L", time: "60åˆ†é’Ÿ" },
                    skin: { type: "ç¢˜ä¼", conc: "0.5", unit: "%", method: "çš®è‚¤æ¶ˆæ¯’" },
                    note: "ç—…æ¯’æŠµæŠ—åŠ›è¾ƒå¼ºï¼Œæ¶ˆæ¯’æµ“åº¦è¦é«˜ï¼Œæ³¨æ„ä¸ªäººé˜²æŠ¤"
                },
                "è‚ºç»“æ ¸": {
                    pathogen: "ç»“æ ¸åˆ†ææ†èŒ",
                    transmission: "å‘¼å¸é“é£æ²«",
                    level: "ä¸­",
                    environment: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "1000", unit: "mg/L", time: "60åˆ†é’Ÿ" },
                    air: { type: "ç´«å¤–çº¿", method: "ç´«å¤–çº¿ç…§å°„", time: "30-60åˆ†é’Ÿ" },
                    sputum: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "5000", unit: "mg/L", time: "60åˆ†é’Ÿ" },
                    note: "ç»“æ ¸æ†èŒæŠµæŠ—åŠ›å¼ºï¼Œéœ€å»¶é•¿æ¶ˆæ¯’æ—¶é—´"
                },
                "ä¼¤å¯’å’Œå‰¯ä¼¤å¯’": {
                    pathogen: "ä¼¤å¯’æ²™é—¨èŒã€å‰¯ä¼¤å¯’æ²™é—¨èŒ",
                    transmission: "ç²ª-å£é€”å¾„ã€æ±¡æŸ“çš„æ°´å’Œé£Ÿç‰©",
                    level: "ä¸­",
                    environment: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "1000", unit: "mg/L", time: "30åˆ†é’Ÿ" },
                    excreta: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "10000", unit: "mg/L", time: "120åˆ†é’Ÿ" },
                    water: { type: "ç…®æ²¸", method: "ç…®æ²¸", time: "5åˆ†é’Ÿ" },
                    food: { type: "ç…®æ²¸", method: "ç…®æ²¸15åˆ†é’Ÿ" },
                    note: "æ‚£è€…æ’æ³„ç‰©éšæ—¶æ¶ˆæ¯’ï¼Œé¤å…·ä¸“ç”¨"
                },
                "æµè¡Œæ€§è„‘è„Šé«“è†œç‚": {
                    pathogen: "è„‘è†œç‚å¥ˆç‘ŸèŒ",
                    transmission: "å‘¼å¸é“é£æ²«",
                    level: "ä¸­",
                    environment: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "500", unit: "mg/L", time: "30åˆ†é’Ÿ" },
                    air: { type: "é€šé£", method: "å¼€çª—é€šé£", time: "æ¯å¤©3æ¬¡" },
                    fabric: { type: "æ›æ™’", method: "æ—¥å…‰æ›æ™’", time: "4å°æ—¶" },
                    note: "ç»†èŒæŠµæŠ—åŠ›å¼±ï¼Œå¸¸è§„æ¶ˆæ¯’å³å¯"
                },
                "ç™¾æ—¥å’³": {
                    pathogen: "ç™¾æ—¥å’³é²ç‰¹èŒ",
                    transmission: "å‘¼å¸é“é£æ²«",
                    level: "ä½",
                    environment: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "500", unit: "mg/L", time: "30åˆ†é’Ÿ" },
                    air: { type: "é€šé£", method: "é€šé£", note: "ä¿æŒç©ºæ°”æµé€š" },
                    note: "å¸¸è§„æ¶ˆæ¯’å³å¯"
                },
                "ç™½å–‰": {
                    pathogen: "ç™½å–‰æ£’çŠ¶æ†èŒ",
                    transmission: "å‘¼å¸é“é£æ²«ã€æ¥è§¦",
                    level: "ä¸­",
                    environment: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "1000", unit: "mg/L", time: "30åˆ†é’Ÿ" },
                    fabric: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "500", unit: "mg/L", time: "30åˆ†é’Ÿ" },
                    note: "æ³¨æ„å‘¼å¸é“éš”ç¦»"
                },
                "çŒ©çº¢çƒ­": {
                    pathogen: "Aç»„é“¾çƒèŒ",
                    transmission: "å‘¼å¸é“é£æ²«ã€æ¥è§¦",
                    level: "ä½",
                    environment: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "500", unit: "mg/L", time: "30åˆ†é’Ÿ" },
                    note: "å¸¸è§„æ¶ˆæ¯’"
                },
                "å¸ƒé²æ°èŒç—…": {
                    pathogen: "å¸ƒé²æ°èŒ",
                    transmission: "æ¥è§¦æ„ŸæŸ“åŠ¨ç‰©ã€é£Ÿç”¨æœªç…®ç†Ÿè‚‰åˆ¶å“",
                    level: "ä¸­",
                    environment: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "1000", unit: "mg/L", time: "30åˆ†é’Ÿ" },
                    animal: { type: "ç„šçƒ§", method: "æ·±åŸ‹æˆ–ç„šçƒ§", note: "ç—…ç•œæ— å®³åŒ–å¤„ç†" },
                    note: "é‡ç‚¹åŠ¨ç‰©æ£€ç–«ï¼Œç”Ÿç†Ÿåˆ†å¼€"
                },
                "æ·‹ç—…ã€æ¢…æ¯’": {
                    pathogen: "æ·‹ç—…å¥ˆç‘ŸèŒã€æ¢…æ¯’èºæ—‹ä½“",
                    transmission: "æ€§æ¥è§¦ã€æ¯å©´",
                    level: "ä¸­",
                    environment: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "500", unit: "mg/L", time: "30åˆ†é’Ÿ" },
                    instrument: { type: "é«˜å‹è’¸æ±½", method: "121â„ƒé«˜å‹è’¸æ±½", time: "15åˆ†é’Ÿ" },
                    note: "èºæ—‹ä½“æŠµæŠ—åŠ›æå¼±ï¼Œå¸¸è§„æ¶ˆæ¯’å³å¯"
                },
                "é’©ç«¯èºæ—‹ä½“ç—…": {
                    pathogen: "é’©ç«¯èºæ—‹ä½“",
                    transmission: "æ¥è§¦ç–«æ°´ã€çš®è‚¤é»è†œ",
                    level: "ä¸­",
                    environment: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "1000", unit: "mg/L", time: "30åˆ†é’Ÿ" },
                    water: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "5", unit: "mg/L", time: "30åˆ†é’Ÿ" },
                    note: "é‡ç‚¹æ§åˆ¶é¼ ç±»å’ŒçŒª"
                },
                "ç–Ÿç–¾": {
                    pathogen: "ç–ŸåŸè™«",
                    transmission: "æŒ‰èšŠå®å’¬",
                    level: "ä¸­",
                    environment: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "500", unit: "mg/L", time: "30åˆ†é’Ÿ" },
                    mosquito: { type: "ç­èšŠ", method: "ç­èšŠ", note: "é˜²èšŠç­èšŠä¸ºä¸»" },
                    note: "æ— ç›´æ¥äººä¼ äººï¼Œæ— éœ€ç‰¹æ®Šæ¶ˆæ¯’"
                }
            },
            "ä¸™ç±»": {
                "æµè¡Œæ€§æ„Ÿå†’": {
                    pathogen: "æµæ„Ÿç—…æ¯’",
                    transmission: "å‘¼å¸é“é£æ²«ã€æ¥è§¦",
                    level: "ä½",
                    environment: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "500", unit: "mg/L", time: "30åˆ†é’Ÿ" },
                    air: { type: "é€šé£", method: "å¼€çª—é€šé£", time: "æ¯å¤©3æ¬¡" },
                    fabric: { type: "æ›æ™’", method: "æ—¥å…‰æ›æ™’", time: "4å°æ—¶" },
                    note: "å¸¸è§„æ¶ˆæ¯’ï¼Œé‡ç‚¹é€šé£"
                },
                "æµè¡Œæ€§è…®è…ºç‚": {
                    pathogen: "è…®è…ºç‚ç—…æ¯’",
                    transmission: "å‘¼å¸é“é£æ²«",
                    level: "ä½",
                    environment: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "500", unit: "mg/L", time: "30åˆ†é’Ÿ" },
                    air: { type: "é€šé£", method: "é€šé£" },
                    note: "å¸¸è§„æ¶ˆæ¯’"
                },
                "é£ç–¹": {
                    pathogen: "é£ç–¹ç—…æ¯’",
                    transmission: "å‘¼å¸é“é£æ²«",
                    level: "ä½",
                    environment: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "500", unit: "mg/L", time: "30åˆ†é’Ÿ" },
                    note: "å¸¸è§„æ¶ˆæ¯’"
                },
                "æ‰‹è¶³å£ç—…": {
                    pathogen: "è‚ é“ç—…æ¯’",
                    transmission: "ç²ª-å£ã€å‘¼å¸é“ã€æ¥è§¦",
                    level: "ä¸­",
                    environment: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "1000", unit: "mg/L", time: "30åˆ†é’Ÿ" },
                    toy: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "500", unit: "mg/L", time: "30åˆ†é’Ÿ" },
                    hand: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "500", unit: "mg/L", time: "1åˆ†é’Ÿ" },
                    note: "å„¿ç«¥ç©å…·ã€é¤å…·é‡ç‚¹æ¶ˆæ¯’ï¼Œæ³¨æ„æ‰‹å«ç”Ÿ"
                },
                "æ„ŸæŸ“æ€§è…¹æ³»ç—…": {
                    pathogen: "è¯ºå¦‚ç—…æ¯’ã€è½®çŠ¶ç—…æ¯’ç­‰",
                    transmission: "ç²ª-å£é€”å¾„",
                    level: "ä¸­",
                    environment: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "1000", unit: "mg/L", time: "30åˆ†é’Ÿ" },
                    excreta: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "10000", unit: "mg/L", time: "60åˆ†é’Ÿ" },
                    food: { type: "ç…®æ²¸", method: "ç…®æ²¸15åˆ†é’Ÿ" },
                    note: "è¯ºå¦‚ç—…æ¯’æŠµæŠ—åŠ›å¼ºï¼Œéœ€é«˜æµ“åº¦å«æ°¯æ¶ˆæ¯’å‰‚"
                },
                "æ€¥æ€§å‡ºè¡€æ€§ç»“è†œç‚": {
                    pathogen: "è‚ é“ç—…æ¯’70å‹ã€æŸ¯è¨å¥‡ç—…æ¯’",
                    transmission: "æ¥è§¦ä¼ æ’­",
                    level: "ä½",
                    environment: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "500", unit: "mg/L", time: "30åˆ†é’Ÿ" },
                    hand: { type: "75%ä¹™é†‡", method: "æ‰‹æ¶ˆæ¯’" },
                    note: "æ³¨æ„æ‰‹å«ç”Ÿï¼Œä¸ªäººç”¨å“ä¸“ç”¨"
                }
            }
        };

        // æ¨èæµ“åº¦æ•°æ®åº“
        const recommendations = {
            "ç¯å¢ƒè¡¨é¢æ¶ˆæ¯’": {
                "å«æ°¯æ¶ˆæ¯’å‰‚": [
                    { name: "ä¸€èˆ¬ç‰©ä½“è¡¨é¢", value: 500, time: "10-30åˆ†é’Ÿ" },
                    { name: "æ±¡æŸ“è¡¨é¢", value: 1000, time: "30åˆ†é’Ÿ" },
                    { name: "ä¼ æŸ“ç—…ç–«åŒº", value: 2000, time: "60åˆ†é’Ÿ" },
                    { name: "è¡€æ¶²ä½“æ¶²æ±¡æŸ“", value: 2000, time: "60åˆ†é’Ÿ" }
                ],
                "é†‡ç±»": [
                    { name: "ä¸€èˆ¬ç‰©ä½“è¡¨é¢", value: 75, time: "3-10åˆ†é’Ÿ", unit: "%" }
                ],
                "è¿‡æ°§åŒ–ç‰©ç±»": [
                    { name: "ä¸€èˆ¬ç‰©ä½“è¡¨é¢(è¿‡æ°§ä¹™é…¸)", value: 0.5, time: "10-30åˆ†é’Ÿ", unit: "%" },
                    { name: "ä¸€èˆ¬ç‰©ä½“è¡¨é¢(äºŒæ°§åŒ–æ°¯)", value: 100, time: "10-30åˆ†é’Ÿ", unit: "mg/L" }
                ],
                "å­£é“µç›ç±»": [
                    { name: "ä¸€èˆ¬ç‰©ä½“è¡¨é¢", value: 1000, time: "10-15åˆ†é’Ÿ" }
                ]
            },
            "é¤é¥®å…·æ¶ˆæ¯’": {
                "å«æ°¯æ¶ˆæ¯’å‰‚": [
                    { name: "ä¸€èˆ¬æ¶ˆæ¯’", value: 250, time: "20åˆ†é’Ÿ" },
                    { name: "ä¼ æŸ“ç—…æ¶ˆæ¯’", value: 500, time: "30åˆ†é’Ÿ" },
                    { name: "è‚ç‚ç—…æ¯’æ±¡æŸ“", value: 1000, time: "30åˆ†é’Ÿ" }
                ],
                "è¿‡æ°§åŒ–ç‰©ç±»": [
                    { name: "æµ¸æ³¡æ¶ˆæ¯’(è¿‡æ°§ä¹™é…¸)", value: 0.2, time: "30åˆ†é’Ÿ", unit: "%" },
                    { name: "æµ¸æ³¡æ¶ˆæ¯’(äºŒæ°§åŒ–æ°¯)", value: 100, time: "10-20åˆ†é’Ÿ", unit: "mg/L" }
                ]
            },
            "æœè”¬æ¶ˆæ¯’": {
                "å«æ°¯æ¶ˆæ¯’å‰‚": [
                    { name: "ä¸€èˆ¬æ¸…æ´—", value: 100, time: "10åˆ†é’Ÿ" },
                    { name: "å¸¸è§„æ¶ˆæ¯’", value: 200, time: "10åˆ†é’Ÿ" },
                    { name: "ç–«æºåœ°æœè”¬", value: 500, time: "30åˆ†é’Ÿ" }
                ],
                "è¿‡æ°§åŒ–ç‰©ç±»": [
                    { name: "æœè”¬æ¶ˆæ¯’(è¿‡æ°§ä¹™é…¸)", value: 0.1, time: "10åˆ†é’Ÿ", unit: "%" },
                    { name: "æœè”¬æ¶ˆæ¯’(äºŒæ°§åŒ–æ°¯)", value: 50, time: "10-20åˆ†é’Ÿ", unit: "mg/L" }
                ]
            },
            "ç»‡ç‰©æ¶ˆæ¯’": {
                "å«æ°¯æ¶ˆæ¯’å‰‚": [
                    { name: "ä¸€èˆ¬ç»‡ç‰©", value: 250, time: "20åˆ†é’Ÿ" },
                    { name: "ä¼ æŸ“ç—…ç»‡ç‰©", value: 500, time: "30åˆ†é’Ÿ" },
                    { name: "è¡€æ±¡æŸ“ç‰©", value: 2000, time: "60åˆ†é’Ÿ" }
                ],
                "è¿‡æ°§åŒ–ç‰©ç±»": [
                    { name: "ç»‡ç‰©æµ¸æ³¡(äºŒæ°§åŒ–æ°¯)", value: 100, time: "30åˆ†é’Ÿ", unit: "mg/L" },
                    { name: "ç»‡ç‰©æµ¸æ³¡(äºŒæ°§åŒ–æ°¯-èŠ½å­¢æ±¡æŸ“)", value: 500, time: "30åˆ†é’Ÿ", unit: "mg/L" },
                    { name: "ç»‡ç‰©æµ¸æ³¡(è¿‡æ°§ä¹™é…¸)", value: 0.2, time: "30-60åˆ†é’Ÿ", unit: "%" }
                ]
            },
            "æ‰‹æ¶ˆæ¯’": {
                "å«æ°¯æ¶ˆæ¯’å‰‚": [
                    { name: "å«ç”Ÿæ‰‹æ¶ˆæ¯’", value: 500, time: "1åˆ†é’Ÿ" },
                    { name: "å¤–ç§‘æ‰‹æ¶ˆæ¯’", value: 1000, time: "3åˆ†é’Ÿ" }
                ],
                "é†‡ç±»": [
                    { name: "å«ç”Ÿæ‰‹æ¶ˆæ¯’", value: 75, time: "1åˆ†é’Ÿ", unit: "%" },
                    { name: "å¤–ç§‘æ‰‹æ¶ˆæ¯’", value: 75, time: "3-5åˆ†é’Ÿ", unit: "%" }
                ],
                "å­£é“µç›ç±»": [
                    { name: "å«ç”Ÿæ‰‹æ¶ˆæ¯’", value: 1000, time: "1åˆ†é’Ÿ" }
                ],
                "è¿‡æ°§åŒ–ç‰©ç±»": [
                    { name: "æ‰‹æ¶ˆæ¯’(è¿‡æ°§åŒ–æ°¢)", value: 3, time: "1-3åˆ†é’Ÿ", unit: "%" }
                ]
            },
            "çš®è‚¤æ¶ˆæ¯’": {
                "é†‡ç±»": [
                    { name: "æ³¨å°„éƒ¨ä½", value: 75, time: "1åˆ†é’Ÿ", unit: "%" },
                    { name: "æ‰‹æœ¯éƒ¨ä½", value: 75, time: "3-5åˆ†é’Ÿ", unit: "%" }
                ],
                "å…¶ä»–": [
                    { name: "åˆ›é¢æ¶ˆæ¯’", value: 0.5, time: "2åˆ†é’Ÿ", unit: "%(ç¢˜ä¼)" }
                ],
                "è¿‡æ°§åŒ–ç‰©ç±»": [
                    { name: "çš®è‚¤æ¶ˆæ¯’(è¿‡æ°§åŒ–æ°¢)", value: 3, time: "1-3åˆ†é’Ÿ", unit: "%" }
                ]
            },
            "åŒ»ç–—å™¨æ¢°æ¶ˆæ¯’": {
                "å«æ°¯æ¶ˆæ¯’å‰‚": [
                    { name: "é«˜æ°´å¹³æ¶ˆæ¯’", value: 2000, time: "30åˆ†é’Ÿ" },
                    { name: "ä¸­æ°´å¹³æ¶ˆæ¯’", value: 1000, time: "20åˆ†é’Ÿ" }
                ],
                "è¿‡æ°§åŒ–ç‰©ç±»": [
                    { name: "æµ¸æ³¡æ¶ˆæ¯’(è¿‡æ°§ä¹™é…¸)", value: 0.2, time: "10-30åˆ†é’Ÿ", unit: "%" },
                    { name: "é«˜æ°´å¹³æ¶ˆæ¯’(è¿‡æ°§åŒ–æ°¢)", value: 6, time: "30åˆ†é’Ÿ", unit: "%" },
                    { name: "åŒ»ç–—å™¨æ¢°(äºŒæ°§åŒ–æ°¯)", value: 500, time: "30åˆ†é’Ÿ", unit: "mg/L" }
                ],
                "å…¶ä»–": [
                    { name: "é«˜æ°´å¹³æ¶ˆæ¯’(æˆŠäºŒé†›)", value: 2.0, time: "20-45åˆ†é’Ÿ", unit: "%(æˆŠäºŒé†›)" },
                    { name: "ç­èŒ(æˆŠäºŒé†›)", value: 2.0, time: "10å°æ—¶", unit: "%(æˆŠäºŒé†›)" }
                ]
            },
            "ç©ºæ°”æ¶ˆæ¯’": {
                "å«æ°¯æ¶ˆæ¯’å‰‚": [
                    { name: "ä¸€èˆ¬å–·é›¾æ¶ˆæ¯’", value: 500, time: "30-60åˆ†é’Ÿ" },
                    { name: "ç»ˆæœ«æ¶ˆæ¯’", value: 1000, time: "60åˆ†é’Ÿ" }
                ],
                "è¿‡æ°§åŒ–ç‰©ç±»": [
                    { name: "ç©ºæ°”å–·é›¾(è¿‡æ°§ä¹™é…¸)", value: 0.2, time: "30-60åˆ†é’Ÿ", unit: "%" },
                    { name: "ç©ºæ°”å–·é›¾(äºŒæ°§åŒ–æ°¯)", value: 100, time: "30åˆ†é’Ÿ", unit: "mg/L" },
                    { name: "ç©ºæ°”æ¶ˆæ¯’(è¿‡æ°§åŒ–æ°¢)", value: 3, time: "30-60åˆ†é’Ÿ", unit: "%" }
                ]
            },
            "ç–«æºåœ°æ¶ˆæ¯’": {
                "å«æ°¯æ¶ˆæ¯’å‰‚": [
                    { name: "ä¸€èˆ¬ç–«åŒº", value: 1000, time: "60åˆ†é’Ÿ" },
                    { name: "ä¸¥é‡ç–«åŒº", value: 2000, time: "120åˆ†é’Ÿ" },
                    { name: "æ’æ³„ç‰©", value: 20000, time: "120åˆ†é’Ÿ" },
                    { name: "å‘•åç‰©", value: 20000, time: "120åˆ†é’Ÿ" }
                ],
                "è¿‡æ°§åŒ–ç‰©ç±»": [
                    { name: "ç–«æºåœ°(è¿‡æ°§ä¹™é…¸)", value: 0.5, time: "30-60åˆ†é’Ÿ", unit: "%" },
                    { name: "ç–«æºåœ°(äºŒæ°§åŒ–æ°¯)", value: 500, time: "30-60åˆ†é’Ÿ", unit: "mg/L" }
                ]
            },
            "é¥®ç”¨æ°´æ¶ˆæ¯’": {
                "å«æ°¯æ¶ˆæ¯’å‰‚": [
                    { name: "å¸¸è§„æ¶ˆæ¯’", value: 1, time: "30åˆ†é’Ÿ" },
                    { name: "åº”æ€¥æ¶ˆæ¯’", value: 2, time: "30åˆ†é’Ÿ" },
                    { name: "ç–«æƒ…æœŸæ¶ˆæ¯’", value: 2, time: "60åˆ†é’Ÿ" }
                ],
                "è¿‡æ°§åŒ–ç‰©ç±»": [
                    { name: "é¥®ç”¨æ°´(äºŒæ°§åŒ–æ°¯)", value: 0.5, time: "30åˆ†é’Ÿ", unit: "mg/L" },
                    { name: "åº”æ€¥æ¶ˆæ¯’(äºŒæ°§åŒ–æ°¯)", value: 1, time: "30åˆ†é’Ÿ", unit: "mg/L" }
                ]
            },
            "æ±¡æ°´æ¶ˆæ¯’": {
                "å«æ°¯æ¶ˆæ¯’å‰‚": [
                    { name: "ä¸€èˆ¬æ±¡æ°´", value: 500, time: "60åˆ†é’Ÿ" },
                    { name: "åŒ»ç–—æ±¡æ°´", value: 1000, time: "90åˆ†é’Ÿ" },
                    { name: "ä¼ æŸ“ç—…æ±¡æ°´", value: 2000, time: "90åˆ†é’Ÿ" }
                ],
                "è¿‡æ°§åŒ–ç‰©ç±»": [
                    { name: "æ±¡æ°´æ¶ˆæ¯’(äºŒæ°§åŒ–æ°¯)", value: 10, time: "30åˆ†é’Ÿ", unit: "mg/L" }
                ]
            },
            "å†·é“¾/ç‰©æµæ¶ˆæ¯’": {
                "å«æ°¯æ¶ˆæ¯’å‰‚": [
                    { name: "å¤–åŒ…è£…", value: 500, time: "30åˆ†é’Ÿ" },
                    { name: "å†·é“¾é£Ÿå“è¡¨é¢", value: 500, time: "30åˆ†é’Ÿ" }
                ],
                "è¿‡æ°§åŒ–ç‰©ç±»": [
                    { name: "å†·é“¾è¡¨é¢(äºŒæ°§åŒ–æ°¯)", value: 150, time: "20åˆ†é’Ÿ", unit: "mg/L" },
                    { name: "å†·é“¾è¡¨é¢(è¿‡æ°§ä¹™é…¸)", value: 0.3, time: "20åˆ†é’Ÿ", unit: "%" }
                ]
            }
        };

        // åˆå§‹åŒ–
        function init() {
            // å¡«å……ç±»åˆ«
            const categorySelect = document.getElementById('category');
            Object.keys(disinfectantDB).forEach(cat => {
                const option = document.createElement('option');
                option.value = cat;
                option.textContent = cat;
                categorySelect.appendChild(option);
            });

            // å¡«å……æ¶ˆæ¯’å¯¹è±¡
            const objectSelect = document.getElementById('targetObject');
            Object.keys(recommendations).forEach(obj => {
                const option = document.createElement('option');
                option.value = obj;
                option.textContent = obj;
                objectSelect.appendChild(option);
            });

            // åŠ è½½è®°å½•å’Œæ–¹æ¡ˆ
            loadRecords();
            loadPresets();
            
            // åˆå§‹åŒ–æµè°ƒåˆ†ææ¨¡å—
            if (document.getElementById('epidemicAnalysis')) {
                initEpidemicAnalysis();
            }
            
            // åˆå§‹åŒ–AIé…ç½®
            if (document.getElementById('aiConfig')) {
                initAIConfig();
            }
        }

        // ========== ä¼ æŸ“ç—…æ–¹æ¡ˆåŠŸèƒ½ ==========
        
        function updateDiseaseList() {
            const diseaseClass = document.getElementById('diseaseClass').value;
            const select = document.getElementById('diseaseName');
            select.innerHTML = '<option value="">è¯·é€‰æ‹©å…·ä½“ä¼ æŸ“ç—…</option>';
            
            if (diseaseClass && diseaseDB[diseaseClass]) {
                Object.keys(diseaseDB[diseaseClass]).forEach(name => {
                    const option = document.createElement('option');
                    option.value = name;
                    option.textContent = name;
                    select.appendChild(option);
                });
            }
            
            document.getElementById('diseasePlan').style.display = 'none';
        }
        
        function showDiseasePlan() {
            const diseaseClass = document.getElementById('diseaseClass').value;
            const diseaseName = document.getElementById('diseaseName').value;
            
            if (!diseaseClass || !diseaseName || !diseaseDB[diseaseClass][diseaseName]) {
                document.getElementById('diseasePlan').style.display = 'none';
                return;
            }
            
            const plan = diseaseDB[diseaseClass][diseaseName];
            document.getElementById('planTitle').textContent = `ğŸ“‹ ${diseaseName} æ¶ˆæ¯’æ–¹æ¡ˆ`;
            
            let content = `
                <div style="margin-bottom: 15px;">
                    <span class="tag">${diseaseClass}ä¼ æŸ“ç—…</span>
                    <span class="tag">å±é™©ç­‰çº§: ${plan.level}</span>
                </div>
                <div class="result-item"><strong>ç—…åŸä½“:</strong> ${plan.pathogen}</div>
                <div class="result-item"><strong>ä¼ æ’­é€”å¾„:</strong> ${plan.transmission}</div>
            `;
            
            // ç¯å¢ƒæ¶ˆæ¯’
            if (plan.environment) {
                content += `<div class="result-item"><strong>ç¯å¢ƒè¡¨é¢æ¶ˆæ¯’:</strong> ${plan.environment.type} ${plan.environment.conc}${plan.environment.unit}ï¼Œä½œç”¨${plan.environment.time}</div>`;
            }
            
            // ç©ºæ°”æ¶ˆæ¯’
            if (plan.air) {
                if (plan.air.method) {
                    content += `<div class="result-item"><strong>ç©ºæ°”æ¶ˆæ¯’:</strong> ${plan.air.method}`;
                    if (plan.air.time) content += `ï¼Œ${plan.air.time}`;
                    content += `</div>`;
                } else {
                    content += `<div class="result-item"><strong>ç©ºæ°”æ¶ˆæ¯’:</strong> ${plan.air.type} ${plan.air.conc}${plan.air.unit}ï¼Œ${plan.air.method}ï¼Œä½œç”¨${plan.air.time}</div>`;
                }
            }
            
            // ç»‡ç‰©æ¶ˆæ¯’
            if (plan.fabric) {
                if (plan.fabric.method) {
                    content += `<div class="result-item"><strong>ç»‡ç‰©æ¶ˆæ¯’:</strong> ${plan.fabric.method}`;
                    if (plan.fabric.time) content += `ï¼Œ${plan.fabric.time}`;
                    content += `</div>`;
                } else {
                    content += `<div class="result-item"><strong>ç»‡ç‰©æ¶ˆæ¯’:</strong> ${plan.fabric.type} ${plan.fabric.conc}${plan.fabric.unit}ï¼Œä½œç”¨${plan.fabric.time}</div>`;
                }
            }
            
            // æ’æ³„ç‰©æ¶ˆæ¯’
            if (plan.excreta) {
                content += `<div class="result-item"><strong>æ’æ³„ç‰©æ¶ˆæ¯’:</strong> ${plan.excreta.type} ${plan.excreta.conc}${plan.excreta.unit}ï¼Œä½œç”¨${plan.excreta.time}</div>`;
            }
            
            // è¡€æ¶²æ¶ˆæ¯’
            if (plan.blood) {
                content += `<div class="result-item"><strong>è¡€æ¶²ä½“æ¶²æ¶ˆæ¯’:</strong> ${plan.blood.type} ${plan.blood.conc}${plan.blood.unit}ï¼Œä½œç”¨${plan.blood.time}</div>`;
            }
            
            // é¤é¥®å…·æ¶ˆæ¯’
            if (plan.food) {
                if (plan.food.method) {
                    content += `<div class="result-item"><strong>é¤é¥®å…·æ¶ˆæ¯’:</strong> ${plan.food.method}`;
                    if (plan.food.time) content += `ï¼Œ${plan.food.time}`;
                    content += `</div>`;
                } else {
                    content += `<div class="result-item"><strong>é¤é¥®å…·æ¶ˆæ¯’:</strong> ${plan.food.type} ${plan.food.conc}${plan.food.unit}ï¼Œä½œç”¨${plan.food.time}</div>`;
                }
            }
            
            // å™¨æ¢°æ¶ˆæ¯’
            if (plan.instrument) {
                if (plan.instrument.method) {
                    content += `<div class="result-item"><strong>åŒ»ç–—å™¨æ¢°æ¶ˆæ¯’:</strong> ${plan.instrument.method}`;
                    if (plan.instrument.time) content += `ï¼Œ${plan.instrument.time}`;
                    content += `</div>`;
                } else {
                    content += `<div class="result-item"><strong>åŒ»ç–—å™¨æ¢°æ¶ˆæ¯’:</strong> ${plan.instrument.type} ${plan.instrument.conc}${plan.instrument.unit}ï¼Œä½œç”¨${plan.instrument.time}</div>`;
                }
            }
            
            // å°¸ä½“å¤„ç†
            if (plan.corpse) {
                content += `<div class="result-item"><strong>å°¸ä½“å¤„ç†:</strong> ${plan.corpse.method}`;
                if (plan.corpse.note) content += `ï¼Œ${plan.corpse.note}`;
                content += `</div>`;
            }
            
            // ç‰¹æ®Šè¯´æ˜
            if (plan.note) {
                content += `<div class="steps" style="background: #fff3cd; border-left-color: #ffc107;"><strong>âš ï¸ ç‰¹åˆ«è¯´æ˜:</strong> ${plan.note}</div>`;
            }
            
            document.getElementById('planContent').innerHTML = content;
            document.getElementById('diseasePlan').style.display = 'block';
            
            // ä¿å­˜å½“å‰æ–¹æ¡ˆä¾›åº”ç”¨ä½¿ç”¨
            window.currentDiseasePlan = {
                name: diseaseName,
                class: diseaseClass,
                data: plan
            };
        }
        
        function applyDiseasePlan() {
            if (!window.currentDiseasePlan) return;
            
            const plan = window.currentDiseasePlan.data;
            // ä¼˜å…ˆä½¿ç”¨ç¯å¢ƒæ¶ˆæ¯’å‚æ•°
            if (plan.environment) {
                // è®¾ç½®ç±»åˆ«
                const categoryMap = {
                    "å«æ°¯æ¶ˆæ¯’å‰‚": "å«æ°¯æ¶ˆæ¯’å‰‚",
                    "äºŒæ°§åŒ–æ°¯": "è¿‡æ°§åŒ–ç‰©ç±»",
                    "è¿‡æ°§ä¹™é…¸": "è¿‡æ°§åŒ–ç‰©ç±»",
                    "è¿‡æ°§åŒ–æ°¢": "è¿‡æ°§åŒ–ç‰©ç±»",
                    "æˆŠäºŒé†›": "å…¶ä»–",
                    "75%ä¹™é†‡": "é†‡ç±»",
                    "ç¢˜ä¼": "å…¶ä»–"
                };
                
                const category = categoryMap[plan.environment.type] || "å«æ°¯æ¶ˆæ¯’å‰‚";
                document.getElementById('category').value = category;
                updateDisinfectants();
                
                // é€‰æ‹©å…·ä½“æ¶ˆæ¯’å‰‚
                const disinfectantSelect = document.getElementById('disinfectant');
                for (let i = 0; i < disinfectantSelect.options.length; i++) {
                    if (disinfectantSelect.options[i].text.includes(plan.environment.type) ||
                        (plan.environment.type.includes("84") && disinfectantSelect.options[i].text.includes("84"))) {
                        disinfectantSelect.selectedIndex = i;
                        break;
                    }
                }
                updateConcentration();
                
                // è®¾ç½®ç›®æ ‡æµ“åº¦
                document.getElementById('targetConc').value = plan.environment.conc;
                const unitSelect = document.getElementById('targetUnit');
                if (plan.environment.unit === "mg/L") {
                    unitSelect.value = "mg/L";
                } else {
                    unitSelect.value = "%";
                }
            }
            
            // åˆ‡æ¢åˆ°è®¡ç®—æ ‡ç­¾
            document.querySelectorAll('.tab')[0].click();
            alert(`å·²åº”ç”¨ ${window.currentDiseasePlan.name} çš„æ¶ˆæ¯’æ–¹æ¡ˆå‚æ•°ï¼Œè¯·æ£€æŸ¥å¹¶ç‚¹å‡»è®¡ç®—`);
        }
        
        function exportDiseasePlan() {
            if (!window.currentDiseasePlan) return;
            
            const plan = window.currentDiseasePlan.data;
            let text = `${window.currentDiseasePlan.name} æ¶ˆæ¯’æ–¹æ¡ˆ\n`;
            text += `ä¼ æŸ“ç—…ç±»åˆ«: ${window.currentDiseasePlan.class}ç±»\n`;
            text += `ç—…åŸä½“: ${plan.pathogen}\n`;
            text += `ä¼ æ’­é€”å¾„: ${plan.transmission}\n`;
            text += `å±é™©ç­‰çº§: ${plan.level}\n\n`;
            
            if (plan.environment) {
                text += `ç¯å¢ƒæ¶ˆæ¯’: ${plan.environment.type} ${plan.environment.conc}${plan.environment.unit}ï¼Œä½œç”¨${plan.environment.time}\n`;
            }
            if (plan.excreta) {
                text += `æ’æ³„ç‰©æ¶ˆæ¯’: ${plan.excreta.type} ${plan.excreta.conc}${plan.excreta.unit}ï¼Œä½œç”¨${plan.excreta.time}\n`;
            }
            if (plan.corpse) {
                text += `å°¸ä½“å¤„ç†: ${plan.corpse.method}`;
                if (plan.corpse.note) text += `ï¼Œ${plan.corpse.note}`;
                text += `\n`;
            }
            if (plan.note) {
                text += `\nç‰¹åˆ«è¯´æ˜: ${plan.note}\n`;
            }
            
            const blob = new Blob([text], { type: 'text/plain;charset=utf-8' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = `${window.currentDiseasePlan.name}_æ¶ˆæ¯’æ–¹æ¡ˆ.txt`;
            link.click();
        }

        // åˆ‡æ¢æ ‡ç­¾é¡µ
        function switchTab(tabName) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            
            event.target.classList.add('active');
            document.getElementById(tabName).classList.add('active');
        }

        // æ›´æ–°æ¶ˆæ¯’å‰‚åˆ—è¡¨
        function updateDisinfectants() {
            const category = document.getElementById('category').value;
            const select = document.getElementById('disinfectant');
            select.innerHTML = '<option value="">è¯·é€‰æ‹©</option>';
            
            if (category && disinfectantDB[category]) {
                Object.keys(disinfectantDB[category]).forEach(name => {
                    const option = document.createElement('option');
                    option.value = name;
                    option.textContent = name;
                    select.appendChild(option);
                });
            }
        }

        // æ›´æ–°æµ“åº¦
        function updateConcentration() {
            const category = document.getElementById('category').value;
            const name = document.getElementById('disinfectant').value;
            
            if (category && name && disinfectantDB[category][name]) {
                const info = disinfectantDB[category][name];
                document.getElementById('sourceConc').value = info.conc;
                
                // è‡ªåŠ¨åˆ‡æ¢å•ä½
                const unitSelect = document.getElementById('targetUnit');
                const unitLabel = document.querySelector('label[for="targetConc"]');
                
                // æ˜¾ç¤º/éšè—å«æ°¯é‡ä¿¡æ¯
                displayChlorineInfo(category, name, info);
                
                if (info.unitMode === 'clo2_mgl') {
                    // äºŒæ°§åŒ–æ°¯ä¸“ç”¨ mg/L æ¨¡å¼
                    unitSelect.value = 'mg/L';
                    unitSelect.disabled = true;
                    unitLabel.textContent = 'ç›®æ ‡æµ“åº¦ (mg/L)';
                    document.getElementById('targetConc').placeholder = 'å¦‚: 100';
                } else if (info.unitMode === 'percent') {
                    // è¿‡æ°§åŒ–ç‰©/é†‡ç±»ç­‰ç™¾åˆ†æ¯”æ¨¡å¼
                    unitSelect.value = '%';
                    unitSelect.disabled = true;
                    unitLabel.textContent = 'ç›®æ ‡æµ“åº¦ (%)';
                    document.getElementById('targetConc').placeholder = 'å¦‚: 0.5';
                } else {
                    // å«æ°¯æ¶ˆæ¯’å‰‚æ¨¡å¼ - å¯åˆ‡æ¢
                    unitSelect.value = 'mg/L';
                    unitSelect.disabled = false;
                    unitLabel.textContent = 'ç›®æ ‡æµ“åº¦';
                    document.getElementById('targetConc').placeholder = 'å¦‚: 500';
                }
            }
        }
        
        // æ˜¾ç¤ºå«æ°¯æ¶ˆæ¯’å‰‚ä¿¡æ¯
        function displayChlorineInfo(category, name, info) {
            // æŸ¥æ‰¾æˆ–åˆ›å»ºä¿¡æ¯å®¹å™¨
            let infoContainer = document.getElementById('chlorineInfoContainer');
            if (!infoContainer) {
                // åœ¨form-rowåæ’å…¥ä¿¡æ¯å®¹å™¨
                const targetRow = document.querySelector('#calc .form-row');
                infoContainer = document.createElement('div');
                infoContainer.id = 'chlorineInfoContainer';
                targetRow.parentNode.insertBefore(infoContainer, targetRow.nextSibling);
            }
            
            // åˆ¤æ–­æ˜¯å¦ä¸ºå›ºä½“
            const isSolid = info.type === 'å›ºä½“';
            const typeIcon = isSolid ? 'ğŸ“¦' : 'ğŸ§ª';
            const typeLabel = isSolid ? 'å›ºä½“/ç²‰å‰‚' : 'æ¶²ä½“';
            
            // åªæœ‰å«æ°¯æ¶ˆæ¯’å‰‚æ‰æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯
            if (category === 'å«æ°¯æ¶ˆæ¯’å‰‚') {
                // è®¡ç®—æœ‰æ•ˆæ°¯å«é‡æè¿°
                let chlorineLevel = '';
                let levelColor = '';
                if (info.conc >= 50) {
                    chlorineLevel = 'é«˜æµ“åº¦';
                    levelColor = '#e74c3c';
                } else if (info.conc >= 20) {
                    chlorineLevel = 'ä¸­é«˜æµ“åº¦';
                    levelColor = '#f39c12';
                } else if (info.conc >= 5) {
                    chlorineLevel = 'ä¸­æµ“åº¦';
                    levelColor = '#3498db';
                } else {
                    chlorineLevel = 'ä½æµ“åº¦';
                    levelColor = '#27ae60';
                }
                
                // è®¡ç®—ç›¸å½“äºå¤šå°‘mg/Lçš„æœ‰æ•ˆæ°¯
                const mgPerLiter = info.conc * 10000;
                
                // å›ºä½“å’Œæ¶²ä½“çš„ç”¨é‡å•ä½ä¸åŒ
                const unitText = isSolid ? 'æ¯100gå«æœ‰æ•ˆæ°¯' : 'æ¯100mLå«æœ‰æ•ˆæ°¯';
                const amountText = isSolid ? `${(info.conc * 1000).toLocaleString()}mg` : `${(info.conc * 1000).toLocaleString()}mg`;
                
                infoContainer.innerHTML = `
                    <div style="background: linear-gradient(135deg, #f0f7ff 0%, #e3f2fd 100%); padding: 15px; border-radius: 8px; margin-bottom: 20px; border-left: 4px solid ${levelColor};"
                    >
                        <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 10px;"
                        >
                            <div>
                                <div style="font-weight: bold; color: #333; margin-bottom: 5px;"
                                >
                                    ${typeIcon} ${name} - ${typeLabel}
                                    <span style="background: ${levelColor}; color: white; padding: 2px 8px; border-radius: 10px; font-size: 12px; margin-left: 10px;"
                                    >${chlorineLevel}</span>
                                </div>
                                <div style="font-size: 14px; color: #666;"
                                >
                                    åŸæ¶²æµ“åº¦: <strong style="color: ${levelColor}; font-size: 16px;"
                                    >${info.conc}%</strong> 
                                    <span style="margin: 0 10px;"
                                    >|</span>
                                    æœ‰æ•ˆæ°¯: <strong>${mgPerLiter.toLocaleString()} mg/L</strong>
                                </div>
                            </div>
                            <div style="text-align: right;"
                            >
                                <div style="font-size: 12px; color: #999; margin-bottom: 5px;"
                                >${typeLabel}</div>
                                <div style="font-size: 14px; color: ${isSolid ? '#e67e22' : '#3498db'}; font-weight: bold;"
                                >
                                    ${isSolid ? 'âš–ï¸ æŒ‰é‡é‡é…æ¯”' : 'ğŸ’§ æŒ‰ä½“ç§¯é…æ¯”'}
                                </div>
                            </div>
                        </div>
                        
                        <div style="margin-top: 10px; padding-top: 10px; border-top: 1px dashed #ccc; font-size: 13px; color: #666;"
                        >
                            ğŸ’¡ <strong>è¯´æ˜ï¼š</strong>${unitText}${amountText}ï¼Œ
                            ${isSolid ? 'éœ€å…ˆæº¶è§£äºæ°´åå†ä½¿ç”¨ï¼ŒæŒ‰<strong>é‡é‡(g)</strong>è®¡ç®—ç”¨é‡' : 'ç›´æ¥ä½¿ç”¨åŸæ¶²ï¼ŒæŒ‰<strong>ä½“ç§¯(mL)</strong>è®¡ç®—ç”¨é‡'}
                        </div>
                        
                        ${isSolid ? `
                        <div style="margin-top: 8px; padding: 8px; background: #fff3e0; border-radius: 4px; font-size: 12px; color: #e65100;"
                        >
                            âš ï¸ <strong>å›ºä½“æ¶ˆæ¯’å‰‚ä½¿ç”¨æç¤ºï¼š</strong>ç²‰å‰‚éœ€å……åˆ†æ…æ‹Œæº¶è§£ï¼Œå»ºè®®å…ˆç”¨å°‘é‡æ°´è°ƒæˆç³ŠçŠ¶ï¼Œå†åŠ æ°´è‡³ç›®æ ‡ä½“ç§¯
                        </div>
                        ` : ''}
                    </div>
                `;
            } else if (category === 'è¿‡æ°§åŒ–ç‰©ç±»') {
                // è¿‡æ°§åŒ–ç‰©ç±»æ˜¾ç¤ºä¸åŒçš„ä¿¡æ¯
                let peroxideType = '';
                if (name.includes('äºŒæ°§åŒ–æ°¯')) {
                    peroxideType = 'äºŒæ°§åŒ–æ°¯å«é‡';
                } else if (name.includes('è¿‡æ°§ä¹™é…¸')) {
                    peroxideType = 'è¿‡æ°§ä¹™é…¸å«é‡';
                } else if (name.includes('è¿‡æ°§åŒ–æ°¢')) {
                    peroxideType = 'è¿‡æ°§åŒ–æ°¢å«é‡';
                }
                
                // åˆ¤æ–­æ˜¯å¦ä¸ºå›ºä½“ï¼ˆäºŒæ°§åŒ–æ°¯æ³¡è…¾ç‰‡ï¼‰
                const isPeroxideSolid = info.type === 'å›ºä½“';
                
                infoContainer.innerHTML = `
                    <div style="background: linear-gradient(135deg, #fff5f5 0%, #ffe0e0 100%); padding: 15px; border-radius: 8px; margin-bottom: 20px; border-left: 4px solid #e74c3c;"
                    >
                        <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 10px;"
                        >
                            <div>
                                <div style="font-weight: bold; color: #333; margin-bottom: 5px;"
                                >
                                    ${isPeroxideSolid ? 'ğŸ“¦' : 'âš—ï¸'} ${name} ${isPeroxideSolid ? '- å›ºä½“/ç‰‡å‰‚' : ''}
                                </div>
                                <div style="font-size: 14px; color: #666;"
                                >
                                    åŸæ¶²æµ“åº¦: <strong style="color: #e74c3c; font-size: 16px;"
                                    >${info.conc}%</strong>
                                    ${isPeroxideSolid ? '<span style="margin-left: 10px; color: #e67e22; font-weight: bold;">âš–ï¸ æŒ‰é‡é‡/ç‰‡æ•°é…æ¯”</span>' : ''}
                                </div>
                            </div>
                            <div style="text-align: right;"
                            >
                                <div style="font-size: 18px; font-weight: bold; color: #e74c3c;"
                                >
                                    ${peroxideType}
                                </div>
                                <div style="font-size: 12px; color: #999;"
                                >${isPeroxideSolid ? 'æŒ‰ç‰‡å‰‚è¯´æ˜ä½¿ç”¨' : 'è…èš€æ€§è¾ƒå¼ºï¼Œæ³¨æ„é˜²æŠ¤'}</div>
                            </div>
                        </div>
                        ${isPeroxideSolid ? `
                        <div style="margin-top: 8px; padding: 8px; background: #fff3e0; border-radius: 4px; font-size: 12px; color: #e65100;"
                        >
                            âš ï¸ <strong>æ³¡è…¾ç‰‡ä½¿ç”¨æç¤ºï¼š</strong>å°†ç‰‡å‰‚æŠ•å…¥æ°´ä¸­ï¼Œå¾…å®Œå…¨æº¶è§£åå†ä½¿ç”¨ã€‚å…·ä½“ç”¨é‡è¯·å‚è€ƒäº§å“è¯´æ˜ä¹¦
                        </div>
                        ` : ''}
                    </div>
                `;
            } else if (category === 'é†‡ç±»') {
                infoContainer.innerHTML = `
                    <div style="background: linear-gradient(135deg, #f0fff4 0%, #e0ffe4 100%); padding: 15px; border-radius: 8px; margin-bottom: 20px; border-left: 4px solid #27ae60;"
                    >
                        <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 10px;"
                        >
                            <div>
                                <div style="font-weight: bold; color: #333; margin-bottom: 5px;"
                                >
                                    ğŸ¶ ${name} - æ¶²ä½“
                                </div>
                                <div style="font-size: 14px; color: #666;"
                                >
                                    ä¹™é†‡å«é‡: <strong style="color: #27ae60; font-size: 16px;"
                                    >${info.conc}%</strong>
                                    <span style="margin-left: 10px; color: #3498db; font-weight: bold;"
                                    >ğŸ’§ æŒ‰ä½“ç§¯é…æ¯”</span>
                                </div>
                            </div>
                            <div style="text-align: right;"
                            >
                                <div style="font-size: 14px; color: #27ae60;"
                                >
                                    æ˜“æŒ¥å‘ï¼Œæ˜“ç‡ƒ
                                </div>
                                <div style="font-size: 12px; color: #999;"
                                >è¿œç¦»ç«æº</div>
                            </div>
                        </div>
                    </div>
                `;
            } else {
                // å…¶ä»–ç±»å‹æ¸…ç©ºæ˜¾ç¤º
                infoContainer.innerHTML = '';
            }
        }

        // åˆ‡æ¢è®¡ç®—æ¨¡å¼
        function changeMode() {
            const mode = document.querySelector('input[name="calcMode"]:checked').value;
            document.getElementById('volumeRow').style.display = mode === 'volume' ? 'grid' : 'none';
        }

        // æ›´æ–°å ä½ç¬¦
        function updatePlaceholder() {
            const unit = document.getElementById('targetUnit').value;
            const input = document.getElementById('targetConc');
            input.placeholder = unit === 'mg/L' ? 'å¦‚: 500' : 'å¦‚: 0.5';
        }

        // è®¡ç®—
        function calculate() {
            const mode = document.querySelector('input[name="calcMode"]:checked').value;
            const category = document.getElementById('category').value;
            const disinfectant = document.getElementById('disinfectant').value;
            const sourceConc = parseFloat(document.getElementById('sourceConc').value);
            const targetConc = parseFloat(document.getElementById('targetConc').value);
            const targetUnit = document.getElementById('targetUnit').value;

            if (!disinfectant || isNaN(sourceConc) || isNaN(targetConc)) {
                alert('è¯·å¡«å†™å®Œæ•´å‚æ•°');
                return;
            }

            // è·å–æ¶ˆæ¯’å‰‚ç±»å‹å’Œå½¢æ€
            const unitMode = disinfectantDB[category][disinfectant].unitMode;
            const isSolid = disinfectantDB[category][disinfectant].type === 'å›ºä½“';
            const unitLabel = isSolid ? 'g' : 'mL';
            const unitText = isSolid ? 'å…‹' : 'æ¯«å‡';
            let resultHTML = '';

            if (mode === 'dilution') {
                // è®¡ç®—ç¨€é‡Šå€æ•°
                let dilution;
                
                if (unitMode === 'clo2_mgl') {
                    // äºŒæ°§åŒ–æ°¯ä¸“ç”¨è®¡ç®—: 2% = 20000 mg/L
                    const sourceConcMgL = sourceConc * 10000;
                    dilution = sourceConcMgL / targetConc;
                } else if (targetUnit === 'mg/L') {
                    // å«æ°¯æ¶ˆæ¯’å‰‚: 5% = 50000 mg/L
                    const sourceConcMgL = sourceConc * 10000;
                    dilution = sourceConcMgL / targetConc;
                } else {
                    // ç™¾åˆ†æ¯”æ¨¡å¼
                    dilution = sourceConc / targetConc;
                }
                dilution = Math.round(dilution * 100) / 100;

                // ç¤ºä¾‹è®¡ç®—ï¼ˆå‡è®¾é…åˆ¶1000mLï¼‰
                const exampleVol = 1000;
                const exampleSource = (exampleVol / dilution).toFixed(1);
                const exampleWater = (exampleVol - exampleSource).toFixed(1);
                
                // å›ºä½“æ¶ˆæ¯’å‰‚çš„é…åˆ¶è¯´æ˜
                const solidSteps = isSolid ? `
                    <li>ç§°å– ${exampleSource} ${unitLabel} ${disinfectant}</li>
                    <li>å…ˆç”¨å°‘é‡æ°´è°ƒæˆç³ŠçŠ¶</li>
                    <li>å†åŠ æ¸…æ°´è‡³ ${exampleVol} mLï¼Œå……åˆ†æ…æ‹Œæº¶è§£</li>
                ` : `
                    <li>å– ${exampleSource} ${unitLabel} ${disinfectant}</li>
                    <li>åŠ  ${exampleWater} mL æ¸…æ°´</li>
                    <li>å……åˆ†æ··åŒ€</li>
                `;

                resultHTML = `
                    <div class="result-item"><strong>æ¶ˆæ¯’å‰‚:</strong> ${disinfectant} 
                        <span style="color: ${isSolid ? '#e67e22' : '#3498db'}; font-size: 12px;"
                        >(${isSolid ? 'å›ºä½“/ç²‰å‰‚' : 'æ¶²ä½“'})</span>
                    </div>
                    <div class="result-item"><strong>åŸæ¶²æµ“åº¦:</strong> ${sourceConc}%</div>
                    <div class="result-item"><strong>ç›®æ ‡æµ“åº¦:</strong> ${targetConc} ${targetUnit}</div>
                    <div class="result-item"><strong>ç¨€é‡Šå€æ•°:</strong> <span class="highlight">1:${dilution}</span></div>
                    <div class="steps">
                        <strong>é…åˆ¶æ–¹æ³•:</strong>
                        <ol>
                            <li>å– 1 ${isSolid ? 'ä»½é‡é‡' : 'ä»½ä½“ç§¯'} ${disinfectant}</li>
                            <li>åŠ  ${dilution - 1} ä»½æ°´${isSolid ? 'ï¼ˆç”¨äºæº¶è§£ï¼‰' : ''}</li>
                            <li>å……åˆ†${isSolid ? 'æ…æ‹Œæº¶è§£' : 'æ··åŒ€'}</li>
                        </ol>
                        <strong>ç¤ºä¾‹:</strong> é…åˆ¶ ${exampleVol} mL æ¶ˆæ¯’æ¶²<br>
                        <ol style="margin-top: 5px;">${solidSteps}</ol>
                    </div>
                    ${isSolid ? '<div style="background: #fff3e0; padding: 10px; border-radius: 5px; margin-top: 10px; font-size: 13px; color: #e65100;">âš ï¸ <strong>æ³¨æ„ï¼š</strong>å›ºä½“æ¶ˆæ¯’å‰‚æŒ‰<strong>é‡é‡(g)</strong>è®¡ç®—ï¼Œéœ€å®Œå…¨æº¶è§£åä½¿ç”¨</div>' : ''}
                `;

                addRecord(disinfectant, sourceConc, `${targetConc} ${targetUnit}`, `1:${dilution}`, '');
            } else {
                // è®¡ç®—é…åˆ¶é‡
                const targetVol = parseFloat(document.getElementById('targetVol').value);
                if (isNaN(targetVol)) {
                    alert('è¯·è¾“å…¥ç›®æ ‡ä½“ç§¯');
                    return;
                }

                let sourceNeeded;
                
                if (unitMode === 'clo2_mgl') {
                    // äºŒæ°§åŒ–æ°¯ä¸“ç”¨è®¡ç®—
                    const sourceConcMgL = sourceConc * 10000;
                    sourceNeeded = (targetConc * targetVol) / sourceConcMgL;
                } else if (targetUnit === 'mg/L') {
                    // å«æ°¯æ¶ˆæ¯’å‰‚
                    const sourceConcMgL = sourceConc * 10000;
                    sourceNeeded = (targetConc * targetVol) / sourceConcMgL;
                } else {
                    // ç™¾åˆ†æ¯”æ¨¡å¼
                    sourceNeeded = (targetConc * targetVol) / sourceConc;
                }
                sourceNeeded = Math.round(sourceNeeded * 10) / 10;
                const waterNeeded = targetVol - sourceNeeded;
                const dilution = Math.round((targetVol / sourceNeeded) * 100) / 100;

                // å›ºä½“æ¶ˆæ¯’å‰‚çš„é…åˆ¶æ­¥éª¤
                const solidSteps = isSolid ? `
                    <li>ç”¨å¤©å¹³ç§°å– <strong>${sourceNeeded} ${unitLabel}</strong> ${disinfectant}</li>
                    <li>å°†ç²‰å‰‚å€’å…¥å®¹å™¨ä¸­ï¼Œå…ˆåŠ å…¥å°‘é‡æ¸…æ°´ï¼ˆçº¦50-100mLï¼‰</li>
                    <li>æ…æ‹Œè°ƒæˆç³ŠçŠ¶ï¼Œç¡®ä¿æ— ç»“å—</li>
                    <li>ç»§ç»­åŠ æ°´è‡³æ€»å®¹é‡ä¸º ${targetVol} mL</li>
                    <li>å……åˆ†æ…æ‹Œè‡³å®Œå…¨æº¶è§£</li>
                ` : `
                    <li>é‡å– <strong>${sourceNeeded} ${unitLabel}</strong> ${disinfectant}</li>
                    <li>åŠ å…¥ <strong>${waterNeeded} mL</strong> æ¸…æ°´</li>
                    <li>å……åˆ†æ··åŒ€</li>
                `;

                resultHTML = `
                    <div class="result-item"><strong>æ¶ˆæ¯’å‰‚:</strong> ${disinfectant} 
                        <span style="color: ${isSolid ? '#e67e22' : '#3498db'}; font-size: 12px;"
                        >(${isSolid ? 'å›ºä½“/ç²‰å‰‚' : 'æ¶²ä½“'})</span>
                    </div>
                    <div class="result-item"><strong>åŸæ¶²æµ“åº¦:</strong> ${sourceConc}%</div>
                    <div class="result-item"><strong>ç›®æ ‡æµ“åº¦:</strong> ${targetConc} ${targetUnit}</div>
                    <div class="result-item"><strong>ç›®æ ‡ä½“ç§¯:</strong> ${targetVol} mL</div>
                    <div class="result-item"><strong>éœ€è¦${isSolid ? 'ç§°å–' : 'é‡å–'}:</strong> 
                        <span class="highlight">${sourceNeeded} ${unitLabel}</span>
                        <span style="font-size: 12px; color: #666;">(${unitText})</span>
                    </div>
                    <div class="result-item"><strong>éœ€è¦åŠ æ°´:</strong> <span class="highlight">${isSolid ? 'è‡³æ€»é‡' : ''} ${waterNeeded} mL</span></div>
                    <div class="result-item"><strong>ç¨€é‡Šå€æ•°:</strong> 1:${dilution}</div>
                    <div class="steps">
                        <strong>æ“ä½œæ­¥éª¤:</strong>
                        <ol>${solidSteps}</ol>
                        <li>æ ‡æ³¨æµ“åº¦ã€æ—¥æœŸå’Œç”¨é€”</li>
                    </div>
                    ${isSolid ? '<div style="background: #fff3e0; padding: 10px; border-radius: 5px; margin-top: 10px; font-size: 13px; color: #e65100;">âš–ï¸ <strong>å›ºä½“æ¶ˆæ¯’å‰‚ä¸“ç”¨æç¤ºï¼š</strong>éœ€ä½¿ç”¨å¤©å¹³ç§°é‡ï¼Œå…ˆè°ƒæˆç³ŠçŠ¶å†åŠ æ°´å®šå®¹ï¼Œç¡®ä¿å®Œå…¨æº¶è§£</div>' : ''}
                `;

                addRecord(disinfectant, sourceConc, `${targetConc} ${targetUnit}`, `1:${dilution}`, targetVol);
            }

            document.getElementById('resultContent').innerHTML = resultHTML;
            document.getElementById('result').style.display = 'block';
        }

        // æ¸…ç©º
        function clearCalc() {
            document.getElementById('category').value = '';
            document.getElementById('disinfectant').innerHTML = '<option value="">è¯·é€‰æ‹©</option>';
            document.getElementById('sourceConc').value = '5.0';
            document.getElementById('targetConc').value = '500';
            document.getElementById('targetVol').value = '1000';
            document.getElementById('result').style.display = 'none';
            
            // é‡ç½®å•ä½é€‰æ‹©å™¨
            const unitSelect = document.getElementById('targetUnit');
            unitSelect.disabled = false;
            unitSelect.value = 'mg/L';
            document.querySelector('label[for="targetConc"]').textContent = 'ç›®æ ‡æµ“åº¦';
        }

        // æ˜¾ç¤ºæ¨èæµ“åº¦
        function showRecommendations() {
            const obj = document.getElementById('targetObject').value;
            const tbody = document.getElementById('recommendBody');
            tbody.innerHTML = '';

            if (!obj || !recommendations[obj]) return;

            Object.entries(recommendations[obj]).forEach(([type, items]) => {
                items.forEach(item => {
                    let concStr = item.value;
                    if (item.unit) {
                        concStr += item.unit;
                    } else if (type === 'å«æ°¯æ¶ˆæ¯’å‰‚' || type === 'å­£é“µç›ç±»') {
                        concStr += ' mg/L';
                    } else {
                        concStr += ' %';
                    }

                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${type}</td>
                        <td>${item.name}</td>
                        <td>${concStr}</td>
                        <td>${item.time}</td>
                        <td>${item.note || ''}</td>
                        <td><button class="btn btn-small btn-primary" onclick='useRecommendation("${type}", "${item.value}", "${item.unit || ''}")'>ä½¿ç”¨</button></td>
                    `;
                    tbody.appendChild(row);
                });
            });
        }

        // ä½¿ç”¨æ¨èé…ç½®
        function useRecommendation(type, value, unit) {
            document.getElementById('targetConc').value = value;
            const unitSelect = document.getElementById('targetUnit');
            
            if (unit) {
                if (unit.includes('mg/L')) {
                    unitSelect.value = 'mg/L';
                } else if (unit.includes('%')) {
                    unitSelect.value = '%';
                }
            } else if (type === 'å«æ°¯æ¶ˆæ¯’å‰‚' || type === 'å­£é“µç›ç±»') {
                unitSelect.value = 'mg/L';
            } else {
                unitSelect.value = '%';
            }
            
            // åˆ‡æ¢åˆ°è®¡ç®—æ ‡ç­¾
            document.querySelectorAll('.tab')[0].click();
            alert('æ¨èé…ç½®å·²åº”ç”¨ï¼Œè¯·é€‰æ‹©å…·ä½“æ¶ˆæ¯’å‰‚åç‚¹å‡»è®¡ç®—');
        }

        // è®°å½•ç®¡ç†
        let records = [];

        function loadRecords() {
            const saved = localStorage.getItem('disinfectantRecords');
            if (saved) {
                records = JSON.parse(saved);
                displayRecords();
            }
        }

        function addRecord(disinfectant, sourceConc, targetConc, dilution, volume) {
            records.unshift({
                time: new Date().toLocaleString('zh-CN'),
                disinfectant,
                sourceConc,
                targetConc,
                dilution,
                volume
            });
            localStorage.setItem('disinfectantRecords', JSON.stringify(records));
            displayRecords();
        }

        function displayRecords() {
            const container = document.getElementById('recordsList');
            if (records.length === 0) {
                container.innerHTML = '<div class="empty-state">æš‚æ— é…æ¯”è®°å½•</div>';
                return;
            }

            container.innerHTML = records.map(r => `
                <div class="record-card">
                    <div class="record-header">
                        <strong>${r.disinfectant}</strong>
                        <span class="record-time">${r.time}</span>
                    </div>
                    <div>åŸæ¶²: ${r.sourceConc}% â†’ ç›®æ ‡: ${r.targetConc} | ç¨€é‡Š: ${r.dilution}${r.volume ? ' | é…åˆ¶é‡: ' + r.volume + 'mL' : ''}</div>
                </div>
            `).join('');
        }

        function clearRecords() {
            if (confirm('ç¡®å®šæ¸…ç©ºæ‰€æœ‰è®°å½•å—ï¼Ÿ')) {
                records = [];
                localStorage.removeItem('disinfectantRecords');
                displayRecords();
            }
        }

        function exportCSV() {
            if (records.length === 0) {
                alert('æ²¡æœ‰è®°å½•å¯å¯¼å‡º');
                return;
            }

            let csv = 'æ—¶é—´,æ¶ˆæ¯’å‰‚,åŸæ¶²æµ“åº¦,ç›®æ ‡æµ“åº¦,ç¨€é‡Šå€æ•°,é…åˆ¶é‡\n';
            records.forEach(r => {
                csv += `${r.time},${r.disinfectant},${r.sourceConc},${r.targetConc},${r.dilution},${r.volume}\n`;
            });

            const blob = new Blob(['\ufeff' + csv], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = `æ¶ˆæ¯’å‰‚é…æ¯”è®°å½•_${new Date().toISOString().slice(0,10)}.csv`;
            link.click();
        }

        // æ–¹æ¡ˆç®¡ç†
        let presets = [];

        function loadPresets() {
            const saved = localStorage.getItem('disinfectantPresets');
            if (saved) {
                presets = JSON.parse(saved);
                displayPresets();
            }
        }

        function savePreset() {
            const disinfectant = document.getElementById('disinfectant').value;
            if (!disinfectant) {
                alert('è¯·å…ˆé€‰æ‹©æ¶ˆæ¯’å‰‚');
                return;
            }

            const name = prompt('è¯·è¾“å…¥æ–¹æ¡ˆåç§°:', `${disinfectant}é…æ¯”æ–¹æ¡ˆ`);
            if (!name) return;

            presets.unshift({
                name,
                disinfectant,
                category: document.getElementById('category').value,
                sourceConc: document.getElementById('sourceConc').value,
                targetConc: document.getElementById('targetConc').value,
                targetUnit: document.getElementById('targetUnit').value,
                targetVol: document.getElementById('targetVol').value,
                created: new Date().toLocaleString('zh-CN')
            });

            localStorage.setItem('disinfectantPresets', JSON.stringify(presets));
            displayPresets();
            alert('æ–¹æ¡ˆå·²ä¿å­˜');
        }

        function displayPresets() {
            const container = document.getElementById('presetsList');
            if (presets.length === 0) {
                container.innerHTML = '<div class="empty-state">æš‚æ— ä¿å­˜çš„æ–¹æ¡ˆ</div>';
                return;
            }

            container.innerHTML = presets.map((p, i) => `
                <div class="preset-card">
                    <div class="preset-info">
                        <h4>${p.name}</h4>
                        <p>${p.disinfectant} | ${p.sourceConc}% â†’ ${p.targetConc} ${p.targetUnit} | åˆ›å»º: ${p.created}</p>
                    </div>
                    <div class="preset-actions">
                        <button class="btn btn-small btn-primary" onclick="applyPreset(${i})">åº”ç”¨</button>
                        <button class="btn btn-small btn-secondary" onclick="deletePreset(${i})">åˆ é™¤</button>
                    </div>
                </div>
            `).join('');
        }

        function applyPreset(index) {
            const p = presets[index];
            document.getElementById('category').value = p.category;
            updateDisinfectants();
            document.getElementById('disinfectant').value = p.disinfectant;
            document.getElementById('sourceConc').value = p.sourceConc;
            document.getElementById('targetConc').value = p.targetConc;
            document.getElementById('targetUnit').value = p.targetUnit;
            document.getElementById('targetVol').value = p.targetVol;

            document.querySelectorAll('.tab')[0].click();
            alert('æ–¹æ¡ˆå·²åº”ç”¨ï¼Œè¯·æ£€æŸ¥å‚æ•°åç‚¹å‡»è®¡ç®—');
        }

        function deletePreset(index) {
            if (confirm('ç¡®å®šåˆ é™¤æ­¤æ–¹æ¡ˆå—ï¼Ÿ')) {
                presets.splice(index, 1);
                localStorage.setItem('disinfectantPresets', JSON.stringify(presets));
                displayPresets();
            }
        }

        // æ³¨å†ŒService Worker (PWAæ”¯æŒ)
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('sw.js')
                .then(registration => {
                    console.log('Service Worker æ³¨å†ŒæˆåŠŸ:', registration);
                })
                .catch(error => {
                    console.log('Service Worker æ³¨å†Œå¤±è´¥:', error);
                });
        }

        // ========== æ–‡ä»¶å¤„ç†åŠŸèƒ½ï¼ˆV1.3.6 æ–¹æ¡ˆä¸€å®ç°ï¼‰==========
// æ–‡ä»¶å¤„ç†åŠŸèƒ½ - V1.3.5 æ–¹æ¡ˆä¸€å®ç°

// æ£€æµ‹æ˜¯å¦åœ¨ Capacitor ç¯å¢ƒä¸­
function isCapacitor() {
    return typeof Capacitor !== 'undefined' && Capacitor.isNativePlatform && Capacitor.isNativePlatform();
}

// è·å– MIME ç±»å‹
function getMimeType(filename) {
    const ext = filename.split('.').pop().toLowerCase();
    const mimeTypes = {
        'pdf': 'application/pdf',
        'doc': 'application/msword',
        'docx': 'application/vnd.openxmlformats-officedocument.wordprocessingml.document',
        'xls': 'application/vnd.ms-excel',
        'xlsx': 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',
        'ppt': 'application/vnd.ms-powerpoint',
        'pptx': 'application/vnd.openxmlformats-officedocument.presentationml.presentation',
        'txt': 'text/plain'
    };
    return mimeTypes[ext] || 'application/octet-stream';
}

// æ˜¾ç¤ºåŸç”Ÿé£æ ¼æç¤º
function showNativeToast(message) {
    if (isCapacitor() && Capacitor.Plugins && Capacitor.Plugins.Toast) {
        Capacitor.Plugins.Toast.show({ text: message });
    } else {
        // ä½¿ç”¨æ›´å‹å¥½çš„æç¤ºè€Œä¸æ˜¯alert
        showToast(message);
    }
}

// æ˜¾ç¤ºè½»é‡çº§æç¤º
function showToast(message) {
    const toast = document.createElement('div');
    toast.style.cssText = `
        position: fixed;
        bottom: 100px;
        left: 50%;
        transform: translateX(-50%);
        background: rgba(0,0,0,0.8);
        color: white;
        padding: 12px 24px;
        border-radius: 25px;
        font-size: 14px;
        z-index: 10002;
        animation: fadeInOut 2s ease;
    `;
    toast.textContent = message;
    document.body.appendChild(toast);
    setTimeout(() => toast.remove(), 2000);
}

// æ·»åŠ åŠ¨ç”»æ ·å¼
const style = document.createElement('style');
style.textContent = `
    @keyframes fadeInOut {
        0% { opacity: 0; transform: translateX(-50%) translateY(20px); }
        20% { opacity: 1; transform: translateX(-50%) translateY(0); }
        80% { opacity: 1; transform: translateX(-50%) translateY(0); }
        100% { opacity: 0; transform: translateX(-50%) translateY(-20px); }
    }
`;
document.head.appendChild(style);

// æ‰“å¼€æ–‡ä»¶ - æ–¹æ¡ˆä¸€å®ç°
function openDocument(id) {
    const doc = documents.find(d => d.id === id);
    if (!doc) return;

    const ext = doc.name.split('.').pop().toLowerCase();
    
    // æ ¹æ®æ–‡ä»¶ç±»å‹é€‰æ‹©ä¸åŒçš„æ‰“å¼€æ–¹å¼
    if (ext === 'txt') {
        // æ–‡æœ¬æ–‡ä»¶ï¼šåº”ç”¨å†…ç›´æ¥æ˜¾ç¤º
        showTextContent(doc);
    } else if (ext === 'pdf') {
        // PDFæ–‡ä»¶ï¼šåº”ç”¨å†…é¢„è§ˆ
        showPdfPreview(doc);
    } else {
        // Officeæ–‡ä»¶ï¼šä¿å­˜åˆ°Downloadç›®å½•å†æ‰“å¼€
        saveAndOpenOfficeFile(doc);
    }
}

// æ˜¾ç¤ºæ–‡æœ¬æ–‡ä»¶å†…å®¹
function showTextContent(doc) {
    try {
        const textContent = atob(doc.data.split(',')[1]);
        
        const modal = document.createElement('div');
        modal.style.cssText = `
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.9);
            z-index: 10000;
            display: flex;
            flex-direction: column;
        `;
        
        modal.innerHTML = `
            <div style="background: #333; color: white; padding: 15px; display: flex; justify-content: space-between; align-items: center;">
                <span style="font-size: 16px; font-weight: bold;">ğŸ“ƒ ${doc.name}</span>
                <div>
                    <button onclick="copyTextContent(this)" 
                            style="background: #667eea; color: white; border: none; padding: 8px 15px; border-radius: 5px; margin-right: 10px; cursor: pointer;"
                            data-text="${encodeURIComponent(textContent)}">
                        ğŸ“‹ å¤åˆ¶
                    </button>
                    <button onclick="this.closest('.modal-overlay').remove()" 
                            style="background: #e74c3c; color: white; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer;">
                        âœ• å…³é—­
                    </button>
                </div>
            </div>
            <pre id="text-content-display" style="flex: 1; background: #1e1e1e; color: #d4d4d4; padding: 20px; margin: 0; overflow: auto; font-size: 14px; line-height: 1.6; white-space: pre-wrap; word-wrap: break-word;">${textContent.replace(/</g, '&lt;').replace(/>/g, '&gt;')}</pre>
        `;
        
        modal.className = 'modal-overlay';
        document.body.appendChild(modal);
    } catch (e) {
        showToast('æ— æ³•æ˜¾ç¤ºæ–‡æœ¬å†…å®¹');
    }
}

// å¤åˆ¶æ–‡æœ¬å†…å®¹
function copyTextContent(btn) {
    const text = decodeURIComponent(btn.getAttribute('data-text'));
    if (navigator.clipboard) {
        navigator.clipboard.writeText(text).then(() => {
            showToast('å·²å¤åˆ¶åˆ°å‰ªè´´æ¿');
        });
    } else {
        // é™çº§æ–¹æ¡ˆ
        const textarea = document.createElement('textarea');
        textarea.value = text;
        document.body.appendChild(textarea);
        textarea.select();
        document.execCommand('copy');
        document.body.removeChild(textarea);
        showToast('å·²å¤åˆ¶åˆ°å‰ªè´´æ¿');
    }
}

// æ˜¾ç¤ºPDFé¢„è§ˆ
function showPdfPreview(doc) {
    const modal = document.createElement('div');
    modal.style.cssText = `
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0,0,0,0.9);
        z-index: 10000;
        display: flex;
        flex-direction: column;
    `;
    
    modal.innerHTML = `
        <div style="background: #333; color: white; padding: 15px; display: flex; justify-content: space-between; align-items: center;">
            <span style="font-size: 16px; font-weight: bold;">ğŸ“„ ${doc.name}</span>
            <div>
                <button onclick="downloadDocument(${doc.id})" 
                        style="background: #28a745; color: white; border: none; padding: 8px 15px; border-radius: 5px; margin-right: 10px; cursor: pointer;">
                    â¬‡ï¸ ä¿å­˜
                </button>
                <button onclick="this.closest('.modal-overlay').remove()" 
                        style="background: #e74c3c; color: white; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer;">
                    âœ• å…³é—­
                </button>
            </div>
        </div>
        <iframe src="${doc.data}" style="flex: 1; width: 100%; border: none;" type="application/pdf"></iframe>
    `;
    
    modal.className = 'modal-overlay';
    document.body.appendChild(modal);
}

// ä¿å­˜Officeæ–‡ä»¶åˆ°Downloadç›®å½•å¹¶æ‰“å¼€
async function saveAndOpenOfficeFile(doc) {
    if (!isCapacitor()) {
        // Webç¯å¢ƒï¼šç›´æ¥ä¸‹è½½
        fallbackDownload(doc);
        showFileLocationGuide(doc.name);
        return;
    }

    // æ˜¾ç¤ºåŠ è½½æç¤º
    const loadingModal = document.createElement('div');
    loadingModal.style.cssText = `
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0,0,0,0.7);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 10000;
    `;
    loadingModal.innerHTML = `
        <div style="background: white; padding: 30px; border-radius: 12px; text-align: center;">
            <div style="font-size: 48px; margin-bottom: 15px;">ğŸ“‚</div>
            <div style="font-size: 16px; color: #333;">æ­£åœ¨ä¿å­˜æ–‡ä»¶...</div>
            <div style="font-size: 14px; color: #999; margin-top: 10px;">${doc.name}</div>
        </div>
    `;
    document.body.appendChild(loadingModal);

    try {
        const { Filesystem, Directory, Encoding } = Capacitor.Plugins;
        
        // ä¿å­˜åˆ° Downloads ç›®å½•
        await Filesystem.writeFile({
            path: doc.name,
            data: doc.data.split(',')[1],
            directory: Directory.Downloads,
            encoding: Encoding.Base64
        });

        // è·å–æ–‡ä»¶URI
        const fileUri = await Filesystem.getUri({
            path: doc.name,
            directory: Directory.Downloads
        });

        loadingModal.remove();
        showNativeToast('æ–‡ä»¶å·²ä¿å­˜åˆ°ä¸‹è½½ç›®å½•');

        // å°è¯•ç”¨ FileOpener æ‰“å¼€
        try {
            const { FileOpener } = Capacitor.Plugins;
            await FileOpener.open({
                filePath: fileUri.uri,
                contentType: getMimeType(doc.name)
            });
        } catch (openError) {
            console.log('FileOpener failed:', openError);
            // å¦‚æœæ‰“å¼€å¤±è´¥ï¼Œæ˜¾ç¤ºæ‰‹åŠ¨æ‰“å¼€æŒ‡å¼•
            showManualOpenGuide(doc.name);
        }

    } catch (error) {
        console.error('ä¿å­˜æ–‡ä»¶å¤±è´¥:', error);
        loadingModal.remove();
        
        // å¦‚æœ Downloads ç›®å½•å¤±è´¥ï¼Œå°è¯• ExternalStorage
        try {
            const { Filesystem, Directory, Encoding } = Capacitor.Plugins;
            await Filesystem.writeFile({
                path: doc.name,
                data: doc.data.split(',')[1],
                directory: Directory.ExternalStorage,
                encoding: Encoding.Base64
            });
            
            showNativeToast('æ–‡ä»¶å·²ä¿å­˜');
            showFileLocationGuide(doc.name);
        } catch (e) {
            showToast('ä¿å­˜æ–‡ä»¶å¤±è´¥ï¼Œè¯·é‡è¯•');
        }
    }
}

// æ˜¾ç¤ºæ‰‹åŠ¨æ‰“å¼€æŒ‡å¼•
function showManualOpenGuide(filename) {
    const modal = document.createElement('div');
    modal.style.cssText = `
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0,0,0,0.85);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 10001;
        padding: 20px;
    `;
    
    modal.innerHTML = `
        <div style="background: white; padding: 25px; border-radius: 15px; max-width: 340px; width: 100%;">
            <div style="text-align: center; margin-bottom: 20px;">
                <div style="font-size: 48px; margin-bottom: 10px;">âœ…</div>
                <div style="font-size: 18px; font-weight: bold; color: #28a745;">æ–‡ä»¶å·²ä¿å­˜</div>
                <div style="color: #666; font-size: 14px; margin-top: 5px; word-break: break-all;">${filename}</div>
            </div>
            
            <div style="background: #fff3cd; border-left: 4px solid #ffc107; padding: 15px; margin-bottom: 20px;">
                <div style="font-weight: bold; color: #856404; margin-bottom: 10px;">ğŸ“‚ å¦‚ä½•æ‰“å¼€æ–‡ä»¶ï¼š</div>
                <ol style="color: #856404; font-size: 14px; line-height: 1.8; margin: 0; padding-left: 20px;">
                    <li>æ‰“å¼€æ‰‹æœºçš„<strong>"æ–‡ä»¶ç®¡ç†"</strong>åº”ç”¨</li>
                    <li>è¿›å…¥<strong>"ä¸‹è½½"</strong>æˆ–<strong>"Download"</strong>æ–‡ä»¶å¤¹</li>
                    <li>æ‰¾åˆ°æ–‡ä»¶å¹¶ç‚¹å‡»æ‰“å¼€</li>
                </ol>
            </div>
            
            <button onclick="this.closest('.modal-overlay').remove();" 
                    style="width: 100%; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; padding: 14px; border-radius: 10px; cursor: pointer; font-size: 16px; font-weight: bold;">
                çŸ¥é“äº†
            </button>
        </div>
    `;
    
    modal.className = 'modal-overlay';
    document.body.appendChild(modal);
}

// Webç¯å¢ƒå›é€€æ–¹æ¡ˆ - ä¸‹è½½
function fallbackDownload(doc) {
    const link = document.createElement('a');
    link.href = doc.data;
    link.download = doc.name;
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
}

// æ˜¾ç¤ºæ–‡ä»¶ä½ç½®æŒ‡å¼•
function showFileLocationGuide(filename) {
    const isNative = isCapacitor();
    
    setTimeout(() => {
        const modal = document.createElement('div');
        modal.style.cssText = `
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.85);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10001;
            padding: 20px;
        `;
        
        const nativeInstructions = isNative 
            ? `
                <div style="background: #fff3cd; border-left: 4px solid #ffc107; padding: 15px; margin-bottom: 20px;">
                    <div style="font-weight: bold; color: #856404; margin-bottom: 10px;">ğŸ“‚ åœ¨æ‰‹æœºä¸ŠæŸ¥æ‰¾æ–‡ä»¶ï¼š</div>
                    <ol style="color: #856404; font-size: 14px; line-height: 1.8; margin: 0; padding-left: 20px;">
                        <li>æ‰“å¼€æ‰‹æœºçš„<strong>"æ–‡ä»¶ç®¡ç†"</strong>æˆ–<strong>"æˆ‘çš„æ–‡ä»¶"</strong>åº”ç”¨</li>
                        <li>æŸ¥æ‰¾<strong>"ä¸‹è½½"</strong>æˆ–<strong>"Download"</strong>æ–‡ä»¶å¤¹</li>
                        <li>å¦‚æœæ‰¾ä¸åˆ°ï¼Œå°è¯•æŸ¥çœ‹<strong>"æœ€è¿‘æ–‡ä»¶"</strong></li>
                        <li>æ‰¾åˆ°æ–‡ä»¶ <strong>${filename}</strong> åç‚¹å‡»æ‰“å¼€</li>
                    </ol>
                </div>
                <div style="background: #e7f3ff; padding: 12px; border-radius: 8px; margin-bottom: 20px; font-size: 13px; color: #0066cc;">
                    <strong>ğŸ’¡ æç¤ºï¼š</strong>ä¹Ÿå¯ä»¥ä¸‹æ‹‰æ‰‹æœºæ¡Œé¢ï¼Œåœ¨æœç´¢æ ä¸­è¾“å…¥æ–‡ä»¶åå¿«é€ŸæŸ¥æ‰¾ã€‚
                </div>
            `
            : `
                <div style="background: #fff3cd; border-left: 4px solid #ffc107; padding: 15px; margin-bottom: 20px;">
                    <div style="font-weight: bold; color: #856404; margin-bottom: 10px;">ğŸ“‚ æ–‡ä»¶å·²ä¸‹è½½ï¼š</div>
                    <p style="color: #856404; font-size: 14px; margin: 0;">
                        æ–‡ä»¶å·²ä¿å­˜åˆ°æµè§ˆå™¨çš„é»˜è®¤ä¸‹è½½ä½ç½®ã€‚<br>
                        åœ¨ç”µè„‘ä¸Šï¼Œé€šå¸¸ä½äº<strong>"ä¸‹è½½"</strong>æ–‡ä»¶å¤¹ã€‚
                    </p>
                </div>
            `;
        
        modal.innerHTML = `
            <div style="background: white; padding: 25px; border-radius: 15px; max-width: 340px; width: 100%;">
                <div style="text-align: center; margin-bottom: 20px;">
                    <div style="font-size: 48px; margin-bottom: 10px;">âœ…</div>
                    <div style="font-size: 18px; font-weight: bold; color: #28a745;">æ–‡ä»¶å·²ä¿å­˜</div>
                    <div style="color: #666; font-size: 14px; margin-top: 5px; word-break: break-all;">${filename}</div>
                </div>
                
                ${nativeInstructions}
                
                <button onclick="this.closest('.modal-overlay').remove();" 
                        style="width: 100%; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; padding: 14px; border-radius: 10px; cursor: pointer; font-size: 16px; font-weight: bold;">
                    çŸ¥é“äº†
                </button>
            </div>
        `;
        
        modal.className = 'modal-overlay';
        document.body.appendChild(modal);
    }, 500);
}

// ==================== ç—…åŸå¾®ç”Ÿç‰©æ•°æ®åº“ ====================
const pathogenDB = {
    // ç¬¬ä¸€ç±»ç—…æ¯’ï¼ˆé«˜è‡´ç—…æ€§ï¼‰
    "å¤©èŠ±ç—…æ¯’": { type: "ç—…æ¯’", category: "ç¬¬ä¸€ç±»", bsl: "BSL-4", family: "ç—˜ç—…æ¯’ç§‘", disease: "å¤©èŠ±", transmission: "å‘¼å¸é“/æ¥è§¦", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "2000", unit: "mg/L", time: "60åˆ†é’Ÿ", note: "é«˜è‡´ç—…æ€§ç—…æ¯’ï¼Œéœ€æœ€é«˜çº§åˆ«é˜²æŠ¤" } },
    "çŒ´ç—˜ç—…æ¯’": { type: "ç—…æ¯’", category: "ç¬¬ä¸€ç±»", bsl: "BSL-3", family: "ç—˜ç—…æ¯’ç§‘", disease: "çŒ´ç—˜", transmission: "æ¥è§¦/é£æ²«", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "1000", unit: "mg/L", time: "30åˆ†é’Ÿ", note: "ç—…æ¯’åŸ¹å…»ç‰©æŒ‰Aç±»è¿è¾“" } },
    "åŸƒåšæ‹‰ç—…æ¯’": { type: "ç—…æ¯’", category: "ç¬¬ä¸€ç±»", bsl: "BSL-4", family: "ä¸çŠ¶ç—…æ¯’ç§‘", disease: "åŸƒåšæ‹‰å‡ºè¡€çƒ­", transmission: "æ¥è§¦/ä½“æ¶²", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "5000", unit: "mg/L", time: "60åˆ†é’Ÿ", note: "è‡´æ­»ç‡é«˜ï¼Œä¸¥æ ¼é˜²æŠ¤" } },
    "é©¬å°”å ¡ç—…æ¯’": { type: "ç—…æ¯’", category: "ç¬¬ä¸€ç±»", bsl: "BSL-4", family: "ä¸çŠ¶ç—…æ¯’ç§‘", disease: "é©¬å°”å ¡å‡ºè¡€çƒ­", transmission: "æ¥è§¦/ä½“æ¶²", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "5000", unit: "mg/L", time: "60åˆ†é’Ÿ", note: "é«˜è‡´æ­»æ€§å‡ºè¡€çƒ­" } },
    "æ‹‰æ²™çƒ­ç—…æ¯’": { type: "ç—…æ¯’", category: "ç¬¬ä¸€ç±»", bsl: "BSL-4", family: "æ²™ç²’ç—…æ¯’ç§‘", disease: "æ‹‰æ²™çƒ­", transmission: "æ¥è§¦/å‘¼å¸é“", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "2000", unit: "mg/L", time: "60åˆ†é’Ÿ", note: "è¥¿éå‡ºè¡€çƒ­" } },
    "å°¼å¸•ç—…æ¯’": { type: "ç—…æ¯’", category: "ç¬¬ä¸€ç±»", bsl: "BSL-4", family: "å‰¯é»ç—…æ¯’ç§‘", disease: "å°¼å¸•ç—…æ¯’æ€§è„‘ç‚", transmission: "æ¥è§¦/é£æ²«", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "2000", unit: "mg/L", time: "60åˆ†é’Ÿ", note: "äººç•œå…±æ‚£ç—…æ¯’" } },
    "äº¨å¾·æ‹‰ç—…æ¯’": { type: "ç—…æ¯’", category: "ç¬¬ä¸€ç±»", bsl: "BSL-4", family: "å‰¯é»ç—…æ¯’ç§‘", disease: "äº¨å¾·æ‹‰ç—…æ¯’ç—…", transmission: "æ¥è§¦", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "2000", unit: "mg/L", time: "60åˆ†é’Ÿ", note: "æºè‡ªè™è " } },
    "é»„çƒ­ç—…æ¯’": { type: "ç—…æ¯’", category: "ç¬¬ä¸€ç±»", bsl: "BSL-3", family: "é»„ç—…æ¯’ç§‘", disease: "é»„çƒ­ç—…", transmission: "èšŠåª’", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "1000", unit: "mg/L", time: "30åˆ†é’Ÿ", note: "æœ‰ç–«è‹—ï¼ŒèšŠåª’ä¼ æ’­" } },
    "å…‹é‡Œç±³äºš-åˆšæœå‡ºè¡€çƒ­ç—…æ¯’": { type: "ç—…æ¯’", category: "ç¬¬ä¸€ç±»", bsl: "BSL-3", family: "å†…ç½—ç—…æ¯’ç§‘", disease: "å…‹é‡Œç±³äºš-åˆšæœå‡ºè¡€çƒ­", transmission: "èœ±åª’/æ¥è§¦", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "2000", unit: "mg/L", time: "60åˆ†é’Ÿ", note: "æ–°ç–†å‡ºè¡€çƒ­ç—…æ¯’" } },
    "ä¸œæ–¹é©¬è„‘ç‚ç—…æ¯’": { type: "ç—…æ¯’", category: "ç¬¬ä¸€ç±»", bsl: "BSL-3", family: "æŠ«è†œç—…æ¯’ç§‘", disease: "ä¸œæ–¹é©¬è„‘ç‚", transmission: "èšŠåª’", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "1000", unit: "mg/L", time: "30åˆ†é’Ÿ", note: "èšŠåª’ç—…æ¯’" } },
    
    // ç¬¬äºŒç±»ç—…æ¯’
    "æ–°å‹å† çŠ¶ç—…æ¯’": { type: "ç—…æ¯’", category: "ç¬¬äºŒç±»", bsl: "BSL-3", family: "å† çŠ¶ç—…æ¯’ç§‘", disease: "COVID-19", transmission: "å‘¼å¸é“/æ¥è§¦", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "500-1000", unit: "mg/L", time: "30åˆ†é’Ÿ", note: "ä¸€èˆ¬ç‰©ä½“è¡¨é¢500mg/Lï¼Œæ±¡æŸ“ä¸¥é‡1000mg/L" } },
    "SARSå† çŠ¶ç—…æ¯’": { type: "ç—…æ¯’", category: "ç¬¬äºŒç±»", bsl: "BSL-3", family: "å† çŠ¶ç—…æ¯’ç§‘", disease: "SARS", transmission: "å‘¼å¸é“/æ¥è§¦", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "1000", unit: "mg/L", time: "30åˆ†é’Ÿ", note: "ä¸¥é‡æ€¥æ€§å‘¼å¸ç»¼åˆå¾" } },
    "MERSå† çŠ¶ç—…æ¯’": { type: "ç—…æ¯’", category: "ç¬¬äºŒç±»", bsl: "BSL-3", family: "å† çŠ¶ç—…æ¯’ç§‘", disease: "ä¸­ä¸œå‘¼å¸ç»¼åˆå¾", transmission: "å‘¼å¸é“/æ¥è§¦", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "1000", unit: "mg/L", time: "30åˆ†é’Ÿ", note: "ä¸­ä¸œå‘¼å¸ç»¼åˆå¾" } },
    "ç‹‚çŠ¬ç—…æ¯’": { type: "ç—…æ¯’", category: "ç¬¬äºŒç±»", bsl: "BSL-3", family: "å¼¹çŠ¶ç—…æ¯’ç§‘", disease: "ç‹‚çŠ¬ç—…", transmission: "å’¬ä¼¤/æŠ“ä¼¤", disinfection: { type: "å­£é“µç›ç±»", conc: "1000", unit: "mg/L", time: "30åˆ†é’Ÿ", note: "ä¼¤å£å¤„ç†ç”¨è‚¥çš‚æ°´æˆ–å­£é“µç›" } },
    "HIV": { type: "ç—…æ¯’", category: "ç¬¬äºŒç±»", bsl: "BSL-3", family: "é€†è½¬å½•ç—…æ¯’ç§‘", disease: "è‰¾æ»‹ç—…", transmission: "è¡€æ¶²/ä½“æ¶²", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "500", unit: "mg/L", time: "30åˆ†é’Ÿ", note: "75%ä¹™é†‡ã€å«æ°¯æ¶ˆæ¯’å‰‚å‡æœ‰æ•ˆ" } },
    "ä¹™å‹è„‘ç‚ç—…æ¯’": { type: "ç—…æ¯’", category: "ç¬¬äºŒç±»", bsl: "BSL-2", family: "é»„ç—…æ¯’ç§‘", disease: "æµè¡Œæ€§ä¹™å‹è„‘ç‚", transmission: "èšŠåª’", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "500", unit: "mg/L", time: "30åˆ†é’Ÿ", note: "æœ‰ç–«è‹—ï¼ŒèšŠåª’ä¼ æ’­" } },
    "å¤§åˆ«ç­è¾¾ç—…æ¯’": { type: "ç—…æ¯’", category: "ç¬¬äºŒç±»", bsl: "BSL-2", family: "ç™½è›‰çº¤ç»†ç—…æ¯’ç§‘", disease: "å‘çƒ­ä¼´è¡€å°æ¿å‡å°‘ç»¼åˆå¾", transmission: "èœ±åª’", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "1000", unit: "mg/L", time: "30åˆ†é’Ÿ", note: "å‘çƒ­ä¼´è¡€å°æ¿å‡å°‘ç»¼åˆå¾ç—…æ¯’" } },
    "æ±‰å¦ç—…æ¯’": { type: "ç—…æ¯’", category: "ç¬¬äºŒç±»", bsl: "BSL-3", family: "æ±‰å¦ç—…æ¯’ç§‘", disease: "è‚¾ç»¼åˆå¾å‡ºè¡€çƒ­", transmission: "é¼ ç±»æ’æ³„ç‰©", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "1000", unit: "mg/L", time: "60åˆ†é’Ÿ", note: "æµè¡Œæ€§å‡ºè¡€çƒ­" } },
    "è„Šé«“ç°è´¨ç‚ç—…æ¯’": { type: "ç—…æ¯’", category: "ç¬¬äºŒç±»", bsl: "BSL-3", family: "å°RNAç—…æ¯’ç§‘", disease: "è„Šé«“ç°è´¨ç‚", transmission: "ç²ª-å£", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "1000", unit: "mg/L", time: "30åˆ†é’Ÿ", note: "è‚ é“ç—…æ¯’ï¼Œæ³¨æ„ç²ª-å£ä¼ æ’­" } },
    "é«˜è‡´ç—…æ€§ç¦½æµæ„Ÿç—…æ¯’": { type: "ç—…æ¯’", category: "ç¬¬äºŒç±»", bsl: "BSL-3", family: "æ­£é»ç—…æ¯’ç§‘", disease: "ç¦½æµæ„Ÿ", transmission: "å‘¼å¸é“/æ¥è§¦", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "1000", unit: "mg/L", time: "30åˆ†é’Ÿ", note: "H5N1ã€H7N9ç­‰é«˜è‡´ç—…æ€§æ¯’æ ª" } },
    
    // ç¬¬ä¸‰ç±»ç—…æ¯’
    "æµæ„Ÿç—…æ¯’": { type: "ç—…æ¯’", category: "ç¬¬ä¸‰ç±»", bsl: "BSL-2", family: "æ­£é»ç—…æ¯’ç§‘", disease: "æµè¡Œæ€§æ„Ÿå†’", transmission: "å‘¼å¸é“", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "500", unit: "mg/L", time: "30åˆ†é’Ÿ", note: "ç©ºæ°”æ¶ˆæ¯’å¯ç”¨è¿‡æ°§ä¹™é…¸" } },
    "è¯ºå¦‚ç—…æ¯’": { type: "ç—…æ¯’", category: "ç¬¬ä¸‰ç±»", bsl: "BSL-2", family: "æ¯çŠ¶ç—…æ¯’ç§‘", disease: "æ€¥æ€§èƒƒè‚ ç‚", transmission: "ç²ª-å£", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "1000", unit: "mg/L", time: "30åˆ†é’Ÿ", note: "å¯¹é…’ç²¾ä¸æ•æ„Ÿï¼Œéœ€ç”¨å«æ°¯æ¶ˆæ¯’å‰‚" } },
    "ç™»é©ç—…æ¯’": { type: "ç—…æ¯’", category: "ç¬¬ä¸‰ç±»", bsl: "BSL-2", family: "é»„ç—…æ¯’ç§‘", disease: "ç™»é©çƒ­", transmission: "èšŠåª’", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "500", unit: "mg/L", time: "30åˆ†é’Ÿ", note: "ä¼ŠèšŠä¼ æ’­" } },
    "å¯¨å¡ç—…æ¯’": { type: "ç—…æ¯’", category: "ç¬¬ä¸‰ç±»", bsl: "BSL-2", family: "é»„ç—…æ¯’ç§‘", disease: "å¯¨å¡ç—…æ¯’ç—…", transmission: "èšŠåª’", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "500", unit: "mg/L", time: "30åˆ†é’Ÿ", note: "èšŠåª’ä¼ æ’­" } },
    "ä¸™å‹è‚ç‚ç—…æ¯’": { type: "ç—…æ¯’", category: "ç¬¬ä¸‰ç±»", bsl: "BSL-2", family: "é»„ç—…æ¯’ç§‘", disease: "ä¸™å‹è‚ç‚", transmission: "è¡€æ¶²/ä½“æ¶²", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "500", unit: "mg/L", time: "30åˆ†é’Ÿ", note: "è¡€æ¶²ä¼ æ’­" } },
    "å•çº¯ç–±ç–¹ç—…æ¯’": { type: "ç—…æ¯’", category: "ç¬¬ä¸‰ç±»", bsl: "BSL-2", family: "ç–±ç–¹ç—…æ¯’ç§‘", disease: "ç–±ç–¹", transmission: "æ¥è§¦", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "500", unit: "mg/L", time: "10åˆ†é’Ÿ", note: "æ¥è§¦ä¼ æ’­" } },
    "æ°´ç—˜-å¸¦çŠ¶ç–±ç–¹ç—…æ¯’": { type: "ç—…æ¯’", category: "ç¬¬ä¸‰ç±»", bsl: "BSL-2", family: "ç–±ç–¹ç—…æ¯’ç§‘", disease: "æ°´ç—˜/å¸¦çŠ¶ç–±ç–¹", transmission: "å‘¼å¸é“/æ¥è§¦", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "500", unit: "mg/L", time: "10åˆ†é’Ÿ", note: "ç©ºæ°”é£æ²«ä¼ æ’­" } },
    "EBç—…æ¯’": { type: "ç—…æ¯’", category: "ç¬¬ä¸‰ç±»", bsl: "BSL-2", family: "ç–±ç–¹ç—…æ¯’ç§‘", disease: "ä¼ æŸ“æ€§å•æ ¸ç»†èƒå¢å¤šç—‡", transmission: "å”¾æ¶²", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "500", unit: "mg/L", time: "10åˆ†é’Ÿ", note: "å”¾æ¶²ä¼ æ’­" } },
    "å·¨ç»†èƒç—…æ¯’": { type: "ç—…æ¯’", category: "ç¬¬ä¸‰ç±»", bsl: "BSL-2", family: "ç–±ç–¹ç—…æ¯’ç§‘", disease: "å·¨ç»†èƒç—…æ¯’æ„ŸæŸ“", transmission: "æ¥è§¦", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "500", unit: "mg/L", time: "10åˆ†é’Ÿ", note: "æ¥è§¦ä¼ æ’­" } },
    "éº»ç–¹ç—…æ¯’": { type: "ç—…æ¯’", category: "ç¬¬ä¸‰ç±»", bsl: "BSL-2", family: "å‰¯é»ç—…æ¯’ç§‘", disease: "éº»ç–¹", transmission: "å‘¼å¸é“", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "500", unit: "mg/L", time: "30åˆ†é’Ÿ", note: "ç©ºæ°”ä¼ æ’­ï¼Œä¼ æŸ“æ€§æå¼º" } },
    "æµè¡Œæ€§è…®è…ºç‚ç—…æ¯’": { type: "ç—…æ¯’", category: "ç¬¬ä¸‰ç±»", bsl: "BSL-2", family: "å‰¯é»ç—…æ¯’ç§‘", disease: "æµè¡Œæ€§è…®è…ºç‚", transmission: "å‘¼å¸é“", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "500", unit: "mg/L", time: "30åˆ†é’Ÿ", note: "é£æ²«ä¼ æ’­" } },
    "é£ç–¹ç—…æ¯’": { type: "ç—…æ¯’", category: "ç¬¬ä¸‰ç±»", bsl: "BSL-2", family: "é©¬æ°ç—…æ¯’ç§‘", disease: "é£ç–¹", transmission: "å‘¼å¸é“", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "500", unit: "mg/L", time: "30åˆ†é’Ÿ", note: "å­•å¦‡æ„ŸæŸ“å¯è‡´ç•¸" } },
    "ç”²å‹è‚ç‚ç—…æ¯’": { type: "ç—…æ¯’", category: "ç¬¬ä¸‰ç±»", bsl: "BSL-2", family: "å°RNAç—…æ¯’ç§‘", disease: "ç”²å‹è‚ç‚", transmission: "ç²ª-å£", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "1000", unit: "mg/L", time: "30åˆ†é’Ÿ", note: "è‚ é“ä¼ æ’­" } },
    "æˆŠå‹è‚ç‚ç—…æ¯’": { type: "ç—…æ¯’", category: "ç¬¬ä¸‰ç±»", bsl: "BSL-2", family: "æˆŠå‹è‚ç‚ç—…æ¯’ç§‘", disease: "æˆŠå‹è‚ç‚", transmission: "ç²ª-å£", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "1000", unit: "mg/L", time: "30åˆ†é’Ÿ", note: "è‚ é“ä¼ æ’­ï¼Œå­•å¦‡æ­»äº¡ç‡é«˜" } },
    "è½®çŠ¶ç—…æ¯’": { type: "ç—…æ¯’", category: "ç¬¬ä¸‰ç±»", bsl: "BSL-2", family: "å‘¼è‚ å­¤ç—…æ¯’ç§‘", disease: "å©´å¹¼å„¿è…¹æ³»", transmission: "ç²ª-å£", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "1000", unit: "mg/L", time: "30åˆ†é’Ÿ", note: "å©´å¹¼å„¿è…¹æ³»ä¸»è¦ç—…åŸ" } },
    "æŸ¯è¨å¥‡ç—…æ¯’": { type: "ç—…æ¯’", category: "ç¬¬ä¸‰ç±»", bsl: "BSL-2", family: "å°RNAç—…æ¯’ç§‘", disease: "æ‰‹è¶³å£ç—…/ç–±ç–¹æ€§å’½å³¡ç‚", transmission: "ç²ª-å£/å‘¼å¸é“", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "500", unit: "mg/L", time: "30åˆ†é’Ÿ", note: "è‚ é“ç—…æ¯’" } },
    "è‚ é“ç—…æ¯’A71å‹": { type: "ç—…æ¯’", category: "ç¬¬ä¸‰ç±»", bsl: "BSL-2", family: "å°RNAç—…æ¯’ç§‘", disease: "æ‰‹è¶³å£ç—…", transmission: "ç²ª-å£/å‘¼å¸é“", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "500", unit: "mg/L", time: "30åˆ†é’Ÿ", note: "å¯å¼•èµ·é‡ç—‡æ‰‹è¶³å£ç—…" } },
    "é¼»ç—…æ¯’": { type: "ç—…æ¯’", category: "ç¬¬ä¸‰ç±»", bsl: "BSL-2", family: "å°RNAç—…æ¯’ç§‘", disease: "æ™®é€šæ„Ÿå†’", transmission: "å‘¼å¸é“", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "500", unit: "mg/L", time: "10åˆ†é’Ÿ", note: "æ™®é€šæ„Ÿå†’ä¸»è¦ç—…åŸ" } },
    "ä¹™å‹è‚ç‚ç—…æ¯’": { type: "ç—…æ¯’", category: "ç¬¬ä¸‰ç±»", bsl: "BSL-2", family: "å—œè‚DNAç—…æ¯’ç§‘", disease: "ä¹™å‹è‚ç‚", transmission: "è¡€æ¶²/ä½“æ¶²", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "500", unit: "mg/L", time: "30åˆ†é’Ÿ", note: "75%ä¹™é†‡æ— æ•ˆï¼Œéœ€ç”¨å«æ°¯æ¶ˆæ¯’å‰‚" } },
    
    // ç¬¬äºŒç±»ç»†èŒ
    "ç»“æ ¸åˆ†ææ†èŒ": { type: "ç»†èŒ", category: "ç¬¬äºŒç±»", bsl: "BSL-3", family: "åˆ†ææ†èŒå±", disease: "ç»“æ ¸ç—…", transmission: "å‘¼å¸é“", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "2000", unit: "mg/L", time: "60åˆ†é’Ÿ", note: "é«˜æŠµæŠ—åŠ›ï¼Œéœ€é«˜æµ“åº¦æ¶ˆæ¯’å‰‚" } },
    "ç‚­ç–½èŠ½å­¢æ†èŒ": { type: "ç»†èŒ", category: "ç¬¬äºŒç±»", bsl: "BSL-3", family: "èŠ½å­¢æ†èŒå±", disease: "ç‚­ç–½", transmission: "æ¥è§¦/å¸å…¥", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "5000", unit: "mg/L", time: "120åˆ†é’Ÿ", note: "èŠ½å­¢æŠµæŠ—åŠ›æå¼º" } },
    "é¼ ç–«è€¶å°”æ£®èŒ": { type: "ç»†èŒ", category: "ç¬¬äºŒç±»", bsl: "BSL-3", family: "è‚ æ†èŒç§‘", disease: "é¼ ç–«", transmission: "é¼ èš¤/å‘¼å¸é“", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "2000", unit: "mg/L", time: "60åˆ†é’Ÿ", note: "ç”²ç±»ä¼ æŸ“ç—…" } },
    "éœä¹±å¼§èŒ": { type: "ç»†èŒ", category: "ç¬¬äºŒç±»", bsl: "BSL-2", family: "å¼§èŒç§‘", disease: "éœä¹±", transmission: "ç²ª-å£", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "1000", unit: "mg/L", time: "30åˆ†é’Ÿ", note: "ç”²ç±»ä¼ æŸ“ç—…ï¼Œæ³¨æ„æ°´æºæ¶ˆæ¯’" } },
    "å¸ƒé²æ°èŒ": { type: "ç»†èŒ", category: "ç¬¬äºŒç±»", bsl: "BSL-3", family: "å¸ƒé²æ°èŒå±", disease: "å¸ƒé²æ°èŒç—…", transmission: "æ¥è§¦/é£Ÿå…¥", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "1000", unit: "mg/L", time: "30åˆ†é’Ÿ", note: "äººç•œå…±æ‚£ç—…" } },
    "åœŸæ‹‰å¼—æœ—è¥¿æ–¯èŒ": { type: "ç»†èŒ", category: "ç¬¬äºŒç±»", bsl: "BSL-3", family: "å¼—æœ—è¥¿æ–¯èŒå±", disease: "åœŸæ‹‰èŒç—…", transmission: "æ¥è§¦/å¸å…¥", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "1000", unit: "mg/L", time: "30åˆ†é’Ÿ", note: "å…”çƒ­ç—…" } },
    "é¼»ç–½ä¼¯å…‹éœå°”å¾·èŒ": { type: "ç»†èŒ", category: "ç¬¬äºŒç±»", bsl: "BSL-3", family: "ä¼¯å…‹éœå°”å¾·èŒå±", disease: "é¼»ç–½", transmission: "æ¥è§¦", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "1000", unit: "mg/L", time: "30åˆ†é’Ÿ", note: "äººç•œå…±æ‚£ç—…" } },
    "ç±»é¼»ç–½ä¼¯å…‹éœå°”å¾·èŒ": { type: "ç»†èŒ", category: "ç¬¬äºŒç±»", bsl: "BSL-3", family: "ä¼¯å…‹éœå°”å¾·èŒå±", disease: "ç±»é¼»ç–½", transmission: "æ¥è§¦", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "1000", unit: "mg/L", time: "30åˆ†é’Ÿ", note: "åœŸå£¤æ¥æº" } },
    "ç‰›åˆ†ææ†èŒ": { type: "ç»†èŒ", category: "ç¬¬äºŒç±»", bsl: "BSL-3", family: "åˆ†ææ†èŒå±", disease: "ç‰›ç»“æ ¸ç—…", transmission: "å‘¼å¸é“", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "2000", unit: "mg/L", time: "60åˆ†é’Ÿ", note: "ç±»ä¼¼ç»“æ ¸åˆ†ææ†èŒ" } },
    "ç«‹å…‹æ¬¡ä½“": { type: "ç»†èŒ", category: "ç¬¬äºŒç±»", bsl: "BSL-3", family: "ç«‹å…‹æ¬¡ä½“å±", disease: "æ–‘ç–¹ä¼¤å¯’/æ–‘ç‚¹çƒ­", transmission: "èœ±åª’/è™±åª’", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "1000", unit: "mg/L", time: "30åˆ†é’Ÿ", note: "ç»†èƒå†…å¯„ç”Ÿ" } },
    "æ™è™«ç—…ä¸œæ–¹ä½“": { type: "ç»†èŒ", category: "ç¬¬äºŒç±»", bsl: "BSL-3", family: "ä¸œæ–¹ä½“å±", disease: "æ™è™«ç—…", transmission: "æ™è¨", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "1000", unit: "mg/L", time: "30åˆ†é’Ÿ", note: "ä¸›æ—æ–‘ç–¹ä¼¤å¯’" } },
    "å—œåå™¬ç»†èƒæ— å½¢ä½“": { type: "ç»†èŒ", category: "ç¬¬äºŒç±»", bsl: "BSL-3", family: "æ— å½¢ä½“å±", disease: "äººç²’ç»†èƒæ— å½¢ä½“ç—…", transmission: "èœ±åª’", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "1000", unit: "mg/L", time: "30åˆ†é’Ÿ", note: "èœ±ä¼ æ’­" } },
    "ä¼¯æ°è€ƒå…‹æ–¯æ°ä½“": { type: "ç»†èŒ", category: "ç¬¬äºŒç±»", bsl: "BSL-3", family: "è€ƒå…‹æ–¯ä½“å±", disease: "Qçƒ­", transmission: "å‘¼å¸é“", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "1000", unit: "mg/L", time: "30åˆ†é’Ÿ", note: "è€çƒ­æŠµæŠ—åŠ›å¼º" } },
    
    // ç¬¬ä¸‰ç±»ç»†èŒ
    "é‡‘é»„è‰²è‘¡è„çƒèŒ": { type: "ç»†èŒ", category: "ç¬¬ä¸‰ç±»", bsl: "BSL-2", family: "è‘¡è„çƒèŒå±", disease: "åŒ–è„“æ€§æ„ŸæŸ“/é£Ÿç‰©ä¸­æ¯’", transmission: "æ¥è§¦/é£Ÿå…¥", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "500", unit: "mg/L", time: "10åˆ†é’Ÿ", note: "å¸¸è§è‡´ç—…èŒ" } },
    "åŒ–è„“é“¾çƒèŒ": { type: "ç»†èŒ", category: "ç¬¬ä¸‰ç±»", bsl: "BSL-2", family: "é“¾çƒèŒå±", disease: "å’½ç‚/çŒ©çº¢çƒ­", transmission: "å‘¼å¸é“", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "500", unit: "mg/L", time: "10åˆ†é’Ÿ", note: "Aç¾¤é“¾çƒèŒ" } },
    "è‚ºç‚é“¾çƒèŒ": { type: "ç»†èŒ", category: "ç¬¬ä¸‰ç±»", bsl: "BSL-2", family: "é“¾çƒèŒå±", disease: "è‚ºç‚/è„‘è†œç‚", transmission: "å‘¼å¸é“", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "500", unit: "mg/L", time: "10åˆ†é’Ÿ", note: "ç¤¾åŒºè·å¾—æ€§è‚ºç‚å¸¸è§" } },
    "è‚ çƒèŒ": { type: "ç»†èŒ", category: "ç¬¬ä¸‰ç±»", bsl: "BSL-2", family: "è‚ çƒèŒå±", disease: "å°¿è·¯æ„ŸæŸ“/å¿ƒå†…è†œç‚", transmission: "æ¥è§¦", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "500", unit: "mg/L", time: "10åˆ†é’Ÿ", note: "åŒ»é™¢æ„ŸæŸ“é‡è¦ç—…åŸ" } },
    "å¤§è‚ åŸƒå¸ŒèŒ": { type: "ç»†èŒ", category: "ç¬¬ä¸‰ç±»", bsl: "BSL-2", family: "è‚ æ†èŒç§‘", disease: "è…¹æ³»/å°¿è·¯æ„ŸæŸ“", transmission: "ç²ª-å£", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "500", unit: "mg/L", time: "10åˆ†é’Ÿ", note: "æ¡ä»¶è‡´ç—…èŒ" } },
    "è‚ºç‚å…‹é›·ä¼¯èŒ": { type: "ç»†èŒ", category: "ç¬¬ä¸‰ç±»", bsl: "BSL-2", family: "è‚ æ†èŒç§‘", disease: "è‚ºç‚/è´¥è¡€ç—‡", transmission: "å‘¼å¸é“/æ¥è§¦", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "500", unit: "mg/L", time: "10åˆ†é’Ÿ", note: "äº§ESBLèŒæ ªè€è¯" } },
    "æ²™é—¨æ°èŒ": { type: "ç»†èŒ", category: "ç¬¬ä¸‰ç±»", bsl: "BSL-2", family: "è‚ æ†èŒç§‘", disease: "ä¼¤å¯’/é£Ÿç‰©ä¸­æ¯’", transmission: "ç²ª-å£", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "1000", unit: "mg/L", time: "30åˆ†é’Ÿ", note: "é£Ÿç‰©ä¸­æ¯’å¸¸è§" } },
    "å¿—è´ºæ°èŒ": { type: "ç»†èŒ", category: "ç¬¬ä¸‰ç±»", bsl: "BSL-2", family: "è‚ æ†èŒç§‘", disease: "ç»†èŒæ€§ç—¢ç–¾", transmission: "ç²ª-å£", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "1000", unit: "mg/L", time: "30åˆ†é’Ÿ", note: "èŒç—¢" } },
    "å‰¯æº¶è¡€å¼§èŒ": { type: "ç»†èŒ", category: "ç¬¬ä¸‰ç±»", bsl: "BSL-2", family: "å¼§èŒç§‘", disease: "é£Ÿç‰©ä¸­æ¯’", transmission: "é£Ÿå…¥", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "500", unit: "mg/L", time: "10åˆ†é’Ÿ", note: "æµ·äº§å“ç›¸å…³" } },
    "åˆ›ä¼¤å¼§èŒ": { type: "ç»†èŒ", category: "ç¬¬ä¸‰ç±»", bsl: "BSL-2", family: "å¼§èŒç§‘", disease: "ä¼¤å£æ„ŸæŸ“/è´¥è¡€ç—‡", transmission: "ä¼¤å£æ¥è§¦", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "500", unit: "mg/L", time: "10åˆ†é’Ÿ", note: "æµ·æ´‹åˆ›ä¼¤å¼§èŒ" } },
    "æµæ„Ÿå—œè¡€æ†èŒ": { type: "ç»†èŒ", category: "ç¬¬ä¸‰ç±»", bsl: "BSL-2", family: "å—œè¡€æ†èŒå±", disease: "è‚ºç‚/è„‘è†œç‚", transmission: "å‘¼å¸é“", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "500", unit: "mg/L", time: "10åˆ†é’Ÿ", note: "å„¿ç«¥æ„ŸæŸ“" } },
    "ç™¾æ—¥å’³é²ç‰¹æ°èŒ": { type: "ç»†èŒ", category: "ç¬¬ä¸‰ç±»", bsl: "BSL-2", family: "é²ç‰¹æ°èŒå±", disease: "ç™¾æ—¥å’³", transmission: "å‘¼å¸é“", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "500", unit: "mg/L", time: "10åˆ†é’Ÿ", note: "å‘¼å¸é“ä¼ æ’­" } },
    "è„‘è†œç‚å¥ˆç‘ŸèŒ": { type: "ç»†èŒ", category: "ç¬¬ä¸‰ç±»", bsl: "BSL-2", family: "å¥ˆç‘ŸèŒå±", disease: "æµè¡Œæ€§è„‘è„Šé«“è†œç‚", transmission: "å‘¼å¸é“", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "1000", unit: "mg/L", time: "30åˆ†é’Ÿ", note: "æµè„‘ï¼Œç©ºæ°”ä¼ æ’­" } },
    "æ·‹ç—…å¥ˆç‘ŸèŒ": { type: "ç»†èŒ", category: "ç¬¬ä¸‰ç±»", bsl: "BSL-2", family: "å¥ˆç‘ŸèŒå±", disease: "æ·‹ç—…", transmission: "æ€§æ¥è§¦", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "500", unit: "mg/L", time: "10åˆ†é’Ÿ", note: "æ€§ä¼ æ’­ç–¾ç—…" } },
    "å¹½é—¨èºæ†èŒ": { type: "ç»†èŒ", category: "ç¬¬ä¸‰ç±»", bsl: "BSL-2", family: "èºæ†èŒå±", disease: "èƒƒç‚/èƒƒæºƒç–¡/èƒƒç™Œ", transmission: "ç²ª-å£", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "500", unit: "mg/L", time: "10åˆ†é’Ÿ", note: "èƒƒéƒ¨å®šæ¤" } },
    "é“œç»¿å‡å•èƒèŒ": { type: "ç»†èŒ", category: "ç¬¬ä¸‰ç±»", bsl: "BSL-2", family: "å‡å•èƒèŒå±", disease: "åŒ»é™¢æ„ŸæŸ“", transmission: "æ¥è§¦", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "1000", unit: "mg/L", time: "30åˆ†é’Ÿ", note: "å¤šé‡è€è¯" } },
    "é²æ›¼ä¸åŠ¨æ†èŒ": { type: "ç»†èŒ", category: "ç¬¬ä¸‰ç±»", bsl: "BSL-2", family: "ä¸åŠ¨æ†èŒå±", disease: "åŒ»é™¢æ„ŸæŸ“", transmission: "æ¥è§¦", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "1000", unit: "mg/L", time: "30åˆ†é’Ÿ", note: "å¤šé‡è€è¯" } },
    "å†›å›¢èŒ": { type: "ç»†èŒ", category: "ç¬¬ä¸‰ç±»", bsl: "BSL-2", family: "å†›å›¢èŒå±", disease: "å†›å›¢èŒç—…", transmission: "å‘¼å¸é“", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "1000", unit: "mg/L", time: "30åˆ†é’Ÿ", note: "ç©ºè°ƒæ°´æºä¼ æ’­" } },
    "ç ´ä¼¤é£æ¢­èŒ": { type: "ç»†èŒ", category: "ç¬¬ä¸‰ç±»", bsl: "BSL-2", family: "æ¢­èŒå±", disease: "ç ´ä¼¤é£", transmission: "ä¼¤å£", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "1000", unit: "mg/L", time: "30åˆ†é’Ÿ", note: "èŠ½å­¢å½¢æˆ" } },
    "è‚‰æ¯’æ¢­èŒ": { type: "ç»†èŒ", category: "ç¬¬ä¸‰ç±»", bsl: "BSL-2", family: "æ¢­èŒå±", disease: "è‚‰æ¯’ä¸­æ¯’", transmission: "é£Ÿå…¥", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "1000", unit: "mg/L", time: "30åˆ†é’Ÿ", note: "æ¯’ç´ æŒ‰ç¬¬äºŒç±»ç®¡ç†" } },
    "äº§æ°”èšè†œæ¢­èŒ": { type: "ç»†èŒ", category: "ç¬¬ä¸‰ç±»", bsl: "BSL-2", family: "æ¢­èŒå±", disease: "æ°”æ€§åç–½/é£Ÿç‰©ä¸­æ¯’", transmission: "ä¼¤å£/é£Ÿå…¥", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "1000", unit: "mg/L", time: "30åˆ†é’Ÿ", note: "åŒæ°§èŒ" } },
    "è‰°éš¾æ¢­èŒ": { type: "ç»†èŒ", category: "ç¬¬ä¸‰ç±»", bsl: "BSL-2", family: "æ¢­èŒå±", disease: "æŠ—ç”Ÿç´ ç›¸å…³è…¹æ³»", transmission: "ç²ª-å£", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "5000", unit: "mg/L", time: "10åˆ†é’Ÿ", note: "èŠ½å­¢æŠµæŠ—åŠ›å¼º" } },
    "æ¢…æ¯’èºæ—‹ä½“": { type: "ç»†èŒ", category: "ç¬¬ä¸‰ç±»", bsl: "BSL-2", family: "å¯†èºæ—‹ä½“å±", disease: "æ¢…æ¯’", transmission: "æ€§æ¥è§¦/æ¯å©´", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "500", unit: "mg/L", time: "10åˆ†é’Ÿ", note: "è‹ç™½å¯†èºæ—‹ä½“" } },
    "é’©ç«¯èºæ—‹ä½“": { type: "ç»†èŒ", category: "ç¬¬ä¸‰ç±»", bsl: "BSL-2", family: "é’©ç«¯èºæ—‹ä½“å±", disease: "é’©ç«¯èºæ—‹ä½“ç—…", transmission: "æ¥è§¦ç–«æ°´", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "500", unit: "mg/L", time: "10åˆ†é’Ÿ", note: "æ°´ä¼ æ’­" } },
    "ä¼¯æ°ç–èºæ—‹ä½“": { type: "ç»†èŒ", category: "ç¬¬ä¸‰ç±»", bsl: "BSL-2", family: "ç–èºæ—‹ä½“å±", disease: "è±å§†ç—…", transmission: "èœ±åª’", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "500", unit: "mg/L", time: "10åˆ†é’Ÿ", note: "èœ±ä¼ æ’­" } },
    "è¡£åŸä½“": { type: "ç»†èŒ", category: "ç¬¬ä¸‰ç±»", bsl: "BSL-2", family: "è¡£åŸä½“å±", disease: "æ²™çœ¼/æ³Œå°¿ç”Ÿæ®–é“æ„ŸæŸ“", transmission: "æ¥è§¦", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "500", unit: "mg/L", time: "10åˆ†é’Ÿ", note: "ç»†èƒå†…å¯„ç”Ÿ" } },
    "æ”¯åŸä½“": { type: "ç»†èŒ", category: "ç¬¬ä¸‰ç±»", bsl: "BSL-2", family: "æ”¯åŸä½“å±", disease: "è‚ºç‚/å°¿é“ç‚", transmission: "å‘¼å¸é“/æ¥è§¦", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "500", unit: "mg/L", time: "10åˆ†é’Ÿ", note: "æ— ç»†èƒå£" } },
    "ç©ºè‚ å¼¯æ›²èŒ": { type: "ç»†èŒ", category: "ç¬¬ä¸‰ç±»", bsl: "BSL-2", family: "å¼¯æ›²èŒå±", disease: "è…¹æ³»", transmission: "ç²ª-å£", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "500", unit: "mg/L", time: "10åˆ†é’Ÿ", note: "é£Ÿæºæ€§è…¹æ³»" } },
    "å•æ ¸å¢ç”Ÿææ–¯ç‰¹èŒ": { type: "ç»†èŒ", category: "ç¬¬ä¸‰ç±»", bsl: "BSL-2", family: "ææ–¯ç‰¹èŒå±", disease: "ææ–¯ç‰¹èŒç—…", transmission: "é£Ÿå…¥", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "500", unit: "mg/L", time: "10åˆ†é’Ÿ", note: "å­•å¦‡æ˜“æ„Ÿ" } },
    "å—œè‚ºå†›å›¢èŒ": { type: "ç»†èŒ", category: "ç¬¬ä¸‰ç±»", bsl: "BSL-2", family: "å†›å›¢èŒå±", disease: "å†›å›¢èŒç—…", transmission: "å‘¼å¸é“", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "1000", unit: "mg/L", time: "30åˆ†é’Ÿ", note: "ç©ºè°ƒå†·å´å¡”" } },
    "éœä¹±å¼§èŒ": { type: "ç»†èŒ", category: "ç¬¬äºŒç±»", bsl: "BSL-2", family: "å¼§èŒç§‘", disease: "éœä¹±", transmission: "ç²ª-å£", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "1000", unit: "mg/L", time: "30åˆ†é’Ÿ", note: "ç”²ç±»ä¼ æŸ“ç—…" } },
    
    // ç¬¬äºŒç±»çœŸèŒ
    "çš®ç‚èŠ½ç”ŸèŒ": { type: "çœŸèŒ", category: "ç¬¬äºŒç±»", bsl: "BSL-3", family: "èŠ½ç”ŸèŒå±", disease: "èŠ½ç”ŸèŒç—…", transmission: "å¸å…¥", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "1000", unit: "mg/L", time: "30åˆ†é’Ÿ", note: "çœŸèŒåŸ¹å…»ç‰©Aç±»è¿è¾“" } },
    "ç²—çƒå­¢å­èŒ": { type: "çœŸèŒ", category: "ç¬¬äºŒç±»", bsl: "BSL-3", family: "çƒå­¢å­èŒå±", disease: "çƒå­¢å­èŒç—…", transmission: "å¸å…¥", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "1000", unit: "mg/L", time: "30åˆ†é’Ÿ", note: "æ²™æ¼ é£æ¹¿" } },
    "èšè†œç»„ç»‡èƒæµ†èŒ": { type: "çœŸèŒ", category: "ç¬¬äºŒç±»", bsl: "BSL-3", family: "ç»„ç»‡èƒæµ†èŒå±", disease: "ç»„ç»‡èƒæµ†èŒç—…", transmission: "å¸å…¥", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "1000", unit: "mg/L", time: "30åˆ†é’Ÿ", note: "é¸Ÿç²ªä¼ æ’­" } },
    "å·´è¥¿å‰¯çƒå­¢å­èŒ": { type: "çœŸèŒ", category: "ç¬¬äºŒç±»", bsl: "BSL-3", family: "å‰¯çƒå­¢å­èŒå±", disease: "å‰¯çƒå­¢å­èŒç—…", transmission: "å¸å…¥", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "1000", unit: "mg/L", time: "30åˆ†é’Ÿ", note: "å—ç¾èŠ½ç”ŸèŒç—…" } },
    
    // ç¬¬ä¸‰ç±»çœŸèŒ
    "ç™½å¿µç èŒ": { type: "çœŸèŒ", category: "ç¬¬ä¸‰ç±»", bsl: "BSL-2", family: "å¿µç èŒå±", disease: "å¿µç èŒç—…", transmission: "å†…æºæ€§/æ¥è§¦", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "500", unit: "mg/L", time: "10åˆ†é’Ÿ", note: "æœºä¼šè‡´ç—…çœŸèŒ" } },
    "æ–°ç”ŸéšçƒèŒ": { type: "çœŸèŒ", category: "ç¬¬ä¸‰ç±»", bsl: "BSL-2", family: "éšçƒèŒå±", disease: "éšçƒèŒç—…/è„‘è†œç‚", transmission: "å¸å…¥", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "1000", unit: "mg/L", time: "30åˆ†é’Ÿ", note: "é¸½ç²ªä¼ æ’­" } },
    "çƒŸæ›²éœ‰": { type: "çœŸèŒ", category: "ç¬¬ä¸‰ç±»", bsl: "BSL-2", family: "æ›²éœ‰å±", disease: "æ›²éœ‰ç—…/è¿‡æ•", transmission: "å¸å…¥", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "1000", unit: "mg/L", time: "30åˆ†é’Ÿ", note: "ç©ºæ°”ä¼ æ’­" } },
    "é»„æ›²éœ‰": { type: "çœŸèŒ", category: "ç¬¬ä¸‰ç±»", bsl: "BSL-2", family: "æ›²éœ‰å±", disease: "æ›²éœ‰ç—…/é»„æ›²éœ‰æ¯’ç´ ä¸­æ¯’", transmission: "é£Ÿå…¥", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "1000", unit: "mg/L", time: "30åˆ†é’Ÿ", note: "äº§æ¯’ç´ " } },
    "æ¯›éœ‰": { type: "çœŸèŒ", category: "ç¬¬ä¸‰ç±»", bsl: "BSL-2", family: "æ¯›éœ‰å±", disease: "æ¯›éœ‰ç—…", transmission: "å¸å…¥/æ¥è§¦", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "1000", unit: "mg/L", time: "30åˆ†é’Ÿ", note: "ä¾µè¢­æ€§å¼º" } },
    "é©¬å°”å°¼è²ç¯®çŠ¶èŒ": { type: "çœŸèŒ", category: "ç¬¬ä¸‰ç±»", bsl: "BSL-2", family: "ç¯®çŠ¶èŒå±", disease: "é©¬å°”å°¼è²ç¯®çŠ¶èŒç—…", transmission: "å¸å…¥", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "1000", unit: "mg/L", time: "30åˆ†é’Ÿ", note: "ç«¹é¼ ä¼ æ’­" } },
    "çš®è‚¤ç™£èŒ": { type: "çœŸèŒ", category: "ç¬¬ä¸‰ç±»", bsl: "BSL-2", family: "ç™£èŒå±", disease: "ç™£/è„šæ°”", transmission: "æ¥è§¦", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "500", unit: "mg/L", time: "10åˆ†é’Ÿ", note: "è¡¨çš®çœŸèŒ" } },
    "ç”³å…‹å­¢å­ä¸èŒ": { type: "çœŸèŒ", category: "ç¬¬ä¸‰ç±»", bsl: "BSL-2", family: "å­¢å­ä¸èŒå±", disease: "å­¢å­ä¸èŒç—…", transmission: "ä¼¤å£", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "1000", unit: "mg/L", time: "30åˆ†é’Ÿ", note: "ç«ç‘°å›­ä¸ç—…" } },
    "è€³å¿µç èŒ": { type: "çœŸèŒ", category: "ç¬¬ä¸‰ç±»", bsl: "BSL-2", family: "å¿µç èŒå±", disease: "ä¾µè¢­æ€§å¿µç èŒç—…", transmission: "æ¥è§¦", disinfection: { type: "å«æ°¯æ¶ˆæ¯’å‰‚", conc: "1000", unit: "mg/L", time: "30åˆ†é’Ÿ", note: "å¤šé‡è€è¯" } },
    
    // æœŠç—…æ¯’
    "æœŠç—…æ¯’": { type: "æœŠç—…æ¯’", category: "ç¬¬äºŒç±»", bsl: "BSL-2/3", family: "æœŠè›‹ç™½", disease: "å…‹é›…ç—…/ç–¯ç‰›ç—…", transmission: "åŒ»æºæ€§/é£Ÿå…¥", disinfection: { type: "ç‰¹æ®Šå¤„ç†", conc: "1N", unit: "NaOH", time: "1å°æ—¶", note: "134â„ƒé«˜å‹ç­èŒ+NaOHå¤„ç†" } },
    "ç–¯ç‰›ç—…æœŠè›‹ç™½": { type: "æœŠç—…æ¯’", category: "ç¬¬äºŒç±»", bsl: "BSL-3", family: "æœŠè›‹ç™½", disease: "ç‰›æµ·ç»µçŠ¶è„‘ç—…", transmission: "é£Ÿå…¥", disinfection: { type: "ç‰¹æ®Šå¤„ç†", conc: "1N", unit: "NaOH", time: "1å°æ—¶", note: "éœ€è¦134â„ƒé«˜å‹ç­èŒ" } },
    "å˜å¼‚å‹å…‹é›…ç—…": { type: "æœŠç—…æ¯’", category: "ç¬¬äºŒç±»", bsl: "BSL-3", family: "æœŠè›‹ç™½", disease: "vCJD", transmission: "é£Ÿå…¥", disinfection: { type: "ç‰¹æ®Šå¤„ç†", conc: "1N", unit: "NaOH", time: "1å°æ—¶", note: "ç–¯ç‰›ç—…ç›¸å…³" } }
};

// å½“å‰é€‰ä¸­çš„ç—…åŸ
let currentPathogen = null;

// æœç´¢ç—…åŸå¾®ç”Ÿç‰©
function searchPathogen(event) {
    if (event && event.key && event.key !== 'Enter') return;
    
    const keyword = document.getElementById('pathogenSearch').value.trim();
    if (!keyword) {
        document.getElementById('pathogenResult').innerHTML = `
            <div class="empty-state">
                <p>ğŸ” è¯·è¾“å…¥å…³é”®è¯æœç´¢ç—…åŸå¾®ç”Ÿç‰©</p>
            </div>
        `;
        return;
    }
    
    const results = [];
    for (const [name, data] of Object.entries(pathogenDB)) {
        if (name.includes(keyword) || 
            data.disease.includes(keyword) || 
            data.family.includes(keyword) ||
            (data.type && data.type.includes(keyword))) {
            results.push({ name, ...data });
        }
    }
    
    displayPathogenResults(results);
}

// æ˜¾ç¤ºæœç´¢ç»“æœ
function displayPathogenResults(results) {
    if (results.length === 0) {
        document.getElementById('pathogenResult').innerHTML = `
            <div class="empty-state">
                <p>ğŸ˜” æœªæ‰¾åˆ°åŒ¹é…çš„ç—…åŸå¾®ç”Ÿç‰©</p>
                <p style="font-size: 12px; color: #999;">è¯·å°è¯•å…¶ä»–å…³é”®è¯ï¼ˆå¦‚ï¼šæ–°å† ã€ç»“æ ¸ã€èŠ½å­¢ç­‰ï¼‰</p>
            </div>
        `;
        return;
    }
    
    let html = `<div style="margin-bottom: 10px; color: #666;">æ‰¾åˆ° ${results.length} ä¸ªç»“æœï¼š</div>
        <div style="max-height: 400px; overflow-y: auto;">`;
    
    results.forEach(item => {
        const categoryColor = item.category === 'ç¬¬ä¸€ç±»' ? '#e74c3c' : 
                             item.category === 'ç¬¬äºŒç±»' ? '#f39c12' : 
                             item.category === 'ç¬¬ä¸‰ç±»' ? '#27ae60' : '#95a5a6';
        const categoryBg = item.category === 'ç¬¬ä¸€ç±»' ? '#ffebee' : 
                          item.category === 'ç¬¬äºŒç±»' ? '#fff3e0' : 
                          item.category === 'ç¬¬ä¸‰ç±»' ? '#e8f5e9' : '#f5f5f5';
        
        html += `
            <div class="record-card" style="cursor: pointer; border-left-color: ${categoryColor};" onclick="showPathogenDetail('${item.name}')">
                <div class="record-header">
                    <span style="font-weight: bold;">${item.name}</span>
                    <span style="background: ${categoryBg}; color: ${categoryColor}; padding: 2px 8px; border-radius: 10px; font-size: 12px;">${item.category}</span>
                </div>
                <div style="font-size: 13px; color: #666;">
                    <span>${item.type} | ${item.family} | BSL: ${item.bsl}</span>
                </div>
                <div style="font-size: 13px; color: #999; margin-top: 5px;">
                    æ‰€è‡´ç–¾ç—…: ${item.disease}
                </div>
            </div>
        `;
    });
    
    html += '</div>';
    document.getElementById('pathogenResult').innerHTML = html;
    document.getElementById('pathogenDetail').style.display = 'none';
}

// æ˜¾ç¤ºç—…åŸè¯¦æƒ…
function showPathogenDetail(name) {
    const data = pathogenDB[name];
    if (!data) return;
    
    currentPathogen = { name, ...data };
    
    const categoryColor = data.category === 'ç¬¬ä¸€ç±»' ? '#e74c3c' : 
                         data.category === 'ç¬¬äºŒç±»' ? '#f39c12' : 
                         data.category === 'ç¬¬ä¸‰ç±»' ? '#27ae60' : '#95a5a6';
    
    document.getElementById('detailTitle').innerHTML = `
        <span style="color: ${categoryColor};">${name}</span> 
        <span style="font-size: 14px; color: #666;">${data.disease}</span>
    `;
    
    document.getElementById('detailContent').innerHTML = `
        <div class="form-row">
            <div class="form-group">
                <label>ç—…åŸç±»å‹</label>
                <div>${data.type}</div>
            </div>
            <div class="form-group">
                <label>åˆ†ç±»å­¦åœ°ä½</label>
                <div>${data.family}</div>
            </div>
        </div>
        <div class="form-row">
            <div class="form-group">
                <label>å±å®³ç¨‹åº¦åˆ†ç±»</label>
                <div style="color: ${categoryColor}; font-weight: bold;">${data.category}</div>
            </div>
            <div class="form-group">
                <label>ç”Ÿç‰©å®‰å…¨å®éªŒå®¤ç­‰çº§</label>
                <div>${data.bsl}</div>
            </div>
        </div>
        <div class="form-row">
            <div class="form-group">
                <label>æ‰€è‡´ç–¾ç—…</label>
                <div>${data.disease}</div>
            </div>
            <div class="form-group">
                <label>ä¼ æ’­é€”å¾„</label>
                <div>${data.transmission}</div>
            </div>
        </div>
    `;
    
    // æ¶ˆæ¯’æ¨è
    const d = data.disinfection;
    document.getElementById('disinfectionRecommendation').innerHTML = `
        <div class="result-item">
            <strong>æ¨èæ¶ˆæ¯’å‰‚ï¼š</strong>${d.type}
        </div>
        <div class="result-item">
            <strong>æ¨èæµ“åº¦ï¼š</strong><span class="highlight">${d.conc} ${d.unit}</span>
        </div>
        <div class="result-item">
            <strong>ä½œç”¨æ—¶é—´ï¼š</strong>${d.time}
        </div>
        ${d.note ? `<div class="result-item" style="background: #fff3cd; padding: 10px; border-radius: 5px; margin-top: 10px;">
            <strong>âš ï¸ æ³¨æ„äº‹é¡¹ï¼š</strong>${d.note}
        </div>` : ''}
    `;
    
    document.getElementById('pathogenDetail').style.display = 'block';
    document.getElementById('pathogenDetail').scrollIntoView({ behavior: 'smooth' });
}

// åº”ç”¨ç—…åŸæ¶ˆæ¯’æ–¹æ¡ˆ
function applyPathogenDisinfection() {
    if (!currentPathogen) return;
    
    const d = currentPathogen.disinfection;
    
    // è®¾ç½®ç±»åˆ«
    const categoryMap = {
        "å«æ°¯æ¶ˆæ¯’å‰‚": "å«æ°¯æ¶ˆæ¯’å‰‚",
        "è¿‡æ°§åŒ–ç‰©ç±»": "è¿‡æ°§åŒ–ç‰©ç±»",
        "é†‡ç±»": "é†‡ç±»",
        "å­£é“µç›ç±»": "å­£é“µç›ç±»",
        "å…¶ä»–": "å…¶ä»–",
        "ç‰¹æ®Šå¤„ç†": "å«æ°¯æ¶ˆæ¯’å‰‚"
    };
    
    const category = categoryMap[d.type] || "å«æ°¯æ¶ˆæ¯’å‰‚";
    document.getElementById('category').value = category;
    updateDisinfectants();
    
    // é€‰æ‹©å…·ä½“æ¶ˆæ¯’å‰‚
    setTimeout(() => {
        const disinfectantSelect = document.getElementById('disinfectant');
        for (let i = 0; i < disinfectantSelect.options.length; i++) {
            if (disinfectantSelect.options[i].text.includes(d.type) ||
                (d.type.includes("84") && disinfectantSelect.options[i].text.includes("84"))) {
                disinfectantSelect.selectedIndex = i;
                break;
            }
        }
        updateConcentration();
        
        // è®¾ç½®ç›®æ ‡æµ“åº¦
        if (d.conc.includes('-')) {
            document.getElementById('targetConc').value = d.conc.split('-')[0];
        } else {
            document.getElementById('targetConc').value = d.conc;
        }
        
        const unitSelect = document.getElementById('targetUnit');
        if (d.unit === "mg/L" || d.unit === "NaOH") {
            unitSelect.value = "mg/L";
        } else {
            unitSelect.value = "%";
        }
        
        // åˆ‡æ¢åˆ°è®¡ç®—æ ‡ç­¾
        document.querySelectorAll('.tab')[0].click();
        alert(`å·²åº”ç”¨ ${currentPathogen.name} çš„æ¶ˆæ¯’æ–¹æ¡ˆï¼š${d.type} ${d.conc}${d.unit}ï¼Œ${d.time}`);
    }, 100);
}

// æ¸…ç©ºæœç´¢
function clearPathogenSearch() {
    document.getElementById('pathogenSearch').value = '';
    document.getElementById('pathogenCategoryFilter').value = '';
    document.getElementById('pathogenTypeFilter').value = '';
    document.getElementById('bslFilter').value = '';
    document.getElementById('pathogenResult').innerHTML = `
        <div class="empty-state">
            <p>ğŸ” è¯·è¾“å…¥å…³é”®è¯æœç´¢ç—…åŸå¾®ç”Ÿç‰©ï¼Œæˆ–ä½¿ç”¨ç­›é€‰æ¡ä»¶</p>
            <p style="font-size: 12px; color: #999; margin-top: 10px;">æ•°æ®æ¥æºï¼šã€Šäººé—´ä¼ æŸ“çš„ç—…åŸå¾®ç”Ÿç‰©ç›®å½•ã€‹ï¼ˆ2023å¹´ç‰ˆï¼‰</p>
        </div>
    `;
    document.getElementById('pathogenDetail').style.display = 'none';
}

// æŒ‰åˆ†ç±»ç­›é€‰
function filterPathogenByCategory() {
    const category = document.getElementById('pathogenCategoryFilter').value;
    if (!category) {
        document.getElementById('pathogenResult').innerHTML = `
            <div class="empty-state">
                <p>ğŸ” è¯·é€‰æ‹©å±å®³ç¨‹åº¦åˆ†ç±»æˆ–ä½¿ç”¨æœç´¢åŠŸèƒ½</p>
            </div>
        `;
        return;
    }
    
    const results = [];
    for (const [name, data] of Object.entries(pathogenDB)) {
        if (data.category === category) {
            results.push({ name, ...data });
        }
    }
    
    displayPathogenResults(results);
}

// æŒ‰ç±»å‹ç­›é€‰
function filterPathogenByType() {
    const type = document.getElementById('pathogenTypeFilter').value;
    if (!type) return;
    
    const results = [];
    for (const [name, data] of Object.entries(pathogenDB)) {
        if (data.type === type) {
            results.push({ name, ...data });
        }
    }
    
    displayPathogenResults(results);
}

// æŒ‰BSLç­›é€‰
function filterPathogenByBSL() {
    const bsl = document.getElementById('bslFilter').value;
    if (!bsl) return;
    
    const results = [];
    for (const [name, data] of Object.entries(pathogenDB)) {
        if (data.bsl.includes(bsl)) {
            results.push({ name, ...data });
        }
    }
    
    displayPathogenResults(results);
}

// æ˜¾ç¤ºç¬¬ä¸€ç±»ç—…åŸï¼ˆé«˜è‡´ç—…æ€§ï¼‰
function showHighRiskPathogens() {
    document.getElementById('pathogenCategoryFilter').value = 'ç¬¬ä¸€ç±»';
    filterPathogenByCategory();
}

// æ˜¾ç¤ºå‘¼å¸é“ä¼ æ’­ç—…åŸ
function showRespiratoryPathogens() {
    const results = [];
    for (const [name, data] of Object.entries(pathogenDB)) {
        if (data.transmission.includes('å‘¼å¸é“') || data.transmission.includes('é£æ²«') || data.transmission.includes('ç©ºæ°”')) {
            results.push({ name, ...data });
        }
    }
    displayPathogenResults(results);
}

// æ˜¾ç¤ºè¡€æ¶²ä¼ æ’­ç—…åŸ
function showBloodPathogens() {
    const results = [];
    for (const [name, data] of Object.entries(pathogenDB)) {
        if (data.transmission.includes('è¡€æ¶²') || data.transmission.includes('ä½“æ¶²')) {
            results.push({ name, ...data });
        }
    }
    displayPathogenResults(results);
}

// ==================== ç—…åŸå¾®ç”Ÿç‰©æ¨¡å—ç»“æŸ ====================

// ==================== æµè°ƒåˆ†ææ¨¡å— ====================

// å½“å‰åˆ†ææ¨¡å¼
let currentAnalysisMode = 'text';
let uploadedImageData = null;
let uploadedPdfText = null;
let lastAnalysisResult = null;

// åˆ‡æ¢åˆ†ææ¨¡å¼
function setAnalysisMode(mode) {
    currentAnalysisMode = mode;
    
    // æ›´æ–°æŒ‰é’®æ ·å¼
    document.getElementById('modeText').className = mode === 'text' ? 'btn btn-primary' : 'btn btn-secondary';
    document.getElementById('modeImage').className = mode === 'image' ? 'btn btn-primary' : 'btn btn-secondary';
    document.getElementById('modePdf').className = mode === 'pdf' ? 'btn btn-primary' : 'btn btn-secondary';
    
    // æ˜¾ç¤º/éšè—å¯¹åº”è¾“å…¥åŒºåŸŸ
    document.getElementById('textInputArea').style.display = mode === 'text' ? 'block' : 'none';
    document.getElementById('imageInputArea').style.display = mode === 'image' ? 'block' : 'none';
    document.getElementById('pdfInputArea').style.display = mode === 'pdf' ? 'block' : 'none';
}

// å¤„ç†å›¾ç‰‡ä¸Šä¼ 
function handleImageUpload(event) {
    const file = event.target.files[0];
    if (!file) return;
    
    if (!file.type.startsWith('image/')) {
        showAnalysisStatus('è¯·é€‰æ‹©å›¾ç‰‡æ–‡ä»¶', 'error');
        return;
    }
    
    if (file.size > 10 * 1024 * 1024) {
        showAnalysisStatus('å›¾ç‰‡å¤§å°ä¸èƒ½è¶…è¿‡10MB', 'error');
        return;
    }
    
    const reader = new FileReader();
    reader.onload = function(e) {
        uploadedImageData = e.target.result;
        document.getElementById('previewImg').src = uploadedImageData;
        document.getElementById('imagePreview').style.display = 'block';
        showAnalysisStatus('å›¾ç‰‡å·²åŠ è½½ï¼Œç‚¹å‡»AIæ™ºèƒ½åˆ†æå¼€å§‹è¯†åˆ«', 'success');
    };
    reader.readAsDataURL(file);
}

// æ¸…é™¤å›¾ç‰‡
function clearImage() {
    uploadedImageData = null;
    document.getElementById('epidemicImage').value = '';
    document.getElementById('imagePreview').style.display = 'none';
    document.getElementById('previewImg').src = '';
}

// å¤„ç†PDFä¸Šä¼ 
async function handlePdfUpload(event) {
    const file = event.target.files[0];
    if (!file) return;
    
    if (file.type !== 'application/pdf') {
        showAnalysisStatus('è¯·é€‰æ‹©PDFæ–‡ä»¶', 'error');
        return;
    }
    
    if (file.size > 10 * 1024 * 1024) {
        showAnalysisStatus('PDFå¤§å°ä¸èƒ½è¶…è¿‡10MB', 'error');
        return;
    }
    
    document.getElementById('pdfFileName').textContent = file.name;
    document.getElementById('pdfPreview').style.display = 'block';
    document.getElementById('pdfExtractedText').textContent = 'æ­£åœ¨æå–æ–‡æœ¬å†…å®¹...';
    
    try {
        // ä½¿ç”¨PDF.jsæå–æ–‡æœ¬
        const arrayBuffer = await file.arrayBuffer();
        const pdf = await pdfjsLib.getDocument({ data: arrayBuffer }).promise;
        
        let fullText = '';
        for (let i = 1; i <= pdf.numPages; i++) {
            const page = await pdf.getPage(i);
            const textContent = await page.getTextContent();
            const pageText = textContent.items.map(item => item.str).join(' ');
            fullText += pageText + '\n';
        }
        
        uploadedPdfText = fullText;
        document.getElementById('pdfExtractedText').textContent = fullText.substring(0, 500) + (fullText.length > 500 ? '...' : '');
        showAnalysisStatus('PDFæ–‡æœ¬å·²æå–ï¼Œç‚¹å‡»AIæ™ºèƒ½åˆ†æå¼€å§‹è¯†åˆ«', 'success');
    } catch (error) {
        console.error('PDFè§£æé”™è¯¯:', error);
        document.getElementById('pdfExtractedText').textContent = 'PDFæ–‡æœ¬æå–å¤±è´¥ï¼Œå°†å°è¯•ç›´æ¥åˆ†æPDFå†…å®¹';
        showAnalysisStatus('PDFæ–‡æœ¬æå–å¤±è´¥ï¼ŒAIå°†å°è¯•ç›´æ¥åˆ†æ', 'warning');
    }
}

// æ¸…é™¤PDF
function clearPdf() {
    uploadedPdfText = null;
    document.getElementById('epidemicPdf').value = '';
    document.getElementById('pdfPreview').style.display = 'none';
}

// æ¸…ç©ºåˆ†æè¾“å…¥
function clearAnalysisInput() {
    document.getElementById('epidemicText').value = '';
    clearImage();
    clearPdf();
    document.getElementById('analysisResult').style.display = 'none';
    lastAnalysisResult = null;
}

// æ˜¾ç¤ºåˆ†æçŠ¶æ€
function showAnalysisStatus(message, type) {
    const statusDiv = document.getElementById('analysisStatus');
    const colors = {
        success: '#d4edda',
        error: '#f8d7da',
        warning: '#fff3cd',
        info: '#e7f3ff'
    };
    const borderColors = {
        success: '#28a745',
        error: '#dc3545',
        warning: '#ffc107',
        info: '#0066cc'
    };
    const textColors = {
        success: '#155724',
        error: '#721c24',
        warning: '#856404',
        info: '#004085'
    };
    
    statusDiv.innerHTML = `
        <div style="background: ${colors[type]}; border-left: 4px solid ${borderColors[type]}; padding: 12px; border-radius: 5px; color: ${textColors[type]};">
            ${message}
        </div>
    `;
    
    if (type === 'success' || type === 'warning') {
        setTimeout(() => { statusDiv.innerHTML = ''; }, 5000);
    }
}

// AIåˆ†ææµè°ƒæŠ¥å‘Š
async function analyzeEpidemicReport() {
    const config = loadAIConfig();
    
    if (!config.apiKey) {
        showAnalysisStatus('è¯·å…ˆé…ç½®AI APIï¼ˆç‚¹å‡»"AIé…ç½®"æ ‡ç­¾é¡µï¼‰', 'error');
        return;
    }
    
    // è·å–è¾“å…¥å†…å®¹
    let content = '';
    let contentType = '';
    
    if (currentAnalysisMode === 'text') {
        content = document.getElementById('epidemicText').value.trim();
        if (!content) {
            showAnalysisStatus('è¯·è¾“å…¥æµè°ƒæŠ¥å‘Šå†…å®¹', 'error');
            return;
        }
        contentType = 'æ–‡æœ¬';
    } else if (currentAnalysisMode === 'image') {
        if (!uploadedImageData) {
            showAnalysisStatus('è¯·å…ˆä¸Šä¼ å›¾ç‰‡', 'error');
            return;
        }
        content = uploadedImageData;
        contentType = 'å›¾ç‰‡';
    } else if (currentAnalysisMode === 'pdf') {
        if (!uploadedPdfText) {
            showAnalysisStatus('PDFæ–‡æœ¬æå–å¤±è´¥ï¼Œè¯·å°è¯•ä½¿ç”¨æ–‡æœ¬æ¨¡å¼æ‰‹åŠ¨ç²˜è´´å†…å®¹', 'error');
            return;
        }
        content = uploadedPdfText;
        contentType = 'PDF';
    }
    
    // æ˜¾ç¤ºåˆ†æä¸­çŠ¶æ€
    document.getElementById('analysisResult').style.display = 'none';
    showAnalysisStatus('ğŸ” AIæ­£åœ¨åˆ†ææµè°ƒæŠ¥å‘Šï¼Œè¯·ç¨å€™...', 'info');
    
    try {
        // å¤„ç†baseUrlæœ«å°¾æ–œæ 
        let baseUrl = config.baseUrl.trim();
        if (baseUrl.endsWith('/')) {
            baseUrl = baseUrl.slice(0, -1);
        }
        
        // æ„å»ºç³»ç»Ÿæç¤ºè¯
        const systemPrompt = `ä½ æ˜¯ä¸€ä½ä¸“ä¸šçš„æµè¡Œç—…å­¦å’Œæ¶ˆæ¯’å­¦ä¸“å®¶ã€‚è¯·åˆ†ææä¾›çš„æµè°ƒæŠ¥å‘Šï¼Œè¯†åˆ«å¯èƒ½çš„è‡´ç—…èŒï¼Œå¹¶æ¨èç›¸åº”çš„æ¶ˆæ¯’æ–¹æ¡ˆã€‚

è¯·æŒ‰ä»¥ä¸‹JSONæ ¼å¼è¿”å›åˆ†æç»“æœï¼š
{
    "pathogens": [
        {
            "name": "ç—…åŸåç§°",
            "probability": "é«˜/ä¸­/ä½",
            "reason": "åˆ¤æ–­ä¾æ®",
            "category": "ç»†èŒ/ç—…æ¯’/çœŸèŒ/å…¶ä»–",
            "dangerLevel": "ç¬¬ä¸€/äºŒ/ä¸‰/å››ç±»"
        }
    ],
    "transmission": {
        "routes": ["ä¼ æ’­é€”å¾„1", "ä¼ æ’­é€”å¾„2"],
        "riskLevel": "é«˜/ä¸­/ä½",
        "keyPoints": "é˜²æ§è¦ç‚¹"
    },
    "disinfection": {
        "environment": {
            "type": "æ¶ˆæ¯’å‰‚ç±»å‹",
            "concentration": "æ¨èæµ“åº¦",
            "method": "ä½¿ç”¨æ–¹æ³•",
            "time": "ä½œç”¨æ—¶é—´"
        },
        "surface": {
            "type": "æ¶ˆæ¯’å‰‚ç±»å‹",
            "concentration": "æ¨èæµ“åº¦",
            "method": "ä½¿ç”¨æ–¹æ³•",
            "time": "ä½œç”¨æ—¶é—´"
        },
        "air": {
            "type": "æ¶ˆæ¯’æ–¹å¼",
            "method": "æ“ä½œæ–¹æ³•",
            "time": "ä½œç”¨æ—¶é—´"
        },
        "ppe": {
            "level": "é˜²æŠ¤çº§åˆ«",
            "equipment": ["é˜²æŠ¤è£…å¤‡1", "é˜²æŠ¤è£…å¤‡2"]
        }
    },
    "analysis": "è¯¦ç»†çš„åˆ†æè¯´æ˜"
}

æ³¨æ„ï¼š
1. åŸºäºæŠ¥å‘Šä¸­çš„ç—‡çŠ¶ã€æ¥è§¦å²ã€å®éªŒå®¤æ£€æŸ¥ç­‰ä¿¡æ¯è¿›è¡Œåˆ†æ
2. ä¼˜å…ˆè€ƒè™‘å¸¸è§çš„ä¼ æŸ“ç—…åŸä½“
3. æ¶ˆæ¯’æ–¹æ¡ˆåº”ç¬¦åˆGB19193-2025æ ‡å‡†
4. å¦‚æœæ˜¯é«˜è‡´ç—…æ€§ç—…åŸï¼ˆç¬¬ä¸€ç±»ã€ç¬¬äºŒç±»ï¼‰ï¼Œå¿…é¡»æ˜ç¡®æ ‡æ³¨å¹¶ç»™å‡ºä¸¥æ ¼çš„æ¶ˆæ¯’å’Œé˜²æŠ¤å»ºè®®`;

        // æ„å»ºç”¨æˆ·æ¶ˆæ¯
        let userMessage = '';
        let messages = [];
        
        if (currentAnalysisMode === 'image') {
            // å›¾ç‰‡æ¨¡å¼ä½¿ç”¨vision API
            messages = [
                { role: 'system', content: systemPrompt },
                {
                    role: 'user',
                    content: [
                        { type: 'text', text: 'è¯·åˆ†æè¿™å¼ æµè°ƒæŠ¥å‘Šå›¾ç‰‡ï¼Œè¯†åˆ«å¯èƒ½çš„è‡´ç—…èŒå¹¶æ¨èæ¶ˆæ¯’æ–¹æ¡ˆã€‚' },
                        { type: 'image_url', image_url: { url: content } }
                    ]
                }
            ];
        } else {
            // æ–‡æœ¬/PDFæ¨¡å¼
            userMessage = `è¯·åˆ†æä»¥ä¸‹æµè°ƒæŠ¥å‘Šï¼š\n\n${content}`;
            messages = [
                { role: 'system', content: systemPrompt },
                { role: 'user', content: userMessage }
            ];
        }
        
        // æ„å»ºè¯·æ±‚ä½“
        const requestBody = {
            model: config.model,
            messages: messages,
            max_tokens: config.maxTokens,
            temperature: config.temperature
        };
        
        // ä½¿ç”¨AbortControllerå®ç°è¶…æ—¶
        const controller = new AbortController();
        const timeoutId = setTimeout(() => controller.abort(), 60000); // 60ç§’è¶…æ—¶
        
        // å‘é€è¯·æ±‚
        const response = await fetch(`${baseUrl}/chat/completions`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'Authorization': `Bearer ${config.apiKey}`
            },
            body: JSON.stringify(requestBody),
            signal: controller.signal
        });
        
        clearTimeout(timeoutId);
        
        if (!response.ok) {
            let errorMessage = `HTTP ${response.status}`;
            try {
                const errorText = await response.text();
                try {
                    const errorJson = JSON.parse(errorText);
                    errorMessage = errorJson.error?.message || errorJson.message || errorText;
                } catch {
                    errorMessage = errorText || `HTTP ${response.status}`;
                }
            } catch {
                errorMessage = `HTTP ${response.status}`;
            }
            throw new Error(errorMessage);
        }
        
        const data = await response.json();
        const aiResponse = data.choices[0].message.content;
        
        // è§£æAIè¿”å›çš„JSON
        let analysisResult;
        try {
            // å°è¯•ä»AIå“åº”ä¸­æå–JSON
            const jsonMatch = aiResponse.match(/\{[\s\S]*\}/);
            if (jsonMatch) {
                analysisResult = JSON.parse(jsonMatch[0]);
            } else {
                throw new Error('æ— æ³•è§£æAIè¿”å›çš„ç»“æœ');
            }
        } catch (parseError) {
            console.error('JSONè§£æé”™è¯¯:', parseError);
            // å¦‚æœè§£æå¤±è´¥ï¼Œä½¿ç”¨åŸå§‹æ–‡æœ¬ä½œä¸ºåˆ†æç»“æœ
            analysisResult = {
                pathogens: [],
                transmission: { routes: [], riskLevel: 'æœªçŸ¥', keyPoints: '' },
                disinfection: {},
                analysis: aiResponse
            };
        }
        
        // ä¿å­˜åˆ†æç»“æœ
        lastAnalysisResult = analysisResult;
        
        // æ˜¾ç¤ºåˆ†æç»“æœ
        displayAnalysisResult(analysisResult);
        
        showAnalysisStatus(`${contentType}åˆ†æå®Œæˆï¼`, 'success');
        
    } catch (error) {
        console.error('AIåˆ†æé”™è¯¯:', error);
        let errorMsg = error.message;
        
        if (error.name === 'AbortError') {
            errorMsg = 'åˆ†æè¶…æ—¶ï¼ˆ60ç§’ï¼‰ï¼Œè¯·é‡è¯•æˆ–ç¼©çŸ­è¾“å…¥å†…å®¹';
        } else if (error.message.includes('Failed to fetch')) {
            errorMsg = 'ç½‘ç»œè¯·æ±‚å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥å’ŒAPIé…ç½®';
        }
        
        showAnalysisStatus(`åˆ†æå¤±è´¥: ${errorMsg}`, 'error');
    }
}

// æ˜¾ç¤ºåˆ†æç»“æœ
function displayAnalysisResult(result) {
    const resultDiv = document.getElementById('analysisResult');
    resultDiv.style.display = 'block';
    
    // æ˜¾ç¤ºå¯èƒ½çš„ç—…åŸ
    const pathogensDiv = document.getElementById('pathogensList');
    if (result.pathogens && result.pathogens.length > 0) {
        pathogensDiv.innerHTML = result.pathogens.map(p => `
            <div style="background: white; padding: 12px; margin-bottom: 10px; border-radius: 8px; border-left: 4px solid ${p.dangerLevel === 'ç¬¬ä¸€ç±»' || p.dangerLevel === 'ç¬¬äºŒç±»' ? '#dc3545' : '#28a745'};">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 5px;">
                    <strong style="font-size: 16px;">${p.name}</strong>
                    <span style="background: ${p.probability === 'é«˜' ? '#dc3545' : p.probability === 'ä¸­' ? '#ffc107' : '#6c757d'}; color: white; padding: 2px 8px; border-radius: 4px; font-size: 12px;">${p.probability}æ¦‚ç‡</span>
                </div>
                <div style="color: #666; font-size: 13px; margin-bottom: 5px;">${p.reason}</div>
                <div style="display: flex; gap: 10px; font-size: 12px; color: #999;">
                    <span>ğŸ“‚ ${p.category}</span>
                    <span>âš ï¸ ${p.dangerLevel}</span>
                </div>
            </div>
        `).join('');
    } else {
        pathogensDiv.innerHTML = '<div style="color: #999; padding: 10px;">æœªèƒ½è¯†åˆ«å…·ä½“ç—…åŸï¼Œè¯·å‚è€ƒAIåˆ†æè¯¦æƒ…</div>';
    }
    
    // æ˜¾ç¤ºä¼ æ’­é€”å¾„
    const routeDiv = document.getElementById('routeContent');
    if (result.transmission) {
        routeDiv.innerHTML = `
            <div style="background: white; padding: 15px; border-radius: 8px;">
                <div style="margin-bottom: 10px;">
                    <strong>ä¼ æ’­é€”å¾„ï¼š</strong>${result.transmission.routes ? result.transmission.routes.join('ã€') : 'æœªçŸ¥'}
                </div>
                <div style="margin-bottom: 10px;">
                    <strong>é£é™©ç­‰çº§ï¼š</strong>
                    <span style="color: ${result.transmission.riskLevel === 'é«˜' ? '#dc3545' : result.transmission.riskLevel === 'ä¸­' ? '#ffc107' : '#28a745'}; font-weight: bold;">
                        ${result.transmission.riskLevel}
                    </span>
                </div>
                <div>
                    <strong>é˜²æ§è¦ç‚¹ï¼š</strong>${result.transmission.keyPoints || 'æš‚æ— '}
                </div>
            </div>
        `;
    } else {
        routeDiv.innerHTML = '<div style="color: #999; padding: 10px;">æš‚æ— ä¼ æ’­é€”å¾„ä¿¡æ¯</div>';
    }
    
    // æ˜¾ç¤ºæ¨èæ–¹æ¡ˆ
    const planDiv = document.getElementById('planContent');
    if (result.disinfection) {
        const d = result.disinfection;
        let planHtml = '<div style="background: white; padding: 15px; border-radius: 8px;">';
        
        if (d.environment) {
            planHtml += `
                <div style="margin-bottom: 15px;">
                    <strong style="color: #667eea;">ğŸŒ ç¯å¢ƒæ¶ˆæ¯’</strong>
                    <div style="margin-top: 5px; padding-left: 15px;">
                        <div>æ¶ˆæ¯’å‰‚ï¼š${d.environment.type} ${d.environment.concentration}</div>
                        <div>æ–¹æ³•ï¼š${d.environment.method}</div>
                        <div>æ—¶é—´ï¼š${d.environment.time}</div>
                    </div>
                </div>
            `;
        }
        
        if (d.surface) {
            planHtml += `
                <div style="margin-bottom: 15px;">
                    <strong style="color: #667eea;">ğŸ–ï¸ ç‰©ä½“è¡¨é¢</strong>
                    <div style="margin-top: 5px; padding-left: 15px;">
                        <div>æ¶ˆæ¯’å‰‚ï¼š${d.surface.type} ${d.surface.concentration}</div>
                        <div>æ–¹æ³•ï¼š${d.surface.method}</div>
                        <div>æ—¶é—´ï¼š${d.surface.time}</div>
                    </div>
                </div>
            `;
        }
        
        if (d.air) {
            planHtml += `
                <div style="margin-bottom: 15px;">
                    <strong style="color: #667eea;">ğŸ’¨ ç©ºæ°”æ¶ˆæ¯’</strong>
                    <div style="margin-top: 5px; padding-left: 15px;">
                        <div>æ–¹å¼ï¼š${d.air.type}</div>
                        <div>æ–¹æ³•ï¼š${d.air.method}</div>
                        <div>æ—¶é—´ï¼š${d.air.time}</div>
                    </div>
                </div>
            `;
        }
        
        if (d.ppe) {
            planHtml += `
                <div>
                    <strong style="color: #667eea;">ğŸ›¡ï¸ ä¸ªäººé˜²æŠ¤</strong>
                    <div style="margin-top: 5px; padding-left: 15px;">
                        <div>é˜²æŠ¤çº§åˆ«ï¼š${d.ppe.level}</div>
                        <div>é˜²æŠ¤è£…å¤‡ï¼š${d.ppe.equipment ? d.ppe.equipment.join('ã€') : 'æš‚æ— '}</div>
                    </div>
                </div>
            `;
        }
        
        planHtml += '</div>';
        planDiv.innerHTML = planHtml;
    } else {
        planDiv.innerHTML = '<div style="color: #999; padding: 10px;">æš‚æ— æ¨èæ¶ˆæ¯’æ–¹æ¡ˆ</div>';
    }
    
    // æ˜¾ç¤ºAIåˆ†æåŸå§‹æ–‡æœ¬
    document.getElementById('rawContent').textContent = result.analysis || JSON.stringify(result, null, 2);
    
    // æ»šåŠ¨åˆ°ç»“æœåŒºåŸŸ
    resultDiv.scrollIntoView({ behavior: 'smooth', block: 'start' });
}

// åº”ç”¨æ¨èæ–¹æ¡ˆåˆ°è®¡ç®—å™¨
function applyRecommendedPlan() {
    if (!lastAnalysisResult || !lastAnalysisResult.disinfection) {
        showAnalysisStatus('æ²¡æœ‰å¯åº”ç”¨çš„æ¨èæ–¹æ¡ˆ', 'error');
        return;
    }
    
    const d = lastAnalysisResult.disinfection;
    let applied = false;
    
    // ä¼˜å…ˆåº”ç”¨ç¯å¢ƒæ¶ˆæ¯’æ–¹æ¡ˆ
    if (d.environment) {
        applyDisinfectionPlan(d.environment);
        applied = true;
    } else if (d.surface) {
        applyDisinfectionPlan(d.surface);
        applied = true;
    }
    
    if (applied) {
        showAnalysisStatus('æ¨èæ–¹æ¡ˆå·²åº”ç”¨åˆ°é…æ¯”è®¡ç®—å™¨ï¼', 'success');
    } else {
        showAnalysisStatus('æ¨èæ–¹æ¡ˆç¼ºå°‘å…·ä½“å‚æ•°ï¼Œæ— æ³•è‡ªåŠ¨åº”ç”¨', 'warning');
    }
}

// è¾…åŠ©å‡½æ•°ï¼šåº”ç”¨æ¶ˆæ¯’æ–¹æ¡ˆåˆ°è®¡ç®—å™¨
function applyDisinfectionPlan(plan) {
    // è§£ææµ“åº¦å’Œå•ä½
    let conc = plan.concentration || '';
    let unit = 'mg/L';
    
    if (conc.includes('%')) {
        unit = '%';
        conc = conc.replace('%', '').trim();
    } else if (conc.includes('mg/L')) {
        unit = 'mg/L';
        conc = conc.replace('mg/L', '').trim();
    }
    
    // è®¾ç½®ç›®æ ‡æµ“åº¦
    document.getElementById('targetConc').value = conc || '500';
    document.getElementById('targetUnit').value = unit;
    
    // å°è¯•åŒ¹é…æ¶ˆæ¯’å‰‚ç±»å‹
    const type = plan.type || '';
    const categoryMap = {
        'å«æ°¯': 'å«æ°¯æ¶ˆæ¯’å‰‚',
        '84': 'å«æ°¯æ¶ˆæ¯’å‰‚',
        'æ¬¡æ°¯é…¸': 'å«æ°¯æ¶ˆæ¯’å‰‚',
        'è¿‡æ°§ä¹™é…¸': 'è¿‡æ°§åŒ–ç‰©ç±»',
        'è¿‡æ°§åŒ–æ°¢': 'è¿‡æ°§åŒ–ç‰©ç±»',
        'äºŒæ°§åŒ–æ°¯': 'äºŒæ°§åŒ–æ°¯',
        'ä¹™é†‡': 'é†‡ç±»',
        'é…’ç²¾': 'é†‡ç±»',
        'ç¢˜': 'ç¢˜ç±»',
        'å­£é“µ': 'å­£é“µç›ç±»',
        'æˆŠäºŒé†›': 'é†›ç±»'
    };
    
    let category = 'å«æ°¯æ¶ˆæ¯’å‰‚';
    for (const key in categoryMap) {
        if (type.includes(key)) {
            category = categoryMap[key];
            break;
        }
    }
    
    document.getElementById('category').value = category;
    updateDisinfectants();
    
    // åˆ‡æ¢åˆ°è®¡ç®—æ ‡ç­¾
    switchTab('calc');
}

// å¯¼å‡ºåˆ†æç»“æœ
function exportAnalysisResult() {
    if (!lastAnalysisResult) {
        showAnalysisStatus('æ²¡æœ‰å¯å¯¼å‡ºçš„åˆ†æç»“æœ', 'error');
        return;
    }
    
    const content = JSON.stringify(lastAnalysisResult, null, 2);
    const blob = new Blob([content], { type: 'application/json' });
    const url = URL.createObjectURL(blob);
    
    const link = document.createElement('a');
    link.href = url;
    link.download = `æµè°ƒåˆ†ææŠ¥å‘Š_${new Date().toLocaleDateString()}.json`;
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
    
    URL.revokeObjectURL(url);
    showAnalysisStatus('åˆ†æç»“æœå·²å¯¼å‡º', 'success');
}

// æ‹–æ‹½ä¸Šä¼ æ”¯æŒ
function initDragAndDrop() {
    const imageZone = document.getElementById('imageDropZone');
    const pdfZone = document.getElementById('pdfDropZone');
    
    if (imageZone) {
        imageZone.addEventListener('dragover', (e) => {
            e.preventDefault();
            imageZone.style.background = '#e7f3ff';
        });
        
        imageZone.addEventListener('dragleave', () => {
            imageZone.style.background = '#f8f9fa';
        });
        
        imageZone.addEventListener('drop', (e) => {
            e.preventDefault();
            imageZone.style.background = '#f8f9fa';
            const files = e.dataTransfer.files;
            if (files.length > 0 && files[0].type.startsWith('image/')) {
                const input = document.getElementById('epidemicImage');
                const dt = new DataTransfer();
                dt.items.add(files[0]);
                input.files = dt.files;
                handleImageUpload({ target: input });
            }
        });
    }
    
    if (pdfZone) {
        pdfZone.addEventListener('dragover', (e) => {
            e.preventDefault();
            pdfZone.style.background = '#e7f3ff';
        });
        
        pdfZone.addEventListener('dragleave', () => {
            pdfZone.style.background = '#f8f9fa';
        });
        
        pdfZone.addEventListener('drop', (e) => {
            e.preventDefault();
            pdfZone.style.background = '#f8f9fa';
            const files = e.dataTransfer.files;
            if (files.length > 0 && files[0].type === 'application/pdf') {
                const input = document.getElementById('epidemicPdf');
                const dt = new DataTransfer();
                dt.items.add(files[0]);
                input.files = dt.files;
                handlePdfUpload({ target: input });
            }
        });
    }
}

// åˆå§‹åŒ–æµè°ƒåˆ†ææ¨¡å—
function initEpidemicAnalysis() {
    // é»˜è®¤é€‰æ‹©æ–‡æœ¬æ¨¡å¼
    setAnalysisMode('text');
    
    // åˆå§‹åŒ–æ‹–æ‹½ä¸Šä¼ 
    initDragAndDrop();
}

// ==================== æµè°ƒåˆ†ææ¨¡å—ç»“æŸ ====================

// ==================== AIé…ç½®æ¨¡å— ====================

// é»˜è®¤AIé…ç½®
const defaultAIConfig = {
    provider: 'kimi',
    baseUrl: 'https://api.moonshot.cn/v1',
    apiKey: '',
    model: 'kimi-coding/k2p5',
    temperature: 0.7,
    maxTokens: 4096,
    localMode: false
};

// AIæä¾›å•†é…ç½®æ¨¡æ¿
const aiProviderTemplates = {
    kimi: {
        baseUrl: 'https://api.moonshot.cn/v1',
        model: 'kimi-coding/k2p5',
        name: 'Kimi (Moonshot)'
    },
    openai: {
        baseUrl: 'https://api.openai.com/v1',
        model: 'gpt-4',
        name: 'OpenAI'
    },
    claude: {
        baseUrl: 'https://api.anthropic.com/v1',
        model: 'claude-3-opus-20240229',
        name: 'Claude (Anthropic)'
    },
    custom: {
        baseUrl: '',
        model: '',
        name: 'è‡ªå®šä¹‰ API'
    }
};

// åŠ è½½AIé…ç½®
function loadAIConfig() {
    const saved = localStorage.getItem('aiConfig');
    if (saved) {
        return { ...defaultAIConfig, ...JSON.parse(saved) };
    }
    return defaultAIConfig;
}

// ä¿å­˜AIé…ç½®
function saveAIConfig() {
    const config = {
        provider: document.getElementById('aiProvider').value,
        baseUrl: document.getElementById('aiBaseUrl').value,
        apiKey: document.getElementById('aiApiKey').value,
        model: document.getElementById('aiModel').value,
        temperature: parseFloat(document.getElementById('aiTemperature').value),
        maxTokens: parseInt(document.getElementById('aiMaxTokens').value),
        localMode: document.getElementById('aiLocalMode').checked
    };
    
    localStorage.setItem('aiConfig', JSON.stringify(config));
    
    // æ˜¾ç¤ºä¿å­˜æˆåŠŸæç¤º
    const resultDiv = document.getElementById('aiTestResult');
    resultDiv.innerHTML = `
        <div style="background: #d4edda; border-left: 4px solid #28a745; padding: 12px; border-radius: 5px; color: #155724;">
            âœ… é…ç½®å·²ä¿å­˜åˆ°æœ¬åœ°
        </div>
    `;
    
    setTimeout(() => {
        resultDiv.innerHTML = '';
    }, 3000);
}

// æ¢å¤é»˜è®¤é…ç½®
function resetAIConfig() {
    if (!confirm('ç¡®å®šæ¢å¤é»˜è®¤é…ç½®å—ï¼Ÿå½“å‰é…ç½®å°†è¢«è¦†ç›–ã€‚')) {
        return;
    }
    
    localStorage.removeItem('aiConfig');
    displayAIConfig(defaultAIConfig);
    
    const resultDiv = document.getElementById('aiTestResult');
    resultDiv.innerHTML = `
        <div style="background: #d4edda; border-left: 4px solid #28a745; padding: 12px; border-radius: 5px; color: #155724;">
            âœ… å·²æ¢å¤é»˜è®¤é…ç½®
        </div>
    `;
    
    setTimeout(() => {
        resultDiv.innerHTML = '';
    }, 3000);
}

// æ˜¾ç¤ºAIé…ç½®
function displayAIConfig(config) {
    document.getElementById('aiProvider').value = config.provider;
    document.getElementById('aiBaseUrl').value = config.baseUrl;
    document.getElementById('aiApiKey').value = config.apiKey;
    document.getElementById('aiModel').value = config.model;
    document.getElementById('aiTemperature').value = config.temperature;
    document.getElementById('tempValue').textContent = config.temperature;
    document.getElementById('aiMaxTokens').value = config.maxTokens;
    document.getElementById('aiLocalMode').checked = config.localMode;
}

// æ›´æ–°AIé…ç½®å­—æ®µï¼ˆå½“é€‰æ‹©ä¸åŒæä¾›å•†æ—¶ï¼‰
function updateAIConfigFields() {
    const provider = document.getElementById('aiProvider').value;
    const template = aiProviderTemplates[provider];
    
    if (template && provider !== 'custom') {
        document.getElementById('aiBaseUrl').value = template.baseUrl;
        document.getElementById('aiModel').value = template.model;
    }
}

// æµ‹è¯•AIè¿æ¥
async function testAIConnection() {
    const config = {
        provider: document.getElementById('aiProvider').value,
        baseUrl: document.getElementById('aiBaseUrl').value,
        apiKey: document.getElementById('aiApiKey').value,
        model: document.getElementById('aiModel').value
    };

    const resultDiv = document.getElementById('aiTestResult');

    if (!config.apiKey) {
        resultDiv.innerHTML = `
            <div style="background: #f8d7da; border-left: 4px solid #dc3545; padding: 12px; border-radius: 5px; color: #721c24;">
                âŒ è¯·å…ˆè¾“å…¥API Key
            </div>
        `;
        return;
    }

    resultDiv.innerHTML = `
        <div style="background: #e7f3ff; border-left: 4px solid #0066cc; padding: 12px; border-radius: 5px; color: #004085;">
            â³ æ­£åœ¨æµ‹è¯•è¿æ¥...
        </div>
    `;

    try {
        // å¤„ç†baseUrlæœ«å°¾æ–œæ 
        let baseUrl = config.baseUrl.trim();
        if (baseUrl.endsWith('/')) {
            baseUrl = baseUrl.slice(0, -1);
        }

        // æ„å»ºè¯·æ±‚å¤´
        const headers = {
            'Content-Type': 'application/json',
            'Authorization': `Bearer ${config.apiKey}`
        };

        // æ„å»ºè¯·æ±‚ä½“ï¼ˆç®€å•æµ‹è¯•æ¶ˆæ¯ï¼‰
        const body = JSON.stringify({
            model: config.model,
            messages: [
                { role: 'user', content: 'ä½ å¥½ï¼Œè¿™æ˜¯ä¸€æ¡æµ‹è¯•æ¶ˆæ¯ï¼Œè¯·å›å¤"è¿æ¥æˆåŠŸ"ã€‚' }
            ],
            max_tokens: 50,
            temperature: 0.7
        });

        // ä½¿ç”¨AbortControllerå®ç°è¶…æ—¶
        const controller = new AbortController();
        const timeoutId = setTimeout(() => controller.abort(), 15000); // 15ç§’è¶…æ—¶

        // å‘é€æµ‹è¯•è¯·æ±‚
        const response = await fetch(`${baseUrl}/chat/completions`, {
            method: 'POST',
            headers: headers,
            body: body,
            signal: controller.signal
        });

        clearTimeout(timeoutId);

        if (response.ok) {
            const data = await response.json();
            const reply = data.choices?.[0]?.message?.content || 'æ— å›å¤å†…å®¹';
            resultDiv.innerHTML = `
                <div style="background: #d4edda; border-left: 4px solid #28a745; padding: 12px; border-radius: 5px; color: #155724;">
                    âœ… è¿æ¥æˆåŠŸï¼æ¨¡å‹: ${config.model}
                    <br><small>å›å¤: ${reply.substring(0, 50)}${reply.length > 50 ? '...' : ''}</small>
                </div>
            `;
        } else {
            // æ”¹è¿›é”™è¯¯å¤„ç† - å…ˆå°è¯•è·å–æ–‡æœ¬ï¼Œå†å°è¯•JSON
            let errorMessage = `HTTP ${response.status}`;
            try {
                const errorText = await response.text();
                try {
                    const errorJson = JSON.parse(errorText);
                    errorMessage = errorJson.error?.message || errorJson.message || errorText;
                } catch {
                    errorMessage = errorText || `HTTP ${response.status}`;
                }
            } catch {
                errorMessage = `HTTP ${response.status}`;
            }
            throw new Error(errorMessage);
        }
    } catch (error) {
        let errorMsg = error.message;
        let suggestion = '';

        // é’ˆå¯¹å¸¸è§é”™è¯¯æä¾›å…·ä½“å»ºè®®
        if (error.name === 'AbortError') {
            errorMsg = 'è¯·æ±‚è¶…æ—¶ï¼ˆ15ç§’ï¼‰';
            suggestion = 'è¯·æ£€æŸ¥ç½‘ç»œè¿æ¥æˆ–APIæœåŠ¡çŠ¶æ€';
        } else if (error.message.includes('Failed to fetch') || error.message.includes('NetworkError')) {
            errorMsg = 'ç½‘ç»œè¯·æ±‚å¤±è´¥';
            suggestion = '1. æ£€æŸ¥ç½‘ç»œè¿æ¥<br>2. å¦‚æœæ˜¯æœ¬åœ°éƒ¨ç½²ï¼Œè¯·ç¡®è®¤æœåŠ¡å·²å¯åŠ¨<br>3. æ£€æŸ¥APIåœ°å€æ˜¯å¦æ­£ç¡®<br>4. å¯èƒ½æ˜¯CORSè·¨åŸŸé—®é¢˜ï¼ˆéœ€é…ç½®ä»£ç†ï¼‰';
        } else if (error.message.includes('401') || error.message.includes('Unauthorized')) {
            errorMsg = 'API Key æ— æ•ˆæˆ–å·²è¿‡æœŸ';
            suggestion = 'è¯·æ£€æŸ¥API Keyæ˜¯å¦æ­£ç¡®';
        } else if (error.message.includes('404')) {
            errorMsg = 'APIåœ°å€ä¸å­˜åœ¨';
            suggestion = 'è¯·æ£€æŸ¥Base URLæ˜¯å¦æ­£ç¡®ï¼Œç¡®ä¿åŒ…å« /v1 è·¯å¾„';
        } else if (error.message.includes('429')) {
            errorMsg = 'è¯·æ±‚è¿‡äºé¢‘ç¹æˆ–é¢åº¦ä¸è¶³';
            suggestion = 'è¯·ç¨åé‡è¯•æˆ–æ£€æŸ¥APIé¢åº¦';
        }

        resultDiv.innerHTML = `
            <div style="background: #f8d7da; border-left: 4px solid #dc3545; padding: 12px; border-radius: 5px; color: #721c24;">
                âŒ è¿æ¥å¤±è´¥: ${errorMsg}
                ${suggestion ? `<br><small style="margin-top: 8px; display: block;">ğŸ’¡ ${suggestion}</small>` : ''}
            </div>
        `;
    }
}

// åˆå§‹åŒ–AIé…ç½®é¡µé¢
function initAIConfig() {
    const config = loadAIConfig();
    displayAIConfig(config);
}

// ==================== AIé…ç½®æ¨¡å—ç»“æŸ ====================

        // å¯åŠ¨åº”ç”¨ç¨‹åºï¼ˆåœ¨æ‰€æœ‰å‡½æ•°å®šä¹‰ä¹‹åè°ƒç”¨ï¼‰
        init();
    </script>
    
    <footer style="text-align: center; padding: 20px; color: white; margin-top: 30px; font-size: 14px; text-shadow: 1px 1px 2px rgba(0,0,0,0.3);">
        <p style="margin: 5px 0;">ğŸ§¬ æŸ³å·å¸‚ç–¾ç—…é¢„é˜²æ§åˆ¶ä¸­å¿ƒ ç—…åŸå¾®ç”Ÿç‰©é˜²æ§ç³»ç»Ÿ</p>
        <p style="margin: 5px 0;">æ¶ˆæ¯’ä¸ç—…åª’ç”Ÿç‰©é˜²åˆ¶æ‰€</p>
        <p style="margin: 5px 0; font-size: 12px; opacity: 0.8;">æœªç»è®¸å¯ä¸å¾—ä¿®æ”¹æˆ–å•†ç”¨</p>
    </footer>
</body>
</html>
